<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R Tips - テンソルと画像処理</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q52.html" rel="next">
<link href="../../../contents/books/07_NumpyInfinity/ch03_行列の導入.html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;800&amp;display=swap" rel="stylesheet">


<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">R Tips</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-home" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Home</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-home">    
        <li>
    <a class="dropdown-item" href="../../../index.html" rel="" target="">
 <span class="dropdown-text">Home</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-web-site" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Web Site</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-web-site">    
        <li class="dropdown-header">ALL</li>
        <li>
    <a class="dropdown-item" href="../../../contents/website/r4ds2e/index.html" rel="" target="">
 <span class="dropdown-text">R for Data Science 2e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/leaflet4r/index.html" rel="" target="">
 <span class="dropdown-text">Leaflet for R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/analizeUSCensus/index.html" rel="" target="">
 <span class="dropdown-text">Analyzing US Census Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/graphic_design_with_ggplot2/index.html" rel="" target="">
 <span class="dropdown-text">Graphic Design with ggplot2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/udemy_database-specialist/am-2-note.html" rel="" target="">
 <span class="dropdown-text">Udemyデータベーススペシャリスト</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">books</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-books">    
        <li class="dropdown-header">R</li>
        <li>
    <a class="dropdown-item" href="../../../contents/books/01_Rによる実証分析_2e/index.html" rel="" target="">
 <span class="dropdown-text">Rによる実証分析2e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/02_因果推論ミックステープ/index.html" rel="" target="">
 <span class="dropdown-text">因果推論ミックステープ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/index.html" rel="" target="">
 <span class="dropdown-text">数値シミュレーションで学ぶ統計の仕組み</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/05_統計的因果推論の理論と実際/index.html" rel="" target="">
 <span class="dropdown-text">統計的因果推論の理論と実際</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Python</li>
        <li>
    <a class="dropdown-item" href="../../../contents/books/06_Pythonではじめる数理最適化/index.html" rel="" target="">
 <span class="dropdown-text">Pythonではじめる数理最適化 2nd</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/07_NumpyInfinity/ch01_Pythonの基礎.html" rel="" target="">
 <span class="dropdown-text">Numpy Infinity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/08_handbook_lightgbm/cl02_データ理解.html" rel="" target="">
 <span class="dropdown-text">LightGBMハンドブック</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html" rel="" target="">
 <span class="dropdown-text">Pythonで学ぶ数理最適化</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html" rel="" target="">
 <span class="dropdown-text">爆速Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/11_Pythonではじめる時系列分析入門/index.html" rel="" target="">
 <span class="dropdown-text">Pythonではじめる時系列分析</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-libs" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">libs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-libs">    
        <li class="dropdown-header">R</li>
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/base/working.html" rel="" target="">
 <span class="dropdown-text">base</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/argparse/index.html" rel="" target="">
 <span class="dropdown-text">argparse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/assertr/index.html" rel="" target="">
 <span class="dropdown-text">assertr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/corrr/working.html" rel="" target="">
 <span class="dropdown-text">corrr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ComplexHeatmap/working.html" rel="" target="">
 <span class="dropdown-text">ComplexHeatmap</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/duckdb/working.html" rel="" target="">
 <span class="dropdown-text">duckdb</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/DBI/working.html" rel="" target="">
 <span class="dropdown-text">DBI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggspatial/working.html" rel="" target="">
 <span class="dropdown-text">ggspatial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/GGally/working.html" rel="" target="">
 <span class="dropdown-text">GGally</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggtext/working.html" rel="" target="">
 <span class="dropdown-text">ggtext</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggfittext/working.html" rel="" target="">
 <span class="dropdown-text">ggfittext</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/gganimate/working.html" rel="" target="">
 <span class="dropdown-text">gganimate</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggmosaic/working.html" rel="" target="">
 <span class="dropdown-text">ggmosaic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/treemapify/working.html" rel="" target="">
 <span class="dropdown-text">treemapify</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/tidyverse/working.html" rel="" target="">
 <span class="dropdown-text">tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/sf/working.html" rel="" target="">
 <span class="dropdown-text">sf</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/igraph/index.html" rel="" target="">
 <span class="dropdown-text">igraph</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/patchwork/working.html" rel="" target="">
 <span class="dropdown-text">pathcwork</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Python</li>
        <li>
    <a class="dropdown-item" href="../../../contents/libs/Python/pydantic/index.html" rel="" target="">
 <span class="dropdown-text">pydantic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/Python/pandera/index.html" rel="" target="">
 <span class="dropdown-text">pandera</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-notes">    
        <li class="dropdown-header">Notes</li>
        <li>
    <a class="dropdown-item" href="../../../contents/notes/ggplot2/working.html" rel="" target="">
 <span class="dropdown-text">ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-utils" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Utils</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-utils">    
        <li class="dropdown-header">Utils</li>
        <li>
    <a class="dropdown-item" href="../../../contents/utils/01_写真GPS/index.html" rel="" target="">
 <span class="dropdown-text">01_写真GPS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sql" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">sql</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sql">    
        <li class="dropdown-header">DuckDB</li>
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/documentaion/index.html" rel="" target="">
 <span class="dropdown-text">Documentaion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/sql-bigdata/index.html" rel="" target="">
 <span class="dropdown-text">ビッグデータレシピ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/mytips/01_.html" rel="" target="">
 <span class="dropdown-text">My Tips</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/SpatialDataAnalysiswithDuckDB/working.html" rel="" target="">
 <span class="dropdown-text">Spatial DataAnalysis with DuckDB</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-test" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Test</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-test">    
        <li class="dropdown-header">Test</li>
        <li>
    <a class="dropdown-item" href="../../../contents/test/bash/quick_sample.html" rel="" target="">
 <span class="dropdown-text">Bash</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/R/renv.html" rel="" target="">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/R2/renv.html" rel="" target="">
 <span class="dropdown-text">R2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/python/notebook.html" rel="" target="">
 <span class="dropdown-text">Python</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Python</li><li class="breadcrumb-item"><a href="../../../contents/books/07_NumpyInfinity/ch01_Pythonの基礎.html">Numpy Infinity</a></li><li class="breadcrumb-item"><a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理.html">テンソルと画像処理</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Rによる実証分析2e</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch01_回帰分析の目的.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 回帰分析の目的</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch02_統計の基礎知識.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 統計の基礎知識</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch03_確率論の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 確率論の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch04_回帰分析の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch05_推測統計の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 推測統計の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch06_相関関係と因果関係.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 相関関係と因果関係</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch07_外生変数と内生変数.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 内生変数と外生変数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch08_ランダム化実験.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch08 ランダム化実験</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch09_マッチング法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch09 マッチング法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch10_回帰不連続デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch10 回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch11_操作変数法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch11 操作変数法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch12_パネルデータ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch12 パネルデータ</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">因果推論ミックステープ</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch01_導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch02_確率と回帰の概要.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 確率と回帰の概要</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch03_非巡回的有向グラフ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 非巡回的有向グラフ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch04_潜在アウトカム因果モデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 潜在アウトカム因果モデル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch05_マッチングと層別化.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 マッチングと層別化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch06_回帰不連続デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch07_操作変数.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 操作変数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch08_パネルデータ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch08 パネルデータ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch09_差分の差デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch09 差分の差デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch10_合成コントロール法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch10 合成コントロール</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch11_結論.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch11 結論</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">数値シミュレーションで学ぶ統計の仕組み</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch01_本書の狙い.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 本書のねらい</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch02_プログラミングの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 プログラミングの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch03_乱数生成シミュレーションの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 乱数生成シミュレーションの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch04_母数の推定のシミュレーション.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 母数の推定</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch05_統計検定の論理とエラー確率のコントロール - コピー (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 統計検定の論理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch06_適切な検定のためのサンプルサイズ設計.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 サンプルサイズ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch07_回帰分析とシミュレーション.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 回帰分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">統計的因果推論の理論と実際</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/101_統計的因果推論の基礎の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基礎の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/102_潜在的結果変数の枠組み.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜在的結果変数の枠組み</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/103_統計的因果推論における重要な仮定.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">重要な仮定</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/104_推測統計の基礎：標準誤差と信頼区間.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">標準誤差と信頼区間</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/105_回帰分析の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/106_図で理解する重回帰モデルの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">重回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/107_最小二乗法による重回帰モデルの仮定と診断1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">最小二乗法の仮定と診断1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/108_最小二乗法による重回帰モデルの仮定と診断2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">最小二乗法の仮定と診断2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/109_交互作用項のある共分散分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交互作用項のある共分散分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/110_傾向スコア.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコア</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/111_傾向スコアマッチング.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコアマッチング</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/112_傾向スコアによる層化解析法および重み付き法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコアによる層化解析法および重み付き法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/113_操作変数法の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">操作変数法の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/114_操作変数法による非遵守への対処.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">操作変数の非遵守への対処</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/115_回帰不連続デザインの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/119_欠測データ処理の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">欠損データ処理</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Pythonではじめる数理最適化 2nd</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch02_チュートリアル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数理最適化チュートリアル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch03_学校のクラス編成.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">学校のクラス編成</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch04_クーポン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">クーポン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch05_配送計画.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配送計画</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Numpy Infinity</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch01_Pythonの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pythonの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch02_numpyの導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">numpyの導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch03_行列の導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">行列の導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">テンソルと画像処理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Q52：セピア化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q72.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Q84：CMYK色空間</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch05_ブロードキャストの応用.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ブロードキャストの応用</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false">
 <span class="menu-text">LightGBMハンドブック</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl02_データ理解.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl03_分類の予測モデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl04_回帰の予測モデル改善.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">Pythonで学ぶ数理最適化</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基礎編</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch02_応用編.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">応用編</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">爆速Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">組込み機能のパフォーマンスを最大限に引き出す</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/10_爆速Python/ch03_並行性_並列性_非同期処理.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ch03 並行性 並列性 非同期処理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">Pythonではじめる時系列分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch01_時系列分析をはじめよう.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch02_時系列データの構造.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch03_データ生成過程の基本.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#この章で学ぶこと" id="toc-この章で学ぶこと" class="nav-link active" data-scroll-target="#この章で学ぶこと"><span class="header-section-number">1</span> この章で学ぶこと</a></li>
  <li><a href="#行列と画像" id="toc-行列と画像" class="nav-link" data-scroll-target="#行列と画像"><span class="header-section-number">2</span> 行列と画像</a>
  <ul class="collapse">
  <li><a href="#背景一色の画像" id="toc-背景一色の画像" class="nav-link" data-scroll-target="#背景一色の画像"><span class="header-section-number">2.1</span> 背景一色の画像</a></li>
  </ul></li>
  <li><a href="#直線を引く" id="toc-直線を引く" class="nav-link" data-scroll-target="#直線を引く"><span class="header-section-number">3</span> 直線を引く</a>
  <ul class="collapse">
  <li><a href="#斜めの線" id="toc-斜めの線" class="nav-link" data-scroll-target="#斜めの線"><span class="header-section-number">3.1</span> 斜めの線</a></li>
  </ul></li>
  <li><a href="#matplotlibでの複数グラフの書き方" id="toc-matplotlibでの複数グラフの書き方" class="nav-link" data-scroll-target="#matplotlibでの複数グラフの書き方"><span class="header-section-number">4</span> matplotlibでの複数グラフの書き方</a>
  <ul class="collapse">
  <li><a href="#複数のaxes" id="toc-複数のaxes" class="nav-link" data-scroll-target="#複数のaxes"><span class="header-section-number">4.1</span> 複数のaxes</a></li>
  <li><a href="#画像をプロット" id="toc-画像をプロット" class="nav-link" data-scroll-target="#画像をプロット"><span class="header-section-number">4.2</span> 画像をプロット</a></li>
  </ul></li>
  <li><a href="#市松模様を作る" id="toc-市松模様を作る" class="nav-link" data-scroll-target="#市松模様を作る"><span class="header-section-number">5</span> 市松模様を作る</a></li>
  <li><a href="#グラデーション" id="toc-グラデーション" class="nav-link" data-scroll-target="#グラデーション"><span class="header-section-number">6</span> グラデーション</a>
  <ul class="collapse">
  <li><a href="#斜めのグラデーション" id="toc-斜めのグラデーション" class="nav-link" data-scroll-target="#斜めのグラデーション"><span class="header-section-number">6.1</span> 斜めのグラデーション</a></li>
  </ul></li>
  <li><a href="#円の描画" id="toc-円の描画" class="nav-link" data-scroll-target="#円の描画"><span class="header-section-number">7</span> 円の描画</a>
  <ul class="collapse">
  <li><a href="#円の境界に色を付ける." id="toc-円の境界に色を付ける." class="nav-link" data-scroll-target="#円の境界に色を付ける."><span class="header-section-number">7.1</span> 円の境界に色を付ける.</a></li>
  </ul></li>
  <li><a href="#弾の描画" id="toc-弾の描画" class="nav-link" data-scroll-target="#弾の描画"><span class="header-section-number">8</span> 弾の描画</a></li>
  <li><a href="#極座標" id="toc-極座標" class="nav-link" data-scroll-target="#極座標"><span class="header-section-number">9</span> 極座標</a>
  <ul class="collapse">
  <li><a href="#レムニスケート" id="toc-レムニスケート" class="nav-link" data-scroll-target="#レムニスケート"><span class="header-section-number">9.1</span> レムニスケート</a></li>
  </ul></li>
  <li><a href="#カラー画像の作り方" id="toc-カラー画像の作り方" class="nav-link" data-scroll-target="#カラー画像の作り方"><span class="header-section-number">10</span> カラー画像の作り方</a></li>
  <li><a href="#カラー画像での矩形塗りつぶし" id="toc-カラー画像での矩形塗りつぶし" class="nav-link" data-scroll-target="#カラー画像での矩形塗りつぶし"><span class="header-section-number">11</span> カラー画像での矩形塗りつぶし</a></li>
  <li><a href="#テキストの描画" id="toc-テキストの描画" class="nav-link" data-scroll-target="#テキストの描画"><span class="header-section-number">12</span> テキストの描画</a>
  <ul class="collapse">
  <li><a href="#テキスト画像のトリミング" id="toc-テキスト画像のトリミング" class="nav-link" data-scroll-target="#テキスト画像のトリミング"><span class="header-section-number">12.1</span> テキスト画像のトリミング</a></li>
  <li><a href="#テキストへのグラデーション" id="toc-テキストへのグラデーション" class="nav-link" data-scroll-target="#テキストへのグラデーション"><span class="header-section-number">12.2</span> テキストへのグラデーション</a></li>
  </ul></li>
  <li><a href="#pillowとnumpy配列の相互変換" id="toc-pillowとnumpy配列の相互変換" class="nav-link" data-scroll-target="#pillowとnumpy配列の相互変換"><span class="header-section-number">13</span> PillowとNumPy配列の相互変換</a>
  <ul class="collapse">
  <li><a href="#pillow---numpyへの変換" id="toc-pillow---numpyへの変換" class="nav-link" data-scroll-target="#pillow---numpyへの変換"><span class="header-section-number">13.1</span> Pillow -&gt; NumPyへの変換</a></li>
  <li><a href="#numpy配列-pillowの変換" id="toc-numpy配列-pillowの変換" class="nav-link" data-scroll-target="#numpy配列-pillowの変換"><span class="header-section-number">13.2</span> NumPy配列 ⇒ Pillowの変換</a></li>
  </ul></li>
  <li><a href="#演習問題" id="toc-演習問題" class="nav-link" data-scroll-target="#演習問題"><span class="header-section-number">14</span> 演習問題</a>
  <ul class="collapse">
  <li><a href="#q1べた塗りグレースケール" id="toc-q1べた塗りグレースケール" class="nav-link" data-scroll-target="#q1べた塗りグレースケール"><span class="header-section-number">14.1</span> Q1:べた塗りグレースケール</a></li>
  <li><a href="#q2四角形のぬりつぶし" id="toc-q2四角形のぬりつぶし" class="nav-link" data-scroll-target="#q2四角形のぬりつぶし"><span class="header-section-number">14.2</span> Q2:四角形のぬりつぶし</a></li>
  <li><a href="#画像の保存" id="toc-画像の保存" class="nav-link" data-scroll-target="#画像の保存"><span class="header-section-number">14.3</span> 画像の保存</a></li>
  <li><a href="#円の塗りつぶし" id="toc-円の塗りつぶし" class="nav-link" data-scroll-target="#円の塗りつぶし"><span class="header-section-number">14.4</span> 円の塗りつぶし</a></li>
  <li><a href="#q5平方数の直線" id="toc-q5平方数の直線" class="nav-link" data-scroll-target="#q5平方数の直線"><span class="header-section-number">14.5</span> Q5:平方数の直線</a></li>
  <li><a href="#q6斜めの線" id="toc-q6斜めの線" class="nav-link" data-scroll-target="#q6斜めの線"><span class="header-section-number">14.6</span> Q6:斜めの線</a></li>
  <li><a href="#q7同心円" id="toc-q7同心円" class="nav-link" data-scroll-target="#q7同心円"><span class="header-section-number">14.7</span> Q7:同心円</a></li>
  <li><a href="#q8アンチエイリアス" id="toc-q8アンチエイリアス" class="nav-link" data-scroll-target="#q8アンチエイリアス"><span class="header-section-number">14.8</span> Q8:アンチエイリアス</a></li>
  <li><a href="#q9スーパー楕円" id="toc-q9スーパー楕円" class="nav-link" data-scroll-target="#q9スーパー楕円"><span class="header-section-number">14.9</span> Q9:スーパー楕円</a></li>
  <li><a href="#q10カージオイド" id="toc-q10カージオイド" class="nav-link" data-scroll-target="#q10カージオイド"><span class="header-section-number">14.10</span> Q10:カージオイド</a></li>
  <li><a href="#q11円周率の近似値" id="toc-q11円周率の近似値" class="nav-link" data-scroll-target="#q11円周率の近似値"><span class="header-section-number">14.11</span> Q11:円周率の近似値</a></li>
  <li><a href="#q12積分の数値計算" id="toc-q12積分の数値計算" class="nav-link" data-scroll-target="#q12積分の数値計算"><span class="header-section-number">14.12</span> Q12:積分の数値計算</a></li>
  <li><a href="#q13オウム貝の螺旋" id="toc-q13オウム貝の螺旋" class="nav-link" data-scroll-target="#q13オウム貝の螺旋"><span class="header-section-number">14.13</span> Q13:オウム貝の螺旋</a></li>
  <li><a href="#q14グラデーション１" id="toc-q14グラデーション１" class="nav-link" data-scroll-target="#q14グラデーション１"><span class="header-section-number">14.14</span> Q14：グラデーション（１）</a></li>
  <li><a href="#q14グラデーション２" id="toc-q14グラデーション２" class="nav-link" data-scroll-target="#q14グラデーション２"><span class="header-section-number">14.15</span> Q14:グラデーション（２）</a></li>
  <li><a href="#q16三角形の描画" id="toc-q16三角形の描画" class="nav-link" data-scroll-target="#q16三角形の描画"><span class="header-section-number">14.16</span> Q16:三角形の描画</a></li>
  <li><a href="#q17三角形の描画" id="toc-q17三角形の描画" class="nav-link" data-scroll-target="#q17三角形の描画"><span class="header-section-number">14.17</span> Q17：三角形の描画</a></li>
  <li><a href="#q18三角形の重心" id="toc-q18三角形の重心" class="nav-link" data-scroll-target="#q18三角形の重心"><span class="header-section-number">14.18</span> Q18:三角形の重心</a></li>
  <li><a href="#q19任意図形の重心" id="toc-q19任意図形の重心" class="nav-link" data-scroll-target="#q19任意図形の重心"><span class="header-section-number">14.19</span> Q19:任意図形の重心</a></li>
  <li><a href="#q20カラー画像" id="toc-q20カラー画像" class="nav-link" data-scroll-target="#q20カラー画像"><span class="header-section-number">14.20</span> Q20:カラー画像</a></li>
  <li><a href="#q21イタリアの国旗" id="toc-q21イタリアの国旗" class="nav-link" data-scroll-target="#q21イタリアの国旗"><span class="header-section-number">14.21</span> Q21:イタリアの国旗</a></li>
  <li><a href="#q223階テンソルの乱数" id="toc-q223階テンソルの乱数" class="nav-link" data-scroll-target="#q223階テンソルの乱数"><span class="header-section-number">14.22</span> Q22：3階テンソルの乱数</a></li>
  <li><a href="#q23ホワイトノイズ" id="toc-q23ホワイトノイズ" class="nav-link" data-scroll-target="#q23ホワイトノイズ"><span class="header-section-number">14.23</span> Q23:ホワイトノイズ</a></li>
  <li><a href="#q24３階テンソルのconcatenate" id="toc-q24３階テンソルのconcatenate" class="nav-link" data-scroll-target="#q24３階テンソルのconcatenate"><span class="header-section-number">14.24</span> Q24:３階テンソルのconcatenate</a></li>
  <li><a href="#q25３階テンソルのstack" id="toc-q25３階テンソルのstack" class="nav-link" data-scroll-target="#q25３階テンソルのstack"><span class="header-section-number">14.25</span> Q25:３階テンソルのstack</a></li>
  <li><a href="#q26縦方向の画像の結合" id="toc-q26縦方向の画像の結合" class="nav-link" data-scroll-target="#q26縦方向の画像の結合"><span class="header-section-number">14.26</span> Q26:縦方向の画像の結合</a></li>
  <li><a href="#q27横方向の画像の結合" id="toc-q27横方向の画像の結合" class="nav-link" data-scroll-target="#q27横方向の画像の結合"><span class="header-section-number">14.27</span> Q27：横方向の画像の結合</a></li>
  <li><a href="#q28日の丸" id="toc-q28日の丸" class="nav-link" data-scroll-target="#q28日の丸"><span class="header-section-number">14.28</span> Q28:日の丸</a></li>
  <li><a href="#q29z旗" id="toc-q29z旗" class="nav-link" data-scroll-target="#q29z旗"><span class="header-section-number">14.29</span> Q29：Z旗</a></li>
  <li><a href="#q30セーシャルの国旗" id="toc-q30セーシャルの国旗" class="nav-link" data-scroll-target="#q30セーシャルの国旗"><span class="header-section-number">14.30</span> Q30：セーシャルの国旗</a></li>
  <li><a href="#q31画像の合成" id="toc-q31画像の合成" class="nav-link" data-scroll-target="#q31画像の合成"><span class="header-section-number">14.31</span> Q31:画像の合成</a></li>
  <li><a href="#q32rgba画像" id="toc-q32rgba画像" class="nav-link" data-scroll-target="#q32rgba画像"><span class="header-section-number">14.32</span> Q32:RGBA画像</a></li>
  <li><a href="#q33rgba画像２" id="toc-q33rgba画像２" class="nav-link" data-scroll-target="#q33rgba画像２"><span class="header-section-number">14.33</span> Q33:RGBA画像２</a></li>
  <li><a href="#q34透画像の合成" id="toc-q34透画像の合成" class="nav-link" data-scroll-target="#q34透画像の合成"><span class="header-section-number">14.34</span> Q34：透画像の合成</a></li>
  <li><a href="#q35クロマキー合成" id="toc-q35クロマキー合成" class="nav-link" data-scroll-target="#q35クロマキー合成"><span class="header-section-number">14.35</span> Q35：クロマキー合成</a></li>
  <li><a href="#q36アルファブレンド" id="toc-q36アルファブレンド" class="nav-link" data-scroll-target="#q36アルファブレンド"><span class="header-section-number">14.36</span> Q36：アルファブレンド</a></li>
  <li><a href="#q38hsv色空間" id="toc-q38hsv色空間" class="nav-link" data-scroll-target="#q38hsv色空間"><span class="header-section-number">14.37</span> Q38：HSV色空間</a></li>
  <li><a href="#q39hsv色空間" id="toc-q39hsv色空間" class="nav-link" data-scroll-target="#q39hsv色空間"><span class="header-section-number">14.38</span> Q39:HSV色空間</a></li>
  <li><a href="#q41色相環" id="toc-q41色相環" class="nav-link" data-scroll-target="#q41色相環"><span class="header-section-number">14.39</span> Q41:色相環</a></li>
  <li><a href="#q42補色" id="toc-q42補色" class="nav-link" data-scroll-target="#q42補色"><span class="header-section-number">14.40</span> Q42:補色</a></li>
  <li><a href="#q44ゲーミングフラワー" id="toc-q44ゲーミングフラワー" class="nav-link" data-scroll-target="#q44ゲーミングフラワー"><span class="header-section-number">14.41</span> Q44:ゲーミングフラワー</a></li>
  <li><a href="#q45ゲーミングイルカ" id="toc-q45ゲーミングイルカ" class="nav-link" data-scroll-target="#q45ゲーミングイルカ"><span class="header-section-number">14.42</span> Q45:ゲーミングイルカ</a></li>
  <li><a href="#q46類似色のグラデーション" id="toc-q46類似色のグラデーション" class="nav-link" data-scroll-target="#q46類似色のグラデーション"><span class="header-section-number">14.43</span> Q46:類似色のグラデーション</a></li>
  <li><a href="#q47rgbとhsvのグラデーション" id="toc-q47rgbとhsvのグラデーション" class="nav-link" data-scroll-target="#q47rgbとhsvのグラデーション"><span class="header-section-number">14.44</span> Q47：RGBとHSVのグラデーション</a></li>
  <li><a href="#q48カラー画像のグレースケール化" id="toc-q48カラー画像のグレースケール化" class="nav-link" data-scroll-target="#q48カラー画像のグレースケール化"><span class="header-section-number">14.45</span> Q48：カラー画像のグレースケール化</a></li>
  <li><a href="#q49カラー画像のグレースケール化" id="toc-q49カラー画像のグレースケール化" class="nav-link" data-scroll-target="#q49カラー画像のグレースケール化"><span class="header-section-number">14.46</span> Q49:カラー画像のグレースケール化</a></li>
  <li><a href="#q50単色カラー化" id="toc-q50単色カラー化" class="nav-link" data-scroll-target="#q50単色カラー化"><span class="header-section-number">14.47</span> Q50:単色カラー化</a></li>
  <li><a href="#q51単色カラー化ダブルトーン" id="toc-q51単色カラー化ダブルトーン" class="nav-link" data-scroll-target="#q51単色カラー化ダブルトーン"><span class="header-section-number">14.48</span> Q51:単色カラー化，ダブルトーン</a></li>
  <li><a href="#q52セピア化" id="toc-q52セピア化" class="nav-link" data-scroll-target="#q52セピア化"><span class="header-section-number">14.49</span> Q52：セピア化</a></li>
  <li><a href="#q53cssのセピア化" id="toc-q53cssのセピア化" class="nav-link" data-scroll-target="#q53cssのセピア化"><span class="header-section-number">14.50</span> Q53：CSSのセピア化</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">テンソルと画像処理</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="1">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2"></a></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">def</span> gray_show(img):</span>
<span id="cb1-5"><a href="#cb1-5"></a>    plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>    <span class="co"># plt.axis("off")</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>    plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="この章で学ぶこと" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="この章で学ぶこと"><span class="header-section-number">1</span> この章で学ぶこと</h2>
<ul>
<li>numpy配列でモノクロ画像の描画</li>
<li>matplotlibの使い方</li>
<li>numpy配列でカラー画像の描画</li>
<li>numpy配列で画像を自在に操り，フォトショップの機能を一部実装</li>
</ul>
<p>章末には100本ノックがある.</p>
</section>
<section id="行列と画像" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="行列と画像"><span class="header-section-number">2</span> 行列と画像</h2>
<p>1画素8ビットのカラーチャンネルは，numpy配列の多次元行列として表現することが可能である.</p>
<section id="背景一色の画像" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="背景一色の画像"><span class="header-section-number">2.1</span> 背景一色の画像</h3>
<div class="cell" data-execution_count="2">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>M, N <span class="op">=</span> <span class="dv">300</span>, <span class="dv">400</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>img <span class="op">=</span> np.zeros((M, N), dtype <span class="op">=</span> np.uint8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="3">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-4-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="4">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>img <span class="op">=</span> np.full((M, N), <span class="dv">127</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb4-2"><a href="#cb4-2"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-5-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="直線を引く" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="直線を引く"><span class="header-section-number">3</span> 直線を引く</h2>
<div class="cell" data-execution_count="5">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># 真っ白なキャンバスを用意して</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>img <span class="op">=</span> np.full((M, N), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co"># 黒い横線を引く</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>img[<span class="dv">100</span>, :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>plt.axis(<span class="st">"off"</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-6-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="6">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1"></a>img <span class="op">=</span> np.full((M, N), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb6-2"><a href="#cb6-2"></a>img[<span class="dv">50</span>::<span class="dv">50</span>, :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>img[:, <span class="dv">50</span>::<span class="dv">50</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-7-output-1.svg" class="img-fluid"></p>
</div>
</div>
<section id="斜めの線" class="level3" data-number="3.1">
<h3 data-number="3.1" class="anchored" data-anchor-id="斜めの線"><span class="header-section-number">3.1</span> 斜めの線</h3>
<p>境界 + 適当な幅のデータをプロットする。</p>
<div class="cell" data-execution_count="7">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">6</span>))</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="cf">for</span> i, width <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="fl">.5</span>, <span class="dv">1</span>]):</span>
<span id="cb7-3"><a href="#cb7-3"></a>    img <span class="op">=</span> np.full((M, N), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="co"># mesh_gridのようなイメージ</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>    <span class="co"># img.shape点を作成している</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>    y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb7-7"><a href="#cb7-7"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">2</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>    <span class="co"># 境界からの距離を求めて（横幅）その点をプロット</span></span>
<span id="cb7-9"><a href="#cb7-9"></a>    mask <span class="op">=</span> np.<span class="bu">abs</span>(x_ind <span class="op">-</span> <span class="dv">300</span> <span class="op">/</span> <span class="dv">250</span> <span class="op">*</span> (y_ind <span class="op">-</span><span class="dv">50</span>)) <span class="op">&lt;=</span> width</span>
<span id="cb7-10"><a href="#cb7-10"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>    ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb7-12"><a href="#cb7-12"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-8-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="8">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a>np.indices((M, N))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([[[  0,   0,   0, ...,   0,   0,   0],
        [  1,   1,   1, ...,   1,   1,   1],
        [  2,   2,   2, ...,   2,   2,   2],
        ...,
        [297, 297, 297, ..., 297, 297, 297],
        [298, 298, 298, ..., 298, 298, 298],
        [299, 299, 299, ..., 299, 299, 299]],

       [[  0,   1,   2, ..., 397, 398, 399],
        [  0,   1,   2, ..., 397, 398, 399],
        [  0,   1,   2, ..., 397, 398, 399],
        ...,
        [  0,   1,   2, ..., 397, 398, 399],
        [  0,   1,   2, ..., 397, 398, 399],
        [  0,   1,   2, ..., 397, 398, 399]]])</code></pre>
</div>
</div>
</section>
</section>
<section id="matplotlibでの複数グラフの書き方" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="matplotlibでの複数グラフの書き方"><span class="header-section-number">4</span> matplotlibでの複数グラフの書き方</h2>
<div class="cell" data-execution_count="9">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a>x <span class="op">=</span> np.arange(<span class="dv">100</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>plt.plot(x, np.log(x))</span>
<span id="cb10-3"><a href="#cb10-3"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-10-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p><code>fig.gca</code>はget current axesの略であり，axesを取得する際に使うことが可能である. <code>fig.get_axes</code>はfigureの中にどのaxesがあるのかを見ることが可能である.</p>
<div class="cell" data-execution_count="10">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb11-2"><a href="#cb11-2"></a>fig.get_axes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>[]</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>&lt;Figure size 432x288 with 0 Axes&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="11">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1"></a>ax <span class="op">=</span> fig.gca()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="12">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>fig.get_axes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>[&lt;AxesSubplot:&gt;]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="13">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>fig.clear() <span class="co"># axesが解消される</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>fig.get_axes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>[]</code></pre>
</div>
</div>
<section id="複数のaxes" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="複数のaxes"><span class="header-section-number">4.1</span> 複数のaxes</h3>
<div class="cell" data-execution_count="14">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb19-3"><a href="#cb19-3"></a>    <span class="co"># グラフの配置の形 x, y とグラフの位置</span></span>
<span id="cb19-4"><a href="#cb19-4"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb19-5"><a href="#cb19-5"></a>    ax.plot(x, np.sin(x <span class="op">/</span> (i <span class="op">+</span> <span class="dv">1</span>)))</span>
<span id="cb19-6"><a href="#cb19-6"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-15-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="15">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># プロットしてもaxesは残っている</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>fig.get_axes()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>[&lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;, &lt;AxesSubplot:&gt;]</code></pre>
</div>
</div>
</section>
<section id="画像をプロット" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="画像をプロット"><span class="header-section-number">4.2</span> 画像をプロット</h3>
<div class="cell" data-execution_count="16">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">8</span>))</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>):</span>
<span id="cb22-3"><a href="#cb22-3"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">3</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb22-4"><a href="#cb22-4"></a>    <span class="bu">print</span>(<span class="dv">255</span> <span class="op">*</span> i <span class="op">//</span> <span class="dv">10</span>)</span>
<span id="cb22-5"><a href="#cb22-5"></a>    img <span class="op">=</span> np.full((<span class="dv">400</span>, <span class="dv">400</span>), <span class="dv">255</span> <span class="op">*</span> i <span class="op">//</span> <span class="dv">10</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb22-6"><a href="#cb22-6"></a>    ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0
25
51
76
102
127
153
178
204</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-17-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="dv">1</span> <span class="op">//</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>0</code></pre>
</div>
</div>
</section>
</section>
<section id="市松模様を作る" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="市松模様を作る"><span class="header-section-number">5</span> 市松模様を作る</h2>
<div class="cell" data-execution_count="18">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a>alist <span class="op">=</span> [<span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>]</span>
<span id="cb26-2"><a href="#cb26-2"></a>fig   <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">8</span>))</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="cf">for</span> l, a <span class="kw">in</span> <span class="bu">enumerate</span>(alist):</span>
<span id="cb26-4"><a href="#cb26-4"></a>    img <span class="op">=</span> np.zeros((<span class="dv">330</span>, <span class="dv">430</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb26-5"><a href="#cb26-5"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(np.ceil(img.shape[<span class="dv">0</span>] <span class="op">/</span> a))):</span>
<span id="cb26-6"><a href="#cb26-6"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">int</span>(np.ceil(img.shape[<span class="dv">1</span>] <span class="op">/</span> a))):</span>
<span id="cb26-7"><a href="#cb26-7"></a>            <span class="cf">if</span> (i <span class="op">+</span> j) <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb26-8"><a href="#cb26-8"></a>                <span class="co"># numpy配列は要素数を超えても問題がない！！！！</span></span>
<span id="cb26-9"><a href="#cb26-9"></a>                img[i <span class="op">*</span> a:(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> a, j <span class="op">*</span> a:(j <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> a] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb26-10"><a href="#cb26-10"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, l <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb26-11"><a href="#cb26-11"></a>    ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-19-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1"></a>a <span class="op">=</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>a[<span class="dv">1</span>:<span class="dv">12</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([1, 2, 3, 4, 5, 6, 7, 8, 9])</code></pre>
</div>
</div>
</section>
<section id="グラデーション" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="グラデーション"><span class="header-section-number">6</span> グラデーション</h2>
<div class="cell" data-execution_count="20">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1"></a>start_color <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb29-2"><a href="#cb29-2"></a>end_color   <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb29-4"><a href="#cb29-4"></a></span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="co"># 横方向</span></span>
<span id="cb29-6"><a href="#cb29-6"></a>img <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>), np.uint8)</span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(img.shape[<span class="dv">0</span>]):</span>
<span id="cb29-8"><a href="#cb29-8"></a>    img[i,:] <span class="op">=</span> np.linspace(start_color, end_color, img.shape[<span class="dv">1</span>], dtype <span class="op">=</span> img.dtype)</span>
<span id="cb29-9"><a href="#cb29-9"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb29-10"><a href="#cb29-10"></a>ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb29-11"><a href="#cb29-11"></a></span>
<span id="cb29-12"><a href="#cb29-12"></a></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="co"># 縦方向</span></span>
<span id="cb29-14"><a href="#cb29-14"></a>img <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>), np.uint8)</span>
<span id="cb29-15"><a href="#cb29-15"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(img.shape[<span class="dv">1</span>]):</span>
<span id="cb29-16"><a href="#cb29-16"></a>    img[:, i] <span class="op">=</span> np.linspace(start_color, end_color, img.shape[<span class="dv">0</span>], dtype <span class="op">=</span> img.dtype)</span>
<span id="cb29-17"><a href="#cb29-17"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb29-18"><a href="#cb29-18"></a>ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb29-19"><a href="#cb29-19"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5ca92b0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-21-output-2.svg" class="img-fluid"></p>
</div>
</div>
<p>ブロードキャストを使った特殊な書き方.</p>
<div class="cell" data-execution_count="21">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1"></a>start_color <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>end_color <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb31-3"><a href="#cb31-3"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb31-4"><a href="#cb31-4"></a>img_shape <span class="op">=</span> (<span class="dv">300</span>, <span class="dv">400</span>)<span class="co"># 横方向</span></span>
<span id="cb31-5"><a href="#cb31-5"></a>img <span class="op">=</span> np.broadcast_to(np.linspace(start_color,end_color, img.shape[<span class="dv">1</span>],                                  dtype<span class="op">=</span>np.uint8)[<span class="va">None</span>, :], img_shape)</span>
<span id="cb31-6"><a href="#cb31-6"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb31-7"><a href="#cb31-7"></a>ax.imshow(img, cmap<span class="op">=</span><span class="st">"gray"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">255</span>)<span class="co"># 縦方向</span></span>
<span id="cb31-8"><a href="#cb31-8"></a>img <span class="op">=</span> np.broadcast_to(np.linspace(start_color,end_color, img.shape[<span class="dv">0</span>],                                   dtype<span class="op">=</span>np.uint8)[:,<span class="va">None</span>], img_shape)</span>
<span id="cb31-9"><a href="#cb31-9"></a>ax <span class="op">=</span> plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb31-10"><a href="#cb31-10"></a>ax.imshow(img, cmap<span class="op">=</span><span class="st">"gray"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">255</span>)</span>
<span id="cb31-11"><a href="#cb31-11"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-22-output-1.svg" class="img-fluid"></p>
</div>
</div>
<p>次の部分が本質なのかと思うけど，内容的にはブロードキャストを明示的に実行しているということなのかと思う。その際に，ブロードキャストの対象の形状をブロードキャストする先の形状に合わせていることがわかる.</p>
<div class="cell" data-execution_count="22">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a>np.broadcast_to(</span>
<span id="cb32-2"><a href="#cb32-2"></a>    np.linspace(start_color,end_color, img.shape[<span class="dv">1</span>], dtype<span class="op">=</span>np.uint8)[<span class="va">None</span>, :],  </span>
<span id="cb32-3"><a href="#cb32-3"></a>    img_shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([[ 50,  50,  51, ..., 253, 254, 255],
       [ 50,  50,  51, ..., 253, 254, 255],
       [ 50,  50,  51, ..., 253, 254, 255],
       ...,
       [ 50,  50,  51, ..., 253, 254, 255],
       [ 50,  50,  51, ..., 253, 254, 255],
       [ 50,  50,  51, ..., 253, 254, 255]], dtype=uint8)</code></pre>
</div>
</div>
<section id="斜めのグラデーション" class="level3" data-number="6.1">
<h3 data-number="6.1" class="anchored" data-anchor-id="斜めのグラデーション"><span class="header-section-number">6.1</span> 斜めのグラデーション</h3>
<p>図書を見てもらうとわかるように，斜めのグラデーションを作るには，線形補間の応用で大丈夫である。線形補間の式は同じであるが，行により横軸が変わっていくイメージである。</p>
<div class="cell" data-execution_count="23">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a>start_color <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>end_color   <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb34-3"><a href="#cb34-3"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">14</span>, <span class="dv">8</span>))</span>
<span id="cb34-4"><a href="#cb34-4"></a></span>
<span id="cb34-5"><a href="#cb34-5"></a>img1 <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb34-6"><a href="#cb34-6"></a>img2 <span class="op">=</span> np.zeros_like(img1)</span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(img.shape[<span class="dv">0</span>]):</span>
<span id="cb34-9"><a href="#cb34-9"></a>    left  <span class="op">=</span> start_color <span class="op">+</span> (end_color <span class="op">-</span> start_color) <span class="op">*</span> i <span class="op">/</span> img.shape[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb34-10"><a href="#cb34-10"></a>    right <span class="op">=</span> (end_color <span class="op">+</span> start_color) <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> (end_color <span class="op">-</span> start_color) <span class="op">*</span> i <span class="op">/</span> img.shape[<span class="dv">0</span>] <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb34-11"><a href="#cb34-11"></a>    img1[i,:]  <span class="op">=</span> np.linspace(left, right, img1.shape[<span class="dv">1</span>])</span>
<span id="cb34-12"><a href="#cb34-12"></a>    img2[i, :] <span class="op">=</span> np.linspace(left, right, img2.shape[<span class="dv">1</span>])[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb34-13"><a href="#cb34-13"></a></span>
<span id="cb34-14"><a href="#cb34-14"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb34-15"><a href="#cb34-15"></a>ax.imshow(img1, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb34-16"><a href="#cb34-16"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb34-17"><a href="#cb34-17"></a>ax.imshow(img2, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb34-18"><a href="#cb34-18"></a>plt.show()</span>
<span id="cb34-19"><a href="#cb34-19"></a></span>
<span id="cb34-20"><a href="#cb34-20"></a></span>
<span id="cb34-21"><a href="#cb34-21"></a></span>
<span id="cb34-22"><a href="#cb34-22"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-24-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="円の描画" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="円の描画"><span class="header-section-number">7</span> 円の描画</h2>
<div class="cell" data-execution_count="24">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>), <span class="dv">255</span>,  dtype <span class="op">=</span> np.uint8)</span>
<span id="cb35-2"><a href="#cb35-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb35-3"><a href="#cb35-3"></a>mask <span class="op">=</span> (x_ind <span class="op">-</span> <span class="dv">250</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (y_ind <span class="op">-</span> <span class="dv">150</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">&lt;=</span> <span class="dv">100</span> <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb35-4"><a href="#cb35-4"></a>img[mask] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb35-5"><a href="#cb35-5"></a></span>
<span id="cb35-6"><a href="#cb35-6"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-25-output-1.svg" class="img-fluid"></p>
</div>
</div>
<section id="円の境界に色を付ける." class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="円の境界に色を付ける."><span class="header-section-number">7.1</span> 円の境界に色を付ける.</h3>
<div class="cell" data-execution_count="25">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>), <span class="dv">255</span>,  dtype <span class="op">=</span> np.uint8)</span>
<span id="cb36-2"><a href="#cb36-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb36-3"><a href="#cb36-3"></a>v <span class="op">=</span> (x_ind <span class="op">-</span> <span class="dv">250</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (y_ind <span class="op">-</span> <span class="dv">150</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>img[v <span class="op">&lt;=</span> <span class="dv">100</span> <span class="op">**</span> <span class="dv">2</span>] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb36-5"><a href="#cb36-5"></a></span>
<span id="cb36-6"><a href="#cb36-6"></a><span class="co"># 境界の設定</span></span>
<span id="cb36-7"><a href="#cb36-7"></a>border_mask <span class="op">=</span> np.logical_and(v <span class="op">&gt;=</span> <span class="fl">99.5</span> <span class="op">**</span> <span class="dv">2</span>, v <span class="op">&lt;=</span> <span class="fl">100.5</span> <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb36-8"><a href="#cb36-8"></a>img[border_mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb36-9"><a href="#cb36-9"></a></span>
<span id="cb36-10"><a href="#cb36-10"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-26-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="弾の描画" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="弾の描画"><span class="header-section-number">8</span> 弾の描画</h2>
<div class="cell" data-execution_count="26">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb37-2"><a href="#cb37-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a>v <span class="op">=</span> (x_ind <span class="op">-</span> <span class="dv">200</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> <span class="dv">150</span> <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (y_ind <span class="op">-</span> <span class="dv">150</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">/</span> <span class="dv">75</span> <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb37-5"><a href="#cb37-5"></a>img[v <span class="op">&lt;=</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb37-6"><a href="#cb37-6"></a></span>
<span id="cb37-7"><a href="#cb37-7"></a>border_mask <span class="op">=</span> np.logical_and(v <span class="op">&gt;=</span> <span class="fl">.995</span> <span class="op">**</span> <span class="dv">2</span>, v <span class="op">&lt;=</span> <span class="fl">1.005</span> <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb37-8"><a href="#cb37-8"></a>img[border_mask ] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb37-9"><a href="#cb37-9"></a></span>
<span id="cb37-10"><a href="#cb37-10"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-27-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="極座標" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="極座標"><span class="header-section-number">9</span> 極座標</h2>
<div class="cell" data-execution_count="27">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="kw">def</span> cart2pol(x, y):</span>
<span id="cb38-2"><a href="#cb38-2"></a>    r <span class="op">=</span> np.sqrt(x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> y <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb38-3"><a href="#cb38-3"></a>    tehta <span class="op">=</span> np.arctan2(y, x)</span>
<span id="cb38-4"><a href="#cb38-4"></a>    <span class="cf">return</span> (r, theta)</span>
<span id="cb38-5"><a href="#cb38-5"></a></span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="kw">def</span> pol2cart(r, theta):</span>
<span id="cb38-7"><a href="#cb38-7"></a>    x <span class="op">=</span> r <span class="op">*</span> np.cos(theta)</span>
<span id="cb38-8"><a href="#cb38-8"></a>    y <span class="op">=</span> r <span class="op">*</span> np.sin(theta)</span>
<span id="cb38-9"><a href="#cb38-9"></a>    <span class="cf">return</span> (x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="28">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb39-2"><a href="#cb39-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb39-3"><a href="#cb39-3"></a>r, theta <span class="op">=</span> np.sqrt((x_ind <span class="op">-</span> <span class="dv">120</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (y_ind <span class="op">-</span> <span class="dv">150</span>) <span class="op">**</span> <span class="dv">2</span>), np.arctan2(y_ind<span class="op">-</span><span class="dv">150</span>, x_ind<span class="op">-</span><span class="dv">120</span>)</span>
<span id="cb39-4"><a href="#cb39-4"></a>mask <span class="op">=</span> r <span class="op">&lt;=</span> <span class="dv">100</span></span>
<span id="cb39-5"><a href="#cb39-5"></a>img[mask] <span class="op">=</span> <span class="dv">190</span></span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-29-output-1.svg" class="img-fluid"></p>
</div>
</div>
<section id="レムニスケート" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="レムニスケート"><span class="header-section-number">9.1</span> レムニスケート</h3>
<div class="cell" data-execution_count="29">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb40-2"><a href="#cb40-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb40-3"><a href="#cb40-3"></a>r, theta <span class="op">=</span> np.sqrt((x_ind <span class="op">-</span> <span class="dv">200</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (y_ind <span class="op">-</span> <span class="dv">150</span>) <span class="op">**</span> <span class="dv">2</span>), np.arctan2(y_ind<span class="op">-</span><span class="dv">150</span>, x_ind<span class="op">-</span><span class="dv">200</span>)</span>
<span id="cb40-4"><a href="#cb40-4"></a></span>
<span id="cb40-5"><a href="#cb40-5"></a>a <span class="op">=</span> <span class="dv">120</span></span>
<span id="cb40-6"><a href="#cb40-6"></a>mask <span class="op">=</span> r <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> a <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> np.cos(<span class="dv">2</span> <span class="op">*</span> theta) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>img[mask] <span class="op">=</span> <span class="dv">190</span></span>
<span id="cb40-8"><a href="#cb40-8"></a></span>
<span id="cb40-9"><a href="#cb40-9"></a>gray_show(img)</span>
<span id="cb40-10"><a href="#cb40-10"></a></span>
<span id="cb40-11"><a href="#cb40-11"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-30-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="カラー画像の作り方" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="カラー画像の作り方"><span class="header-section-number">10</span> カラー画像の作り方</h2>
<div class="cell" data-execution_count="30">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1"></a>r_ch <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb41-2"><a href="#cb41-2"></a>g_ch <span class="op">=</span> np.zeros_like(r_ch)</span>
<span id="cb41-3"><a href="#cb41-3"></a>b_ch <span class="op">=</span> np.zeros_like(g_ch)</span>
<span id="cb41-4"><a href="#cb41-4"></a></span>
<span id="cb41-5"><a href="#cb41-5"></a><span class="co"># 3次元目に新しい軸を追加する. </span></span>
<span id="cb41-6"><a href="#cb41-6"></a>img <span class="op">=</span> np.stack([r_ch, g_ch, b_ch], axis <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb41-7"><a href="#cb41-7"></a>img.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>(300, 400, 3)</code></pre>
</div>
</div>
<p>あるいは,</p>
<div class="cell" data-execution_count="31">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1"></a>img <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">3</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb43-2"><a href="#cb43-2"></a>img.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>(300, 400, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">7</span>))</span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb45-3"><a href="#cb45-3"></a>    img <span class="op">=</span> np.zeros((<span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">3</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb45-4"><a href="#cb45-4"></a>    <span class="co"># 3チャンネルのうち1つだけ塗りつぶしを行う. </span></span>
<span id="cb45-5"><a href="#cb45-5"></a>    img[..., i] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">3</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb45-7"><a href="#cb45-7"></a>    <span class="co"># カラー画像の場合には範囲指定をする必要がない</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>    ax.imshow(img)</span>
<span id="cb45-9"><a href="#cb45-9"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-33-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="33">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>img[<span class="dv">0</span>, <span class="dv">0</span>, :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([  0,   0, 255], dtype=uint8)</code></pre>
</div>
</div>
</section>
<section id="カラー画像での矩形塗りつぶし" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="カラー画像での矩形塗りつぶし"><span class="header-section-number">11</span> カラー画像での矩形塗りつぶし</h2>
<div class="cell" data-execution_count="34">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a>img <span class="op">=</span> np.full((<span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="co"># 境界用の矩形</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>img[<span class="dv">149</span>:<span class="dv">251</span>, <span class="dv">99</span>:<span class="dv">301</span>, :] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="co"># 境界用の矩形の内側を塗りつぶし</span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="co"># [None, None, :]はなくてもよい. ただし次元が合っている感が出るのであった方がわかりやすい気がする. </span></span>
<span id="cb48-6"><a href="#cb48-6"></a>img[<span class="dv">150</span>:<span class="dv">250</span>, <span class="dv">100</span>:<span class="dv">300</span>, :] <span class="op">=</span> np.array([<span class="dv">64</span>, <span class="dv">230</span>, <span class="dv">209</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>plt.imshow(img)</span>
<span id="cb48-9"><a href="#cb48-9"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-35-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="テキストの描画" class="level2" data-number="12">
<h2 data-number="12" class="anchored" data-anchor-id="テキストの描画"><span class="header-section-number">12</span> テキストの描画</h2>
<div class="cell" data-execution_count="35">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1"></a><span class="im">from</span> PIL <span class="im">import</span> Image, ImageDraw, ImageFont</span>
<span id="cb49-2"><a href="#cb49-2"></a></span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="cf">with</span> Image.new(<span class="st">"RGB"</span>, (<span class="dv">400</span>, <span class="dv">300</span>), color<span class="op">=</span>(<span class="dv">255</span>, <span class="dv">255</span>,<span class="dv">255</span>)) <span class="im">as</span> canvas:    </span>
<span id="cb49-4"><a href="#cb49-4"></a>    draw <span class="op">=</span> ImageDraw.Draw(canvas)    </span>
<span id="cb49-5"><a href="#cb49-5"></a>    font <span class="op">=</span>ImageFont.truetype(<span class="st">"numpy_book/fonts/M_PLUS_1p/MPLUS1p-Bold.ttf"</span>, <span class="dv">38</span>)    </span>
<span id="cb49-6"><a href="#cb49-6"></a>    draw.text((<span class="dv">30</span>, <span class="dv">30</span>), <span class="st">"こしあんは美味しい"</span>, font<span class="op">=</span>font, fill<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb49-7"><a href="#cb49-7"></a></span>
<span id="cb49-8"><a href="#cb49-8"></a>    plt.imshow(canvas)</span>
<span id="cb49-9"><a href="#cb49-9"></a>    plt.show()</span>
<span id="cb49-10"><a href="#cb49-10"></a>    </span>
<span id="cb49-11"><a href="#cb49-11"></a>    text_array <span class="op">=</span> np.array(canvas)</span>
<span id="cb49-12"><a href="#cb49-12"></a>    <span class="bu">print</span>(text_array.dtype, text_array.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-36-output-1.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>uint8 (300, 400, 3)</code></pre>
</div>
</div>
<section id="テキスト画像のトリミング" class="level3" data-number="12.1">
<h3 data-number="12.1" class="anchored" data-anchor-id="テキスト画像のトリミング"><span class="header-section-number">12.1</span> テキスト画像のトリミング</h3>
<div class="cell" data-execution_count="36">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1"></a>text_points <span class="op">=</span> np.where(text_array[:, :, <span class="dv">0</span>] <span class="op">==</span> <span class="dv">0</span>) <span class="co"># 白か黑かしかないのでR=0で判定</span></span>
<span id="cb51-2"><a href="#cb51-2"></a>text_area <span class="op">=</span> [np.<span class="bu">min</span>(text_points[<span class="dv">0</span>]),np.<span class="bu">min</span>(text_points[<span class="dv">1</span>]), np.<span class="bu">max</span>(text_points[<span class="dv">0</span>]),np.<span class="bu">max</span>(text_points[<span class="dv">1</span>])]</span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="bu">print</span>(text_area) <span class="co"># [40, 35, 73, 367]</span></span>
<span id="cb51-4"><a href="#cb51-4"></a>text_array_trimmed <span class="op">=</span>text_array[text_area[<span class="dv">0</span>]:text_area[<span class="dv">2</span>]<span class="op">+</span><span class="dv">1</span>,text_area[<span class="dv">1</span>]:text_area[<span class="dv">3</span>]<span class="op">+</span><span class="dv">1</span>, :] <span class="co"># 終端に+1をする</span></span>
<span id="cb51-5"><a href="#cb51-5"></a></span>
<span id="cb51-6"><a href="#cb51-6"></a>plt.imshow(text_array_trimmed)</span>
<span id="cb51-7"><a href="#cb51-7"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[40, 35, 73, 367]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-37-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="テキストへのグラデーション" class="level3" data-number="12.2">
<h3 data-number="12.2" class="anchored" data-anchor-id="テキストへのグラデーション"><span class="header-section-number">12.2</span> テキストへのグラデーション</h3>
<div class="cell" data-execution_count="37">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1"></a>gradients <span class="op">=</span> np.empty_like(text_array_trimmed)<span class="co"># (R,G,B) = (255, 51, 51) -&gt; (51, 51, 255)への縦グラデーション</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>gradients[:,:,<span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">255</span>, <span class="dv">51</span>,gradients.shape[<span class="dv">1</span>], dtype<span class="op">=</span>np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb53-3"><a href="#cb53-3"></a>gradients[:,:,<span class="dv">1</span>] <span class="op">=</span> <span class="dv">51</span></span>
<span id="cb53-4"><a href="#cb53-4"></a>gradients[:,:,<span class="dv">2</span>] <span class="op">=</span> np.linspace(<span class="dv">51</span>, <span class="dv">255</span>,gradients.shape[<span class="dv">1</span>], dtype<span class="op">=</span>np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb53-5"><a href="#cb53-5"></a>plt.imshow(gradients)</span>
<span id="cb53-6"><a href="#cb53-6"></a>plt.show()<span class="co"># テキストのレイヤーマスク</span></span>
<span id="cb53-7"><a href="#cb53-7"></a>layer_mask <span class="op">=</span> (text_array_trimmed[:,:,<span class="dv">0</span>] <span class="op">==</span><span class="dv">0</span>).astype(np.uint8)[:, :, <span class="va">None</span>]<span class="co"># グラデーションをテキストに乗せる</span></span>
<span id="cb53-8"><a href="#cb53-8"></a>output <span class="op">=</span> text_array_trimmed <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>layer_mask) <span class="op">+</span> gradients <span class="op">*</span> layer_mask</span>
<span id="cb53-9"><a href="#cb53-9"></a>plt.imshow(output)</span>
<span id="cb53-10"><a href="#cb53-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-38-output-1.svg" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-38-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="pillowとnumpy配列の相互変換" class="level2" data-number="13">
<h2 data-number="13" class="anchored" data-anchor-id="pillowとnumpy配列の相互変換"><span class="header-section-number">13</span> PillowとNumPy配列の相互変換</h2>
<section id="pillow---numpyへの変換" class="level3" data-number="13.1">
<h3 data-number="13.1" class="anchored" data-anchor-id="pillow---numpyへの変換"><span class="header-section-number">13.1</span> Pillow -&gt; NumPyへの変換</h3>
<div class="cell" data-execution_count="38">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb54-2"><a href="#cb54-2"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="bu">print</span>(x.shape, x.dtype)</span>
<span id="cb54-4"><a href="#cb54-4"></a>plt.imshow(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(960, 1280, 3) uint8</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5f68e50&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-39-output-3.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="39">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1"></a><span class="co"># ネガポジ反転</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>negpos <span class="op">=</span> <span class="dv">255</span> <span class="op">-</span> x</span>
<span id="cb57-3"><a href="#cb57-3"></a>plt.imshow(negpos)</span>
<span id="cb57-4"><a href="#cb57-4"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-40-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="numpy配列-pillowの変換" class="level3" data-number="13.2">
<h3 data-number="13.2" class="anchored" data-anchor-id="numpy配列-pillowの変換"><span class="header-section-number">13.2</span> NumPy配列 ⇒ Pillowの変換</h3>
<div class="cell" data-execution_count="40">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1"></a>x <span class="op">=</span> np.zeros((<span class="dv">4000</span>, <span class="dv">6000</span>, <span class="dv">3</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb58-2"><a href="#cb58-2"></a>x[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">255</span>, x.shape[<span class="dv">1</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb58-3"><a href="#cb58-3"></a>x[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb58-4"><a href="#cb58-4"></a>x[..., <span class="dv">2</span>] <span class="op">=</span> np.linspace(<span class="dv">255</span>, <span class="dv">0</span>, x.shape[<span class="dv">1</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb58-5"><a href="#cb58-5"></a></span>
<span id="cb58-6"><a href="#cb58-6"></a><span class="cf">with</span> Image.fromarray(x) <span class="im">as</span> img:</span>
<span id="cb58-7"><a href="#cb58-7"></a>    img.save(<span class="st">"out/color_gradient.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="41">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"dat/2019-01-03 11.08.15.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb59-2"><a href="#cb59-2"></a>    plt.imshow(img)</span>
<span id="cb59-3"><a href="#cb59-3"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb59-4"><a href="#cb59-4"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-42-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="42">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(3024, 4032, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="43">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>, <span class="dv">8</span>))</span>
<span id="cb62-2"><a href="#cb62-2"></a></span>
<span id="cb62-3"><a href="#cb62-3"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb62-4"><a href="#cb62-4"></a>    v <span class="op">=</span> np.zeros_like(x)</span>
<span id="cb62-5"><a href="#cb62-5"></a>    v[..., i] <span class="op">=</span> x[..., i]</span>
<span id="cb62-6"><a href="#cb62-6"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">+</span> i)</span>
<span id="cb62-7"><a href="#cb62-7"></a>    ax.imshow(v)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-44-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="演習問題" class="level2" data-number="14">
<h2 data-number="14" class="anchored" data-anchor-id="演習問題"><span class="header-section-number">14</span> 演習問題</h2>
<section id="q1べた塗りグレースケール" class="level3" data-number="14.1">
<h3 data-number="14.1" class="anchored" data-anchor-id="q1べた塗りグレースケール"><span class="header-section-number">14.1</span> Q1:べた塗りグレースケール</h3>
<div class="cell" data-execution_count="44">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1"></a>img1 <span class="op">=</span> np.zeros((<span class="dv">128</span>, <span class="dv">128</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb63-2"><a href="#cb63-2"></a></span>
<span id="cb63-3"><a href="#cb63-3"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>, <span class="dv">8</span>))</span>
<span id="cb63-4"><a href="#cb63-4"></a>colors <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">128</span>, <span class="dv">192</span>]</span>
<span id="cb63-5"><a href="#cb63-5"></a><span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(colors):</span>
<span id="cb63-6"><a href="#cb63-6"></a>    v <span class="op">=</span> np.zeros_like(img1)</span>
<span id="cb63-7"><a href="#cb63-7"></a>    v[...] <span class="op">=</span> c</span>
<span id="cb63-8"><a href="#cb63-8"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">+</span> i)</span>
<span id="cb63-9"><a href="#cb63-9"></a>    ax.imshow(v, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-45-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="45">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1"></a>img1 <span class="op">=</span> np.zeros((<span class="dv">512</span>, <span class="dv">512</span>), dtype <span class="op">=</span> np.uint8)</span>
<span id="cb64-2"><a href="#cb64-2"></a></span>
<span id="cb64-3"><a href="#cb64-3"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>, <span class="dv">8</span>))</span>
<span id="cb64-4"><a href="#cb64-4"></a>colors <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">128</span>, <span class="dv">192</span>]</span>
<span id="cb64-5"><a href="#cb64-5"></a><span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(colors):</span>
<span id="cb64-6"><a href="#cb64-6"></a>    v <span class="op">=</span> np.zeros_like(img1)</span>
<span id="cb64-7"><a href="#cb64-7"></a>    v[...] <span class="op">=</span> c</span>
<span id="cb64-8"><a href="#cb64-8"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span> <span class="op">+</span> i)</span>
<span id="cb64-9"><a href="#cb64-9"></a>    ax.imshow(v, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-46-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q2四角形のぬりつぶし" class="level3" data-number="14.2">
<h3 data-number="14.2" class="anchored" data-anchor-id="q2四角形のぬりつぶし"><span class="header-section-number">14.2</span> Q2:四角形のぬりつぶし</h3>
<div class="cell" data-execution_count="46">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb65-2"><a href="#cb65-2"></a>canvas <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb65-3"><a href="#cb65-3"></a>canvas[<span class="dv">100</span>:(<span class="dv">100</span> <span class="op">+</span> <span class="dv">200</span>), <span class="dv">100</span>:(<span class="dv">100</span> <span class="op">+</span> <span class="dv">100</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb65-4"><a href="#cb65-4"></a>canvas[<span class="dv">400</span>:(<span class="dv">400</span> <span class="op">+</span> <span class="dv">150</span>), <span class="dv">200</span>:(<span class="dv">200</span> <span class="op">+</span> <span class="dv">250</span>)] <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb65-5"><a href="#cb65-5"></a></span>
<span id="cb65-6"><a href="#cb65-6"></a>plt.imshow(canvas, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5d5dcd0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-47-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="画像の保存" class="level3" data-number="14.3">
<h3 data-number="14.3" class="anchored" data-anchor-id="画像の保存"><span class="header-section-number">14.3</span> 画像の保存</h3>
<div class="cell" data-execution_count="47">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1"></a></span>
<span id="cb67-2"><a href="#cb67-2"></a>plt.imsave(<span class="st">"out/question03.png"</span>, canvas, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="円の塗りつぶし" class="level3" data-number="14.4">
<h3 data-number="14.4" class="anchored" data-anchor-id="円の塗りつぶし"><span class="header-section-number">14.4</span> 円の塗りつぶし</h3>
<div class="cell" data-execution_count="48">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb68-2"><a href="#cb68-2"></a>img <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="49">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1"></a>ox, oy <span class="op">=</span> <span class="dv">200</span>, <span class="dv">240</span></span>
<span id="cb69-2"><a href="#cb69-2"></a>r <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb69-3"><a href="#cb69-3"></a>c <span class="op">=</span> <span class="dv">64</span></span>
<span id="cb69-4"><a href="#cb69-4"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb69-5"><a href="#cb69-5"></a>mask <span class="op">=</span> (idx <span class="op">-</span> ox) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idy <span class="op">-</span> oy) <span class="op">**</span> <span class="dv">2</span> <span class="op">&lt;=</span> r <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb69-6"><a href="#cb69-6"></a>img[mask] <span class="op">=</span> c</span>
<span id="cb69-7"><a href="#cb69-7"></a></span>
<span id="cb69-8"><a href="#cb69-8"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-50-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q5平方数の直線" class="level3" data-number="14.5">
<h3 data-number="14.5" class="anchored" data-anchor-id="q5平方数の直線"><span class="header-section-number">14.5</span> Q5:平方数の直線</h3>
<div class="cell" data-execution_count="50">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>img <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="51">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>img <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb71-3"><a href="#cb71-3"></a>N <span class="op">=</span> np.ceil(np.sqrt(H))</span>
<span id="cb71-4"><a href="#cb71-4"></a>width <span class="op">=</span> <span class="fl">.5</span></span>
<span id="cb71-5"><a href="#cb71-5"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">int</span>(N)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb71-6"><a href="#cb71-6"></a>    oy, ox <span class="op">=</span> i <span class="op">**</span> <span class="dv">2</span>, i <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb71-7"><a href="#cb71-7"></a>    oyn, oxn <span class="op">=</span> (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">**</span> <span class="dv">2</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb71-8"><a href="#cb71-8"></a>    idy, idx <span class="op">=</span> np.indices((oxn <span class="op">-</span> ox, oyn <span class="op">-</span> oy))</span>
<span id="cb71-9"><a href="#cb71-9"></a>    xhat     <span class="op">=</span> (oxn <span class="op">-</span> ox) <span class="op">/</span> (oyn <span class="op">-</span> oy) <span class="op">*</span> idy <span class="op">+</span> ox</span>
<span id="cb71-10"><a href="#cb71-10"></a>    mask     <span class="op">=</span> np.<span class="bu">abs</span>(xhat <span class="op">-</span> (ox <span class="op">+</span> idx)) <span class="op">&lt;=</span> width</span>
<span id="cb71-11"><a href="#cb71-11"></a>    img[oy:oyn, ox:oxn] <span class="op">=</span> <span class="dv">255</span> <span class="op">*</span> np.logical_not(mask)</span>
<span id="cb71-12"><a href="#cb71-12"></a></span>
<span id="cb71-13"><a href="#cb71-13"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb71-14"><a href="#cb71-14"></a>ax.set_aspect(<span class="st">"equal"</span>)</span>
<span id="cb71-15"><a href="#cb71-15"></a>ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e83e4ac0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-52-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q6斜めの線" class="level3" data-number="14.6">
<h3 data-number="14.6" class="anchored" data-anchor-id="q6斜めの線"><span class="header-section-number">14.6</span> Q6:斜めの線</h3>
<div class="cell" data-execution_count="52">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb73-3"><a href="#cb73-3"></a>lwd <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb73-4"><a href="#cb73-4"></a></span>
<span id="cb73-5"><a href="#cb73-5"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb73-6"><a href="#cb73-6"></a>xhat   <span class="op">=</span> idy <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb73-7"><a href="#cb73-7"></a>xslide <span class="op">=</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">450</span>, <span class="dv">601</span>, <span class="dv">50</span>)</span>
<span id="cb73-8"><a href="#cb73-8"></a></span>
<span id="cb73-9"><a href="#cb73-9"></a><span class="cf">for</span> i <span class="kw">in</span> xslide:</span>
<span id="cb73-10"><a href="#cb73-10"></a>    mask <span class="op">=</span> np.<span class="bu">abs</span>(xhat <span class="op">-</span> (idx <span class="op">-</span> i)) <span class="op">&lt;=</span> lwd</span>
<span id="cb73-11"><a href="#cb73-11"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb73-12"><a href="#cb73-12"></a></span>
<span id="cb73-13"><a href="#cb73-13"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb73-14"><a href="#cb73-14"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="52">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e70fcfd0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-54-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="53">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1"></a>idx</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>array([[  0,   1,   2, ..., 637, 638, 639],
       [  0,   1,   2, ..., 637, 638, 639],
       [  0,   1,   2, ..., 637, 638, 639],
       ...,
       [  0,   1,   2, ..., 637, 638, 639],
       [  0,   1,   2, ..., 637, 638, 639],
       [  0,   1,   2, ..., 637, 638, 639]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1"></a>xhat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([[  0. ,   0. ,   0. , ...,   0. ,   0. ,   0. ],
       [  0.5,   0.5,   0.5, ...,   0.5,   0.5,   0.5],
       [  1. ,   1. ,   1. , ...,   1. ,   1. ,   1. ],
       ...,
       [238.5, 238.5, 238.5, ..., 238.5, 238.5, 238.5],
       [239. , 239. , 239. , ..., 239. , 239. , 239. ],
       [239.5, 239.5, 239.5, ..., 239.5, 239.5, 239.5]])</code></pre>
</div>
</div>
</section>
<section id="q7同心円" class="level3" data-number="14.7">
<h3 data-number="14.7" class="anchored" data-anchor-id="q7同心円"><span class="header-section-number">14.7</span> Q7:同心円</h3>
<div class="cell" data-execution_count="55">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb79-3"><a href="#cb79-3"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb79-4"><a href="#cb79-4"></a>ox, oy <span class="op">=</span> (<span class="dv">320</span>, <span class="dv">240</span>)</span>
<span id="cb79-5"><a href="#cb79-5"></a>r_seq  <span class="op">=</span> <span class="bu">range</span>(<span class="dv">50</span>, <span class="dv">351</span>, <span class="dv">50</span>)</span>
<span id="cb79-6"><a href="#cb79-6"></a>lwd    <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb79-7"><a href="#cb79-7"></a></span>
<span id="cb79-8"><a href="#cb79-8"></a>dist <span class="op">=</span> (idy <span class="op">-</span> oy) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idx <span class="op">-</span> ox) <span class="op">**</span> <span class="dv">2</span> </span>
<span id="cb79-9"><a href="#cb79-9"></a></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="cf">for</span> r <span class="kw">in</span> r_seq:</span>
<span id="cb79-11"><a href="#cb79-11"></a>    mask <span class="op">=</span> np.logical_and(dist <span class="op">&gt;=</span> (r<span class="op">-</span>lwd)<span class="op">**</span><span class="dv">2</span>, dist <span class="op">&lt;=</span> (r<span class="op">+</span>lwd)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb79-12"><a href="#cb79-12"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb79-13"><a href="#cb79-13"></a></span>
<span id="cb79-14"><a href="#cb79-14"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e7186220&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-57-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q8アンチエイリアス" class="level3" data-number="14.8">
<h3 data-number="14.8" class="anchored" data-anchor-id="q8アンチエイリアス"><span class="header-section-number">14.8</span> Q8:アンチエイリアス</h3>
<div class="cell" data-execution_count="56">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb81-2"><a href="#cb81-2"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb81-3"><a href="#cb81-3"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb81-4"><a href="#cb81-4"></a>ox, oy <span class="op">=</span> (<span class="dv">320</span>, <span class="dv">240</span>)</span>
<span id="cb81-5"><a href="#cb81-5"></a>r_seq  <span class="op">=</span> <span class="bu">range</span>(<span class="dv">50</span>, <span class="dv">351</span>, <span class="dv">50</span>)</span>
<span id="cb81-6"><a href="#cb81-6"></a>lwd    <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb81-7"><a href="#cb81-7"></a></span>
<span id="cb81-8"><a href="#cb81-8"></a>dist <span class="op">=</span> (idy <span class="op">-</span> oy) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idx <span class="op">-</span> ox) <span class="op">**</span> <span class="dv">2</span> </span>
<span id="cb81-9"><a href="#cb81-9"></a></span>
<span id="cb81-10"><a href="#cb81-10"></a><span class="cf">for</span> r <span class="kw">in</span> r_seq:</span>
<span id="cb81-11"><a href="#cb81-11"></a>    <span class="co"># 2段階で処理を行う</span></span>
<span id="cb81-12"><a href="#cb81-12"></a>    <span class="co"># 少し広い範囲を灰色に塗り</span></span>
<span id="cb81-13"><a href="#cb81-13"></a>    <span class="co"># 通常の範囲を黒で塗りつぶす</span></span>
<span id="cb81-14"><a href="#cb81-14"></a>    mask <span class="op">=</span> np.logical_and(dist <span class="op">&gt;=</span> (r<span class="op">-</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>, dist <span class="op">&lt;=</span> (r<span class="op">+</span><span class="dv">1</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb81-15"><a href="#cb81-15"></a>    img[mask] <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb81-16"><a href="#cb81-16"></a>    mask <span class="op">=</span> np.logical_and(dist <span class="op">&gt;=</span> (r<span class="op">-</span><span class="fl">.5</span>)<span class="op">**</span><span class="dv">2</span>, dist <span class="op">&lt;=</span> (r<span class="op">+</span><span class="fl">.5</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb81-17"><a href="#cb81-17"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb81-18"><a href="#cb81-18"></a></span>
<span id="cb81-19"><a href="#cb81-19"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e71d94f0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-58-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q9スーパー楕円" class="level3" data-number="14.9">
<h3 data-number="14.9" class="anchored" data-anchor-id="q9スーパー楕円"><span class="header-section-number">14.9</span> Q9:スーパー楕円</h3>
<div class="cell" data-execution_count="57">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb83-2"><a href="#cb83-2"></a>ox, oy <span class="op">=</span> W <span class="op">//</span> <span class="dv">2</span>, H <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb83-3"><a href="#cb83-3"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb83-4"><a href="#cb83-4"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb83-5"><a href="#cb83-5"></a></span>
<span id="cb83-6"><a href="#cb83-6"></a>M <span class="op">=</span> np.linspace(<span class="fl">.5</span>, <span class="dv">2</span>, <span class="dv">15</span>)</span>
<span id="cb83-7"><a href="#cb83-7"></a>a <span class="op">=</span> <span class="dv">280</span></span>
<span id="cb83-8"><a href="#cb83-8"></a>b <span class="op">=</span> <span class="dv">200</span></span>
<span id="cb83-9"><a href="#cb83-9"></a></span>
<span id="cb83-10"><a href="#cb83-10"></a><span class="cf">for</span> i, m <span class="kw">in</span> <span class="bu">enumerate</span>(M):</span>
<span id="cb83-11"><a href="#cb83-11"></a>    z <span class="op">=</span> np.<span class="bu">abs</span>((idx <span class="op">-</span> ox) <span class="op">/</span> a) <span class="op">**</span> m <span class="op">+</span> np.<span class="bu">abs</span>((idy <span class="op">-</span> oy) <span class="op">/</span> b) <span class="op">**</span> m</span>
<span id="cb83-12"><a href="#cb83-12"></a>    mask <span class="op">=</span> np.logical_and(z <span class="op">&gt;=</span> <span class="fl">0.995</span>, z <span class="op">&lt;=</span> <span class="fl">1.005</span>)</span>
<span id="cb83-13"><a href="#cb83-13"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb83-14"><a href="#cb83-14"></a></span>
<span id="cb83-15"><a href="#cb83-15"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="57">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e728f760&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-59-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q10カージオイド" class="level3" data-number="14.10">
<h3 data-number="14.10" class="anchored" data-anchor-id="q10カージオイド"><span class="header-section-number">14.10</span> Q10:カージオイド</h3>
<div class="cell" data-execution_count="58">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb85-2"><a href="#cb85-2"></a>ox, oy <span class="op">=</span> <span class="dv">320</span>, <span class="dv">240</span></span>
<span id="cb85-3"><a href="#cb85-3"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb85-4"><a href="#cb85-4"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb85-5"><a href="#cb85-5"></a></span>
<span id="cb85-6"><a href="#cb85-6"></a>a <span class="op">=</span> <span class="dv">150</span></span>
<span id="cb85-7"><a href="#cb85-7"></a>c <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb85-8"><a href="#cb85-8"></a></span>
<span id="cb85-9"><a href="#cb85-9"></a>theta <span class="op">=</span> np.arctan2(idy<span class="op">-</span>oy, idx<span class="op">-</span>ox)</span>
<span id="cb85-10"><a href="#cb85-10"></a>r     <span class="op">=</span> a <span class="op">*</span> (<span class="dv">1</span> <span class="op">+</span> np.cos(theta))</span>
<span id="cb85-11"><a href="#cb85-11"></a>d2    <span class="op">=</span> (idy <span class="op">-</span> oy) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idx <span class="op">-</span> ox) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb85-12"><a href="#cb85-12"></a>mask  <span class="op">=</span> (d2 <span class="op">-</span> r <span class="op">**</span> <span class="dv">2</span>) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb85-13"><a href="#cb85-13"></a>img[mask] <span class="op">=</span> c</span>
<span id="cb85-14"><a href="#cb85-14"></a></span>
<span id="cb85-15"><a href="#cb85-15"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="58">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5dc6370&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-60-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q11円周率の近似値" class="level3" data-number="14.11">
<h3 data-number="14.11" class="anchored" data-anchor-id="q11円周率の近似値"><span class="header-section-number">14.11</span> Q11:円周率の近似値</h3>
<div class="cell" data-execution_count="59">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1"></a>r_seq <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>]</span>
<span id="cb87-2"><a href="#cb87-2"></a></span>
<span id="cb87-3"><a href="#cb87-3"></a><span class="cf">for</span> r <span class="kw">in</span> r_seq:</span>
<span id="cb87-4"><a href="#cb87-4"></a>    idy, idx <span class="op">=</span> np.indices((r, r))</span>
<span id="cb87-5"><a href="#cb87-5"></a>    area <span class="op">=</span> r <span class="op">*</span> r</span>
<span id="cb87-6"><a href="#cb87-6"></a>    mask <span class="op">=</span> idy <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idx <span class="op">**</span> <span class="dv">2</span> <span class="op">&lt;=</span> area</span>
<span id="cb87-7"><a href="#cb87-7"></a>    pi   <span class="op">=</span> np.<span class="bu">sum</span>(mask) <span class="op">/</span> area  <span class="op">*</span> <span class="dv">4</span></span>
<span id="cb87-8"><a href="#cb87-8"></a>    <span class="bu">print</span>(r, pi, np.pi <span class="op">-</span> pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>100 3.1812 -0.03960734641020691
200 3.1606 -0.01900734641020696
500 3.149376 -0.007783346410207059
1000 3.145544 -0.003951346410207002
2000 3.143585 -0.0019923464102067356
5000 3.14238688 -0.0007942264102069885
10000 3.14199048 -0.000397826410206914</code></pre>
</div>
</div>
</section>
<section id="q12積分の数値計算" class="level3" data-number="14.12">
<h3 data-number="14.12" class="anchored" data-anchor-id="q12積分の数値計算"><span class="header-section-number">14.12</span> Q12:積分の数値計算</h3>
<div class="cell" data-execution_count="60">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1"></a><span class="bu">print</span> (<span class="dv">3</span> <span class="op">/</span> <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>0.375</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1"></a>a_seq <span class="op">=</span> [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">5000</span>]</span>
<span id="cb91-2"><a href="#cb91-2"></a>true      <span class="op">=</span> <span class="dv">3</span> <span class="op">/</span> <span class="dv">8</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>grid_size <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>idy, idx  <span class="op">=</span> np.indices((grid_size, grid_size))</span>
<span id="cb91-5"><a href="#cb91-5"></a>z <span class="op">=</span> np.<span class="bu">abs</span>(idy <span class="op">-</span> grid_size <span class="op">/</span> <span class="dv">2</span>) <span class="op">**</span> (<span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span>) <span class="op">+</span> np.<span class="bu">abs</span>(idx <span class="op">-</span> grid_size <span class="op">/</span> <span class="dv">2</span>) <span class="op">**</span> (<span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span>)</span>
<span id="cb91-6"><a href="#cb91-6"></a></span>
<span id="cb91-7"><a href="#cb91-7"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">12</span>))</span>
<span id="cb91-8"><a href="#cb91-8"></a><span class="cf">for</span> i, a <span class="kw">in</span> <span class="bu">enumerate</span>(a_seq, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb91-9"><a href="#cb91-9"></a>    img <span class="op">=</span> np.full((grid_size, grid_size), <span class="dv">255</span>)</span>
<span id="cb91-10"><a href="#cb91-10"></a>    mask <span class="op">=</span> z <span class="op">&lt;=</span> a <span class="op">**</span> (<span class="dv">2</span> <span class="op">/</span> <span class="dv">3</span>)</span>
<span id="cb91-11"><a href="#cb91-11"></a>    img[mask] <span class="op">=</span> <span class="dv">128</span></span>
<span id="cb91-12"><a href="#cb91-12"></a>    <span class="bu">print</span>(a, <span class="st">"snorm = "</span>, np.<span class="bu">sum</span>(mask) <span class="op">/</span> np.pi <span class="op">/</span> a <span class="op">/</span> a)</span>
<span id="cb91-13"><a href="#cb91-13"></a>    <span class="cf">if</span> a <span class="op">==</span> a_seq[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb91-14"><a href="#cb91-14"></a>        ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb91-15"><a href="#cb91-15"></a>        ax.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>100 snorm =  0.3750008769131238
200 snorm =  0.37497700367166004
500 snorm =  0.37503652762037637
1000 snorm =  0.37502920649299415
2000 snorm =  0.3750070043784328
5000 snorm =  0.37500106789905546</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-63-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q13オウム貝の螺旋" class="level3" data-number="14.13">
<h3 data-number="14.13" class="anchored" data-anchor-id="q13オウム貝の螺旋"><span class="header-section-number">14.13</span> Q13:オウム貝の螺旋</h3>
<div class="cell" data-execution_count="62">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1"></a>W, H <span class="op">=</span> <span class="dv">640</span>, <span class="dv">480</span></span>
<span id="cb93-2"><a href="#cb93-2"></a>img <span class="op">=</span> np.full((H, W), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb93-3"><a href="#cb93-3"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb93-4"><a href="#cb93-4"></a></span>
<span id="cb93-5"><a href="#cb93-5"></a>d2 <span class="op">=</span> (idy <span class="op">-</span> H <span class="op">//</span> <span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idx <span class="op">-</span> W <span class="op">//</span> <span class="dv">2</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb93-6"><a href="#cb93-6"></a>thetas  <span class="op">=</span> np.arctan2(idy <span class="op">-</span> H <span class="op">//</span> <span class="dv">2</span>, idx <span class="op">-</span> W <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb93-7"><a href="#cb93-7"></a>offsets <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> np.pi <span class="op">*</span> np.arange(<span class="dv">10</span>)</span>
<span id="cb93-8"><a href="#cb93-8"></a></span>
<span id="cb93-9"><a href="#cb93-9"></a><span class="cf">for</span> offset <span class="kw">in</span> offsets:</span>
<span id="cb93-10"><a href="#cb93-10"></a>    r  <span class="op">=</span> <span class="dv">2</span> <span class="op">**</span> ((offset <span class="op">+</span> thetas) <span class="op">/</span> <span class="dv">7</span>)</span>
<span id="cb93-11"><a href="#cb93-11"></a>    lower2 <span class="op">=</span> (r <span class="op">-</span> <span class="fl">.5</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb93-12"><a href="#cb93-12"></a>    upper2 <span class="op">=</span> (r <span class="op">+</span> <span class="fl">.5</span>) <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb93-13"><a href="#cb93-13"></a>    mask <span class="op">=</span> np.logical_and(d2 <span class="op">&gt;=</span> lower2, d2 <span class="op">&lt;=</span> upper2)</span>
<span id="cb93-14"><a href="#cb93-14"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb93-15"><a href="#cb93-15"></a></span>
<span id="cb93-16"><a href="#cb93-16"></a></span>
<span id="cb93-17"><a href="#cb93-17"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-64-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="63">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1"></a>img <span class="op">=</span> np.full((<span class="dv">480</span>, <span class="dv">640</span>), <span class="dv">255</span>, dtype<span class="op">=</span>np.uint8)</span>
<span id="cb94-2"><a href="#cb94-2"></a>y_ind, x_ind <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb94-3"><a href="#cb94-3"></a>x_ind, y_ind <span class="op">=</span> x_ind <span class="op">-</span> <span class="dv">320</span>, y_ind <span class="op">-</span> <span class="dv">240</span></span>
<span id="cb94-4"><a href="#cb94-4"></a>r, theta <span class="op">=</span> np.sqrt(x_ind<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> y_ind<span class="op">**</span><span class="dv">2</span>), np.arctan2(y_ind, x_ind)</span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">10</span>):</span>
<span id="cb94-6"><a href="#cb94-6"></a>    v <span class="op">=</span> <span class="dv">2</span> <span class="op">**</span> ((theta <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> i <span class="op">*</span> np.pi) <span class="op">/</span> <span class="dv">7</span>)</span>
<span id="cb94-7"><a href="#cb94-7"></a>    <span class="co"># ここの-vってなんだっけ・・・・</span></span>
<span id="cb94-8"><a href="#cb94-8"></a>    mask <span class="op">=</span> np.logical_and(v<span class="op">&gt;=</span>r<span class="op">-</span>v<span class="op">-</span><span class="fl">0.5</span>, v<span class="op">&lt;=</span>r<span class="op">-</span>v<span class="op">+</span><span class="fl">0.5</span>)</span>
<span id="cb94-9"><a href="#cb94-9"></a>    img[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb94-10"><a href="#cb94-10"></a>plt.imshow(img, cmap<span class="op">=</span><span class="st">"gray"</span>, vmin<span class="op">=</span><span class="dv">0</span>, vmax<span class="op">=</span><span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="63">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5d15b50&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-65-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="79">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>array([0.])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="64">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1"></a>theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">20</span> <span class="op">*</span> np.pi, <span class="dv">10000</span>)</span>
<span id="cb98-2"><a href="#cb98-2"></a>r     <span class="op">=</span> <span class="dv">2</span> <span class="op">**</span> (theta <span class="op">/</span> <span class="dv">7</span>)</span>
<span id="cb98-3"><a href="#cb98-3"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb98-4"><a href="#cb98-4"></a>ax <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, projection <span class="op">=</span> <span class="st">"polar"</span>)</span>
<span id="cb98-5"><a href="#cb98-5"></a>ax.plot(theta, r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-67-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q14グラデーション１" class="level3" data-number="14.14">
<h3 data-number="14.14" class="anchored" data-anchor-id="q14グラデーション１"><span class="header-section-number">14.14</span> Q14：グラデーション（１）</h3>
<div class="cell" data-execution_count="65">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1"></a>W, H   <span class="op">=</span> <span class="dv">600</span>, <span class="dv">600</span></span>
<span id="cb99-2"><a href="#cb99-2"></a>img    <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb99-3"><a href="#cb99-3"></a>oy, ox <span class="op">=</span> H <span class="op">//</span> <span class="dv">2</span>, W <span class="op">//</span><span class="dv">2</span></span>
<span id="cb99-4"><a href="#cb99-4"></a>R      <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb99-5"><a href="#cb99-5"></a></span>
<span id="cb99-6"><a href="#cb99-6"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb99-7"><a href="#cb99-7"></a>r <span class="op">=</span> np.sqrt((idx <span class="op">-</span> ox) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> (idy <span class="op">-</span> oy) <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb99-8"><a href="#cb99-8"></a>v <span class="op">=</span> np.clip(r, <span class="dv">0</span>, R)</span>
<span id="cb99-9"><a href="#cb99-9"></a>img[:,:] <span class="op">=</span> v</span>
<span id="cb99-10"><a href="#cb99-10"></a></span>
<span id="cb99-11"><a href="#cb99-11"></a></span>
<span id="cb99-12"><a href="#cb99-12"></a>gray_show(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-68-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q14グラデーション２" class="level3" data-number="14.15">
<h3 data-number="14.15" class="anchored" data-anchor-id="q14グラデーション２"><span class="header-section-number">14.15</span> Q14:グラデーション（２）</h3>
<div class="cell" data-execution_count="66">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1"></a>W, H   <span class="op">=</span> <span class="dv">600</span>, <span class="dv">600</span></span>
<span id="cb100-2"><a href="#cb100-2"></a>img    <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb100-3"><a href="#cb100-3"></a>oy, ox <span class="op">=</span> H <span class="op">//</span> <span class="dv">2</span>, W <span class="op">//</span><span class="dv">2</span></span>
<span id="cb100-4"><a href="#cb100-4"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb100-5"><a href="#cb100-5"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> oy, idx <span class="op">-</span> ox</span>
<span id="cb100-6"><a href="#cb100-6"></a></span>
<span id="cb100-7"><a href="#cb100-7"></a>v <span class="op">=</span> idy <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idx <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb100-8"><a href="#cb100-8"></a>white <span class="op">=</span> v[<span class="dv">10</span>, <span class="dv">300</span>]</span>
<span id="cb100-9"><a href="#cb100-9"></a>black <span class="op">=</span> v[<span class="dv">300</span>, <span class="dv">300</span>]</span>
<span id="cb100-10"><a href="#cb100-10"></a>v <span class="op">=</span> <span class="dv">255</span> <span class="op">*</span> (v <span class="op">-</span> black ) <span class="op">/</span> (white <span class="op">-</span> black)</span>
<span id="cb100-11"><a href="#cb100-11"></a>v <span class="op">=</span> np.clip(v, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb100-12"><a href="#cb100-12"></a>img[...] <span class="op">=</span> v</span>
<span id="cb100-13"><a href="#cb100-13"></a></span>
<span id="cb100-14"><a href="#cb100-14"></a>gray_show(img)</span>
<span id="cb100-15"><a href="#cb100-15"></a></span>
<span id="cb100-16"><a href="#cb100-16"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-69-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q16三角形の描画" class="level3" data-number="14.16">
<h3 data-number="14.16" class="anchored" data-anchor-id="q16三角形の描画"><span class="header-section-number">14.16</span> Q16:三角形の描画</h3>
<div class="cell" data-execution_count="67">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1"></a>W, H   <span class="op">=</span> <span class="dv">600</span>, <span class="dv">600</span></span>
<span id="cb101-2"><a href="#cb101-2"></a>img    <span class="op">=</span> np.full((W, H), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb101-3"><a href="#cb101-3"></a>oy, ox <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb101-4"><a href="#cb101-4"></a>idy, idx <span class="op">=</span> np.indices(img.shape)</span>
<span id="cb101-5"><a href="#cb101-5"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> oy, idx <span class="op">-</span> ox</span>
<span id="cb101-6"><a href="#cb101-6"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb101-7"><a href="#cb101-7"></a></span>
<span id="cb101-8"><a href="#cb101-8"></a>mask1 <span class="op">=</span> idy <span class="op">-</span> (<span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> idx <span class="op">+</span> <span class="dv">600</span>) <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb101-9"><a href="#cb101-9"></a>img1 <span class="op">=</span> img.copy()</span>
<span id="cb101-10"><a href="#cb101-10"></a>img1[mask1] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb101-11"><a href="#cb101-11"></a>ax1 <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb101-12"><a href="#cb101-12"></a>ax1.imshow(img1, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb101-13"><a href="#cb101-13"></a></span>
<span id="cb101-14"><a href="#cb101-14"></a>mask2 <span class="op">=</span> idy <span class="op">-</span> (<span class="dv">2</span> <span class="op">*</span> idx <span class="op">-</span> <span class="dv">600</span>) <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb101-15"><a href="#cb101-15"></a>img2 <span class="op">=</span> img.copy()</span>
<span id="cb101-16"><a href="#cb101-16"></a>img2[mask2] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb101-17"><a href="#cb101-17"></a>ax2 <span class="op">=</span> fig.add_subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb101-18"><a href="#cb101-18"></a>ax2.imshow(img2, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb101-19"><a href="#cb101-19"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5f8d1c0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-70-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q17三角形の描画" class="level3" data-number="14.17">
<h3 data-number="14.17" class="anchored" data-anchor-id="q17三角形の描画"><span class="header-section-number">14.17</span> Q17：三角形の描画</h3>
<div class="cell" data-execution_count="68">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1"></a>mask <span class="op">=</span> np.logical_and(mask1, mask2)</span>
<span id="cb103-2"><a href="#cb103-2"></a>img[mask] <span class="op">=</span> <span class="dv">192</span></span>
<span id="cb103-3"><a href="#cb103-3"></a>plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e720f310&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-71-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q18三角形の重心" class="level3" data-number="14.18">
<h3 data-number="14.18" class="anchored" data-anchor-id="q18三角形の重心"><span class="header-section-number">14.18</span> Q18:三角形の重心</h3>
<div class="cell" data-execution_count="69">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1"></a>y, x <span class="op">=</span> np.where(mask)</span>
<span id="cb105-2"><a href="#cb105-2"></a>gy, gx <span class="op">=</span> np.mean(y), np.mean(x)</span>
<span id="cb105-3"><a href="#cb105-3"></a><span class="bu">print</span>(gy, gx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>399.49888888888887 300.0</code></pre>
</div>
</div>
</section>
<section id="q19任意図形の重心" class="level3" data-number="14.19">
<h3 data-number="14.19" class="anchored" data-anchor-id="q19任意図形の重心"><span class="header-section-number">14.19</span> Q19:任意図形の重心</h3>
<div class="cell" data-execution_count="70">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1"></a>file_path <span class="op">=</span> <span class="st">"numpy_book/imgs/dolphin.png"</span></span>
<span id="cb107-2"><a href="#cb107-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(file_path) <span class="im">as</span> img:</span>
<span id="cb107-3"><a href="#cb107-3"></a>    plt.imshow(img, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span>
<span id="cb107-4"><a href="#cb107-4"></a>    dolphin <span class="op">=</span> np.array(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-73-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="71">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1"></a>dolphin.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="71">
<pre><code>(768, 838)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="72">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1"></a>mask <span class="op">=</span> dolphin <span class="op">&lt;</span> <span class="dv">255</span></span>
<span id="cb110-2"><a href="#cb110-2"></a>y, x <span class="op">=</span> np.where(mask)</span>
<span id="cb110-3"><a href="#cb110-3"></a>gy, gx <span class="op">=</span> np.mean(y), np.mean(x)</span>
<span id="cb110-4"><a href="#cb110-4"></a><span class="bu">print</span>(gy, gx)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>292.2499105593379 421.6434334534775</code></pre>
</div>
</div>
<div class="cell" data-execution_count="73">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1"></a>idy, idx <span class="op">=</span> np.indices(dolphin.shape)</span>
<span id="cb112-2"><a href="#cb112-2"></a>mask <span class="op">=</span> np.logical_or(np.<span class="bu">abs</span>(idy <span class="op">-</span> gy) <span class="op">&lt;=</span> <span class="fl">.5</span>, np.<span class="bu">abs</span>(idx <span class="op">-</span>gx) <span class="op">&lt;=</span> <span class="fl">.5</span>)</span>
<span id="cb112-3"><a href="#cb112-3"></a>dolphin[mask] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb112-4"><a href="#cb112-4"></a>plt.imshow(dolphin, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e70264c0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-76-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q20カラー画像" class="level3" data-number="14.20">
<h3 data-number="14.20" class="anchored" data-anchor-id="q20カラー画像"><span class="header-section-number">14.20</span> Q20:カラー画像</h3>
<div class="cell" data-execution_count="74">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1"></a>W, H, C <span class="op">=</span> <span class="dv">600</span>, <span class="dv">400</span>, <span class="dv">3</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>img <span class="op">=</span> np.full((H, W, C), <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb114-3"><a href="#cb114-3"></a></span>
<span id="cb114-4"><a href="#cb114-4"></a>img[:, :<span class="dv">201</span>, <span class="dv">0</span>]    <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb114-5"><a href="#cb114-5"></a>img[:, <span class="dv">201</span>:<span class="dv">401</span>, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb114-6"><a href="#cb114-6"></a>img[:, <span class="dv">401</span>:, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb114-7"><a href="#cb114-7"></a></span>
<span id="cb114-8"><a href="#cb114-8"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="74">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5cddfd0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-77-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q21イタリアの国旗" class="level3" data-number="14.21">
<h3 data-number="14.21" class="anchored" data-anchor-id="q21イタリアの国旗"><span class="header-section-number">14.21</span> Q21:イタリアの国旗</h3>
<div class="cell" data-execution_count="75">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1"></a>W, H, C <span class="op">=</span> <span class="dv">600</span>, <span class="dv">400</span>, <span class="dv">3</span></span>
<span id="cb116-2"><a href="#cb116-2"></a>img <span class="op">=</span> np.full((H, W, C), <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb116-3"><a href="#cb116-3"></a></span>
<span id="cb116-4"><a href="#cb116-4"></a>img[:, :<span class="dv">201</span>]     <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">98</span>, <span class="dv">33</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb116-5"><a href="#cb116-5"></a>img[:, <span class="dv">201</span>:<span class="dv">401</span>]  <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb116-6"><a href="#cb116-6"></a>img[:, <span class="dv">401</span>:]     <span class="op">=</span> np.array([<span class="dv">223</span>, <span class="dv">0</span>, <span class="dv">36</span>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb116-7"><a href="#cb116-7"></a></span>
<span id="cb116-8"><a href="#cb116-8"></a></span>
<span id="cb116-9"><a href="#cb116-9"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5d97b80&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-78-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q223階テンソルの乱数" class="level3" data-number="14.22">
<h3 data-number="14.22" class="anchored" data-anchor-id="q223階テンソルの乱数"><span class="header-section-number">14.22</span> Q22：3階テンソルの乱数</h3>
<p>カラー画像は３次元なので３階テンソルと呼ばれる。</p>
<div class="cell" data-execution_count="76">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1"></a>img <span class="op">=</span> np.random.rand(<span class="dv">250</span>, <span class="dv">200</span>, <span class="dv">10</span>)</span>
<span id="cb118-2"><a href="#cb118-2"></a>img.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>(250, 200, 10)</code></pre>
</div>
</div>
</section>
<section id="q23ホワイトノイズ" class="level3" data-number="14.23">
<h3 data-number="14.23" class="anchored" data-anchor-id="q23ホワイトノイズ"><span class="header-section-number">14.23</span> Q23:ホワイトノイズ</h3>
<div class="cell" data-execution_count="77">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1"></a>img <span class="op">=</span> np.random.rand(<span class="dv">400</span>, <span class="dv">600</span>, <span class="dv">3</span>) <span class="op">*</span> <span class="dv">255</span></span>
<span id="cb120-2"><a href="#cb120-2"></a><span class="bu">print</span>(img[<span class="dv">0</span>])</span>
<span id="cb120-3"><a href="#cb120-3"></a>img <span class="op">=</span> img.astype(np.uint8)</span>
<span id="cb120-4"><a href="#cb120-4"></a><span class="bu">print</span>(img[<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[237.60024439 180.59405009 120.8702287 ]
 [162.67990876 175.14638539 171.29191215]
 [ 95.22278728 124.35894627 206.65675962]
 ...
 [220.32574568 190.07987688  52.46673445]
 [222.74616695 110.07846665 166.04163626]
 [176.47022485  98.69550035 199.21641395]]
[[237 180 120]
 [162 175 171]
 [ 95 124 206]
 ...
 [220 190  52]
 [222 110 166]
 [176  98 199]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="78">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="78">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e5bee910&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-81-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q24３階テンソルのconcatenate" class="level3" data-number="14.24">
<h3 data-number="14.24" class="anchored" data-anchor-id="q24３階テンソルのconcatenate"><span class="header-section-number">14.24</span> Q24:３階テンソルのconcatenate</h3>
<div class="cell" data-execution_count="79">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1"></a>x <span class="op">=</span> np.concatenate(</span>
<span id="cb124-2"><a href="#cb124-2"></a>    [</span>
<span id="cb124-3"><a href="#cb124-3"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>),</span>
<span id="cb124-4"><a href="#cb124-4"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>)</span>
<span id="cb124-5"><a href="#cb124-5"></a>    ]</span>
<span id="cb124-6"><a href="#cb124-6"></a>    ,axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb124-7"><a href="#cb124-7"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>(256, 128, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="80">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1"></a>x <span class="op">=</span> np.concatenate(</span>
<span id="cb126-2"><a href="#cb126-2"></a>    [</span>
<span id="cb126-3"><a href="#cb126-3"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>),</span>
<span id="cb126-4"><a href="#cb126-4"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>)</span>
<span id="cb126-5"><a href="#cb126-5"></a>    ]</span>
<span id="cb126-6"><a href="#cb126-6"></a>    ,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb126-7"><a href="#cb126-7"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="80">
<pre><code>(128, 256, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="81">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1"></a>x <span class="op">=</span> np.concatenate(</span>
<span id="cb128-2"><a href="#cb128-2"></a>    [</span>
<span id="cb128-3"><a href="#cb128-3"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>),</span>
<span id="cb128-4"><a href="#cb128-4"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>)</span>
<span id="cb128-5"><a href="#cb128-5"></a>    ]</span>
<span id="cb128-6"><a href="#cb128-6"></a>    ,axis<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb128-7"><a href="#cb128-7"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="81">
<pre><code>(128, 128, 6)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="82">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1"></a>x <span class="op">=</span> np.concatenate(</span>
<span id="cb130-2"><a href="#cb130-2"></a>    [</span>
<span id="cb130-3"><a href="#cb130-3"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>),</span>
<span id="cb130-4"><a href="#cb130-4"></a>        np.random.rand(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">10</span>)</span>
<span id="cb130-5"><a href="#cb130-5"></a>    ]</span>
<span id="cb130-6"><a href="#cb130-6"></a>    ,axis<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb130-7"><a href="#cb130-7"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="82">
<pre><code>(128, 128, 13)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="83">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1"></a>x <span class="op">=</span> np.concatenate(</span>
<span id="cb132-2"><a href="#cb132-2"></a>    [</span>
<span id="cb132-3"><a href="#cb132-3"></a>        np.random.rand(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">128</span>),</span>
<span id="cb132-4"><a href="#cb132-4"></a>        np.random.rand(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">256</span>), </span>
<span id="cb132-5"><a href="#cb132-5"></a>        np.random.rand(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">128</span>)</span>
<span id="cb132-6"><a href="#cb132-6"></a>    ]</span>
<span id="cb132-7"><a href="#cb132-7"></a>    ,axis<span class="op">=-</span><span class="dv">1</span>)</span>
<span id="cb132-8"><a href="#cb132-8"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="83">
<pre><code>(6, 8, 512)</code></pre>
</div>
</div>
</section>
<section id="q25３階テンソルのstack" class="level3" data-number="14.25">
<h3 data-number="14.25" class="anchored" data-anchor-id="q25３階テンソルのstack"><span class="header-section-number">14.25</span> Q25:３階テンソルのstack</h3>
<div class="cell" data-execution_count="84">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1"></a>x <span class="op">=</span> np.stack(</span>
<span id="cb134-2"><a href="#cb134-2"></a>    [</span>
<span id="cb134-3"><a href="#cb134-3"></a>        np.random.rand(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">128</span>),</span>
<span id="cb134-4"><a href="#cb134-4"></a>        np.random.rand(<span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">128</span>)</span>
<span id="cb134-5"><a href="#cb134-5"></a>    ]</span>
<span id="cb134-6"><a href="#cb134-6"></a>    ,axis<span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb134-7"><a href="#cb134-7"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>(2, 6, 8, 128)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="85">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1"></a>x <span class="op">=</span> np.stack(</span>
<span id="cb136-2"><a href="#cb136-2"></a>    [</span>
<span id="cb136-3"><a href="#cb136-3"></a>        np.random.randn(<span class="dv">128</span>, <span class="dv">128</span>, <span class="dv">3</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>)</span>
<span id="cb136-4"><a href="#cb136-4"></a>    ], </span>
<span id="cb136-5"><a href="#cb136-5"></a>    axis <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb136-6"><a href="#cb136-6"></a>x.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>(128, 128, 3, 5)</code></pre>
</div>
</div>
</section>
<section id="q26縦方向の画像の結合" class="level3" data-number="14.26">
<h3 data-number="14.26" class="anchored" data-anchor-id="q26縦方向の画像の結合"><span class="header-section-number">14.26</span> Q26:縦方向の画像の結合</h3>
<div class="cell" data-execution_count="86">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1"></a>file_path <span class="op">=</span> <span class="st">"./numpy_book/imgs/flower01.jpg"</span></span>
<span id="cb138-2"><a href="#cb138-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(file_path) <span class="im">as</span> img:</span>
<span id="cb138-3"><a href="#cb138-3"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb138-4"><a href="#cb138-4"></a></span>
<span id="cb138-5"><a href="#cb138-5"></a>y <span class="op">=</span> np.concatenate([x] <span class="op">*</span> <span class="dv">2</span>, axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb138-6"><a href="#cb138-6"></a>plt.imshow(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e7174a60&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-89-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="87">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1"></a>plt.imshow(np.tile(x, (<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e70605b0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-90-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q27横方向の画像の結合" class="level3" data-number="14.27">
<h3 data-number="14.27" class="anchored" data-anchor-id="q27横方向の画像の結合"><span class="header-section-number">14.27</span> Q27：横方向の画像の結合</h3>
<div class="cell" data-execution_count="88">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1"></a>y <span class="op">=</span> np.concatenate([x] <span class="op">*</span> <span class="dv">2</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb142-2"><a href="#cb142-2"></a>plt.imshow(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251808e4640&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-91-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q28日の丸" class="level3" data-number="14.28">
<h3 data-number="14.28" class="anchored" data-anchor-id="q28日の丸"><span class="header-section-number">14.28</span> Q28:日の丸</h3>
<div class="cell" data-execution_count="89">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1"></a>W <span class="op">=</span> <span class="dv">1500</span></span>
<span id="cb144-2"><a href="#cb144-2"></a>H <span class="op">=</span> W <span class="op">*</span> <span class="dv">2</span> <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-3"><a href="#cb144-3"></a>D <span class="op">=</span> H <span class="op">*</span> <span class="dv">3</span> <span class="op">//</span> <span class="dv">5</span></span>
<span id="cb144-4"><a href="#cb144-4"></a>img   <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb144-5"><a href="#cb144-5"></a>white <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>])</span>
<span id="cb144-6"><a href="#cb144-6"></a>red   <span class="op">=</span> np.array([<span class="dv">194</span>, <span class="dv">31</span>, <span class="dv">1</span>])</span>
<span id="cb144-7"><a href="#cb144-7"></a></span>
<span id="cb144-8"><a href="#cb144-8"></a>oy, ox <span class="op">=</span> H <span class="op">//</span> <span class="dv">2</span>, W <span class="op">//</span><span class="dv">2</span></span>
<span id="cb144-9"><a href="#cb144-9"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb144-10"><a href="#cb144-10"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> oy, idx <span class="op">-</span> ox</span>
<span id="cb144-11"><a href="#cb144-11"></a></span>
<span id="cb144-12"><a href="#cb144-12"></a>r    <span class="op">=</span> np.sqrt(idy <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idx <span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb144-13"><a href="#cb144-13"></a>mask <span class="op">=</span> r <span class="op">&lt;=</span> D <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="90">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1"></a>img[mask, :] <span class="op">=</span> red[<span class="va">None</span>, <span class="va">None</span>, :]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="91">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180f0d580&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-94-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q29z旗" class="level3" data-number="14.29">
<h3 data-number="14.29" class="anchored" data-anchor-id="q29z旗"><span class="header-section-number">14.29</span> Q29：Z旗</h3>
<div class="cell" data-execution_count="92">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1"></a>W <span class="op">=</span> <span class="dv">1500</span></span>
<span id="cb148-2"><a href="#cb148-2"></a>H <span class="op">=</span> W <span class="op">*</span> <span class="dv">2</span> <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb148-3"><a href="#cb148-3"></a>slope <span class="op">=</span> H <span class="op">/</span> W</span>
<span id="cb148-4"><a href="#cb148-4"></a>img   <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb148-5"><a href="#cb148-5"></a>white  <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>])</span>
<span id="cb148-6"><a href="#cb148-6"></a>yellow <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">0</span>])</span>
<span id="cb148-7"><a href="#cb148-7"></a>blue   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>])</span>
<span id="cb148-8"><a href="#cb148-8"></a>red    <span class="op">=</span> np.array([<span class="dv">194</span>, <span class="dv">31</span>, <span class="dv">1</span>])</span>
<span id="cb148-9"><a href="#cb148-9"></a>black  <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>])</span>
<span id="cb148-10"><a href="#cb148-10"></a></span>
<span id="cb148-11"><a href="#cb148-11"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb148-12"><a href="#cb148-12"></a></span>
<span id="cb148-13"><a href="#cb148-13"></a>mask1 <span class="op">=</span> idy <span class="op">-</span> (slope <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb148-14"><a href="#cb148-14"></a>mask2 <span class="op">=</span> idy <span class="op">-</span> (H <span class="op">-</span> slope <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb148-15"><a href="#cb148-15"></a></span>
<span id="cb148-16"><a href="#cb148-16"></a>img[np.logical_and(mask1, mask2), :] <span class="op">=</span> yellow[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb148-17"><a href="#cb148-17"></a>img[np.logical_and(mask1, np.logical_not(mask2)), :] <span class="op">=</span> blue[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb148-18"><a href="#cb148-18"></a>img[np.logical_and(np.logical_not(mask1), mask2), :] <span class="op">=</span> black[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb148-19"><a href="#cb148-19"></a>img[np.logical_and(np.logical_not(mask1), np.logical_not(mask2)), :] <span class="op">=</span> red[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb148-20"><a href="#cb148-20"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="92">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180f6ed90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-95-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q30セーシャルの国旗" class="level3" data-number="14.30">
<h3 data-number="14.30" class="anchored" data-anchor-id="q30セーシャルの国旗"><span class="header-section-number">14.30</span> Q30：セーシャルの国旗</h3>
<div class="cell" data-execution_count="93">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1"></a>blue   <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">47</span>, <span class="dv">108</span>])</span>
<span id="cb150-2"><a href="#cb150-2"></a>yellow <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">209</span>, <span class="dv">65</span>])</span>
<span id="cb150-3"><a href="#cb150-3"></a>red    <span class="op">=</span> np.array([<span class="dv">210</span>, <span class="dv">39</span>, <span class="dv">48</span>])</span>
<span id="cb150-4"><a href="#cb150-4"></a>white  <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>])</span>
<span id="cb150-5"><a href="#cb150-5"></a>green  <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">122</span>, <span class="dv">51</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="94">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb151-1"><a href="#cb151-1"></a>W <span class="op">=</span> <span class="dv">1200</span></span>
<span id="cb151-2"><a href="#cb151-2"></a>H <span class="op">=</span> W <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb151-3"><a href="#cb151-3"></a>img   <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), blue, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb151-4"><a href="#cb151-4"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb151-5"><a href="#cb151-5"></a></span>
<span id="cb151-6"><a href="#cb151-6"></a></span>
<span id="cb151-7"><a href="#cb151-7"></a>mask1 <span class="op">=</span> idy <span class="op">-</span> (<span class="dv">3</span> <span class="op">*</span> H <span class="op">/</span> W <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb151-8"><a href="#cb151-8"></a>img[mask1, :] <span class="op">=</span> yellow[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb151-9"><a href="#cb151-9"></a>mask2 <span class="op">=</span> idy <span class="op">-</span> (<span class="dv">3</span> <span class="op">*</span> H <span class="op">/</span> W <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb151-10"><a href="#cb151-10"></a>img[mask2, :] <span class="op">=</span> red[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb151-11"><a href="#cb151-11"></a>mask3 <span class="op">=</span> idy <span class="op">-</span> (<span class="dv">2</span> <span class="op">*</span> H <span class="op">/</span> W <span class="op">/</span> <span class="dv">3</span> <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb151-12"><a href="#cb151-12"></a>img[mask3, :] <span class="op">=</span> white[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb151-13"><a href="#cb151-13"></a>mask4 <span class="op">=</span> idy <span class="op">-</span> (H <span class="op">/</span> W <span class="op">/</span> <span class="dv">3</span> <span class="op">*</span> idx) <span class="op">&lt;=</span> <span class="dv">0</span></span>
<span id="cb151-14"><a href="#cb151-14"></a>img[mask4, :] <span class="op">=</span> green[<span class="va">None</span>, <span class="va">None</span>, :]</span>
<span id="cb151-15"><a href="#cb151-15"></a></span>
<span id="cb151-16"><a href="#cb151-16"></a>plt.imshow(img[::<span class="op">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>&lt;matplotlib.image.AxesImage at 0x2518093f430&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-97-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q31画像の合成" class="level3" data-number="14.31">
<h3 data-number="14.31" class="anchored" data-anchor-id="q31画像の合成"><span class="header-section-number">14.31</span> Q31:画像の合成</h3>
<div class="cell" data-execution_count="95">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1"></a><span class="bu">file</span> <span class="op">=</span> <span class="st">"numpy_book/imgs/flower01.jpg"</span></span>
<span id="cb153-2"><a href="#cb153-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="bu">file</span>) <span class="im">as</span> img:</span>
<span id="cb153-3"><a href="#cb153-3"></a>    back <span class="op">=</span> np.array(img)</span>
<span id="cb153-4"><a href="#cb153-4"></a></span>
<span id="cb153-5"><a href="#cb153-5"></a>H, W, _ <span class="op">=</span> back.shape</span>
<span id="cb153-6"><a href="#cb153-6"></a></span>
<span id="cb153-7"><a href="#cb153-7"></a>plt.imshow(back)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180ba9520&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-98-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="96">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1"></a>gradation <span class="op">=</span> np.full_like(back, <span class="dv">255</span>)</span>
<span id="cb155-2"><a href="#cb155-2"></a>gradation[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">255</span>, <span class="dv">128</span>, W)[<span class="va">None</span>, :]</span>
<span id="cb155-3"><a href="#cb155-3"></a>gradation[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb155-4"><a href="#cb155-4"></a>gradation[..., <span class="dv">2</span>] <span class="op">=</span> np.linspace(<span class="dv">128</span>, <span class="dv">255</span>, W)[<span class="va">None</span>, :]</span>
<span id="cb155-5"><a href="#cb155-5"></a>plt.imshow(gradation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251e70a3eb0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-99-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="97">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb157-2"><a href="#cb157-2"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> H <span class="op">//</span> <span class="dv">2</span>, idx <span class="op">-</span> W <span class="op">//</span><span class="dv">2</span></span>
<span id="cb157-3"><a href="#cb157-3"></a>r <span class="op">=</span> np.sqrt(idy <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idx <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb157-4"><a href="#cb157-4"></a>mask <span class="op">=</span> r <span class="op">&lt;=</span> H <span class="op">//</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="98">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1"></a>mask</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="98">
<pre><code>array([[False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       ...,
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False],
       [False, False, False, ..., False, False, False]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="99">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1"></a>img <span class="op">=</span> back.copy()</span>
<span id="cb160-2"><a href="#cb160-2"></a></span>
<span id="cb160-3"><a href="#cb160-3"></a><span class="co"># 3次元でもこれで大丈夫</span></span>
<span id="cb160-4"><a href="#cb160-4"></a>img[mask, :] <span class="op">=</span> gradation[mask, :]</span>
<span id="cb160-5"><a href="#cb160-5"></a></span>
<span id="cb160-6"><a href="#cb160-6"></a>plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="99">
<pre><code>&lt;matplotlib.image.AxesImage at 0x2518090a970&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-102-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q32rgba画像" class="level3" data-number="14.32">
<h3 data-number="14.32" class="anchored" data-anchor-id="q32rgba画像"><span class="header-section-number">14.32</span> Q32:RGBA画像</h3>
<p>Aはα値の意味一般に不透明度を扱う　パラメータである.</p>
<div class="cell" data-execution_count="100">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1"></a>H, W <span class="op">=</span> <span class="dv">600</span>, <span class="dv">900</span></span>
<span id="cb162-2"><a href="#cb162-2"></a>gradation <span class="op">=</span> np.full((H, W, <span class="dv">4</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb162-3"><a href="#cb162-3"></a>gradation[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">255</span>, <span class="dv">128</span>, W)[<span class="va">None</span>, :]</span>
<span id="cb162-4"><a href="#cb162-4"></a>gradation[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb162-5"><a href="#cb162-5"></a>gradation[..., <span class="dv">2</span>] <span class="op">=</span> np.linspace(<span class="dv">128</span>, <span class="dv">255</span>, W)[<span class="va">None</span>, :]</span>
<span id="cb162-6"><a href="#cb162-6"></a>plt.imshow(gradation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180e0c610&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-103-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="101">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb164-2"><a href="#cb164-2"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> H <span class="op">//</span> <span class="dv">2</span>, idx <span class="op">-</span> W <span class="op">//</span><span class="dv">2</span></span>
<span id="cb164-3"><a href="#cb164-3"></a>r <span class="op">=</span> np.sqrt(idy <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idx <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb164-4"><a href="#cb164-4"></a>mask <span class="op">=</span> r <span class="op">&lt;=</span> H <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb164-5"><a href="#cb164-5"></a>plt.imshow(mask)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="101">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180e66b50&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-104-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="102">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1"></a>gradation[mask, <span class="dv">3</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb166-2"><a href="#cb166-2"></a>gradation[np.logical_not(mask), <span class="dv">3</span>] <span class="op">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="103">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1"></a>plt.imshow(gradation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="103">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180ecbf70&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-106-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="104">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1"></a><span class="cf">with</span> Image.fromarray(gradation) <span class="im">as</span> img:</span>
<span id="cb169-2"><a href="#cb169-2"></a>    img.save(<span class="st">"out/gradation.png"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="q33rgba画像２" class="level3" data-number="14.33">
<h3 data-number="14.33" class="anchored" data-anchor-id="q33rgba画像２"><span class="header-section-number">14.33</span> Q33:RGBA画像２</h3>
<div class="cell" data-execution_count="105">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1"></a>gradation[np.logical_not(mask), <span class="dv">3</span>] <span class="op">=</span> <span class="dv">96</span></span>
<span id="cb170-2"><a href="#cb170-2"></a><span class="cf">with</span> Image.fromarray(gradation) <span class="im">as</span> img:</span>
<span id="cb170-3"><a href="#cb170-3"></a>    img.save(<span class="st">"out/gradation2.png"</span>)</span>
<span id="cb170-4"><a href="#cb170-4"></a>    plt.imshow(img)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-108-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q34透画像の合成" class="level3" data-number="14.34">
<h3 data-number="14.34" class="anchored" data-anchor-id="q34透画像の合成"><span class="header-section-number">14.34</span> Q34：透画像の合成</h3>
<div class="cell" data-execution_count="106">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/heart01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb171-2"><a href="#cb171-2"></a>    heart <span class="op">=</span> np.array(img)</span>
<span id="cb171-3"><a href="#cb171-3"></a></span>
<span id="cb171-4"><a href="#cb171-4"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb171-5"><a href="#cb171-5"></a>    flower <span class="op">=</span> np.array(img)</span>
<span id="cb171-6"><a href="#cb171-6"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="107">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1"></a>heart.shape, flower.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="107">
<pre><code>((960, 1280, 4), (960, 1280, 3))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="108">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1"></a>mask <span class="op">=</span> heart[..., <span class="dv">3</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb174-2"><a href="#cb174-2"></a>flower[mask, :<span class="dv">3</span>] <span class="op">=</span> heart[mask, :<span class="dv">3</span>]</span>
<span id="cb174-3"><a href="#cb174-3"></a>plt.imshow(flower)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251830a1b80&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-111-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q35クロマキー合成" class="level3" data-number="14.35">
<h3 data-number="14.35" class="anchored" data-anchor-id="q35クロマキー合成"><span class="header-section-number">14.35</span> Q35：クロマキー合成</h3>
<div class="cell" data-execution_count="109">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb176-2"><a href="#cb176-2"></a>    flower <span class="op">=</span> np.array(img)</span>
<span id="cb176-3"><a href="#cb176-3"></a></span>
<span id="cb176-4"><a href="#cb176-4"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/girl01_bb.png"</span>) <span class="im">as</span> img:</span>
<span id="cb176-5"><a href="#cb176-5"></a>    bb <span class="op">=</span> np.array(img)</span>
<span id="cb176-6"><a href="#cb176-6"></a>    plt.imshow(bb)</span>
<span id="cb176-7"><a href="#cb176-7"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-112-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="110">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1"></a>bb.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="110">
<pre><code>(697, 636, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="111">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1"></a><span class="co"># 青色の判定</span></span>
<span id="cb179-2"><a href="#cb179-2"></a>blue <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">255</span>])</span>
<span id="cb179-3"><a href="#cb179-3"></a>mask <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((bb <span class="op">-</span> blue[<span class="va">None</span>, <span class="va">None</span>, :]) <span class="op">**</span> <span class="dv">2</span>, axis <span class="op">=</span> <span class="dv">2</span>)) <span class="op">&lt;=</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="112">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1"></a>H_bb, W_bb, _ <span class="op">=</span> bb.shape</span>
<span id="cb180-2"><a href="#cb180-2"></a>H_bb2, W_bb2  <span class="op">=</span> H_bb <span class="op">//</span> <span class="dv">2</span>, W_bb <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb180-3"><a href="#cb180-3"></a>H_f, W_f, _ <span class="op">=</span> flower.shape</span>
<span id="cb180-4"><a href="#cb180-4"></a>H_f2, W_f2 <span class="op">=</span> H_f <span class="op">//</span> <span class="dv">2</span>, W_f <span class="op">//</span><span class="dv">2</span></span>
<span id="cb180-5"><a href="#cb180-5"></a>flower_sub <span class="op">=</span> flower[(H_f2 <span class="op">-</span> H_bb2):(H_f2 <span class="op">-</span> H_bb2) <span class="op">+</span> H_bb, (W_f2 <span class="op">-</span> W_bb2):(W_f2 <span class="op">-</span> W_bb2) <span class="op">+</span> W_bb, :]</span>
<span id="cb180-6"><a href="#cb180-6"></a>flower_sub.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="112">
<pre><code>(697, 636, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="113">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1"></a>plt.imshow(flower_sub)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="113">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25183ee49d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-116-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="114">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1"></a>bb[mask, :] <span class="op">=</span> flower_sub[mask, :]</span>
<span id="cb184-2"><a href="#cb184-2"></a>plt.imshow(bb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="114">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25185bf33d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-117-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q36アルファブレンド" class="level3" data-number="14.36">
<h3 data-number="14.36" class="anchored" data-anchor-id="q36アルファブレンド"><span class="header-section-number">14.36</span> Q36：アルファブレンド</h3>
<div class="cell" data-execution_count="115">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb186-2"><a href="#cb186-2"></a>    flower <span class="op">=</span> np.array(img.convert(<span class="st">"RGBA"</span>)) <span class="op">/</span> <span class="dv">255</span> <span class="op">*</span> <span class="fl">.7</span></span>
<span id="cb186-3"><a href="#cb186-3"></a></span>
<span id="cb186-4"><a href="#cb186-4"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/heart01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb186-5"><a href="#cb186-5"></a>    heart <span class="op">=</span> np.array(img) <span class="op">/</span> <span class="dv">255</span> <span class="op">*</span> <span class="fl">.3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="116">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1"></a>flower.shape, heart.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="116">
<pre><code>((960, 1280, 4), (960, 1280, 4))</code></pre>
</div>
</div>
<div class="cell" data-execution_count="117">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1"></a>img_out <span class="op">=</span> np.empty_like(flower)</span>
<span id="cb189-2"><a href="#cb189-2"></a>img_out[...,  <span class="dv">3</span>] <span class="op">=</span> flower[..., <span class="dv">3</span>] <span class="op">+</span> heart[..., <span class="dv">3</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> flower[..., <span class="dv">3</span>])</span>
<span id="cb189-3"><a href="#cb189-3"></a>img_out[..., :<span class="dv">3</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb189-4"><a href="#cb189-4"></a>    (flower[..., :<span class="dv">3</span>] <span class="op">*</span> flower[..., <span class="dv">3</span>][:,:,<span class="va">None</span>] <span class="op">+</span> heart[..., :<span class="dv">3</span>] <span class="op">*</span> heart[..., <span class="dv">3</span>][:,:,<span class="va">None</span>] <span class="op">*</span>  (<span class="dv">1</span> <span class="op">-</span> flower[..., <span class="dv">3</span>])[:,:,<span class="va">None</span>]) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb189-5"><a href="#cb189-5"></a>    img_out[..., <span class="dv">3</span>][:,:,<span class="va">None</span>]</span>
<span id="cb189-6"><a href="#cb189-6"></a>img_out <span class="op">=</span> (<span class="dv">255</span> <span class="op">*</span> img_out).astype(np.uint8)</span>
<span id="cb189-7"><a href="#cb189-7"></a>img_out[img_out[:,:,<span class="dv">3</span>] <span class="op">==</span> <span class="dv">0</span>, :<span class="dv">3</span>] <span class="op">=</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="118">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1"></a>img_out[..., <span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="118">
<pre><code>array([[178, 178, 178, ..., 178, 178, 178],
       [178, 178, 178, ..., 178, 178, 178],
       [178, 178, 178, ..., 178, 178, 178],
       ...,
       [178, 178, 178, ..., 178, 178, 178],
       [178, 178, 178, ..., 178, 178, 178],
       [178, 178, 178, ..., 178, 178, 178]], dtype=uint8)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="119">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1"></a>plt.imshow(img_out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25185c4f430&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-122-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="120">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1"></a><span class="kw">def</span> alpha_blend(sa, img_s, img_d):</span>
<span id="cb194-2"><a href="#cb194-2"></a>    da <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> sa</span>
<span id="cb194-3"><a href="#cb194-3"></a>    img_s <span class="op">=</span> img_s.copy() <span class="op">*</span> sa</span>
<span id="cb194-4"><a href="#cb194-4"></a>    img_d <span class="op">=</span> img_d.copy() <span class="op">*</span> da</span>
<span id="cb194-5"><a href="#cb194-5"></a>    img_out <span class="op">=</span> np.empty_like(img_s)</span>
<span id="cb194-6"><a href="#cb194-6"></a>    img_out[...,  <span class="dv">3</span>] <span class="op">=</span> img_s[..., <span class="dv">3</span>] <span class="op">+</span> img_d[..., <span class="dv">3</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> img_s[..., <span class="dv">3</span>])</span>
<span id="cb194-7"><a href="#cb194-7"></a>    img_out[..., :<span class="dv">3</span>] <span class="op">=</span> <span class="op">\</span></span>
<span id="cb194-8"><a href="#cb194-8"></a>        (img_s[..., :<span class="dv">3</span>] <span class="op">*</span> img_s[..., <span class="dv">3</span>][:,:,<span class="va">None</span>] <span class="op">+</span> img_d[..., :<span class="dv">3</span>] <span class="op">*</span> img_d[..., <span class="dv">3</span>][:,:,<span class="va">None</span>] <span class="op">*</span>  (<span class="dv">1</span> <span class="op">-</span> img_s[..., <span class="dv">3</span>])[:,:,<span class="va">None</span>]) <span class="op">/</span> <span class="op">\</span></span>
<span id="cb194-9"><a href="#cb194-9"></a>        img_out[..., <span class="dv">3</span>][:,:,<span class="va">None</span>]</span>
<span id="cb194-10"><a href="#cb194-10"></a>    img_out <span class="op">=</span> (<span class="dv">255</span> <span class="op">*</span> img_out).astype(np.uint8)</span>
<span id="cb194-11"><a href="#cb194-11"></a>    img_out[img_out[:,:,<span class="dv">3</span>] <span class="op">==</span> <span class="dv">0</span>, :<span class="dv">3</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb194-12"><a href="#cb194-12"></a>    <span class="cf">return</span> img_out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="121">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb195-2"><a href="#cb195-2"></a>    flower <span class="op">=</span> np.array(img.convert(<span class="st">"RGBA"</span>)) <span class="op">/</span> <span class="dv">255</span> </span>
<span id="cb195-3"><a href="#cb195-3"></a></span>
<span id="cb195-4"><a href="#cb195-4"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/heart01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb195-5"><a href="#cb195-5"></a>    heart <span class="op">=</span> np.array(img) <span class="op">/</span> <span class="dv">255</span> </span>
<span id="cb195-6"><a href="#cb195-6"></a></span>
<span id="cb195-7"><a href="#cb195-7"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>,<span class="dv">24</span>))</span>
<span id="cb195-8"><a href="#cb195-8"></a>alphas <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">10</span>) <span class="op">/</span> <span class="dv">10</span></span>
<span id="cb195-9"><a href="#cb195-9"></a></span>
<span id="cb195-10"><a href="#cb195-10"></a><span class="cf">for</span> i, alpha <span class="kw">in</span> <span class="bu">enumerate</span>(alphas, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb195-11"><a href="#cb195-11"></a>    img <span class="op">=</span> alpha_blend(alpha, flower, heart)</span>
<span id="cb195-12"><a href="#cb195-12"></a>    ax  <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">3</span>, i)</span>
<span id="cb195-13"><a href="#cb195-13"></a>    ax.imshow(img)</span>
<span id="cb195-14"><a href="#cb195-14"></a></span>
<span id="cb195-15"><a href="#cb195-15"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-124-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q38hsv色空間" class="level3" data-number="14.37">
<h3 data-number="14.37" class="anchored" data-anchor-id="q38hsv色空間"><span class="header-section-number">14.37</span> Q38：HSV色空間</h3>
<p>RGBとHSVは相互に変換できるらしい． スクラッチでの実装も可能であるが，Pillowを使うとのこと.</p>
<p>H：色相，S：彩度，Value：明度</p>
<div class="cell" data-execution_count="122">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb196-2"><a href="#cb196-2"></a>    img_hsv <span class="op">=</span> img.convert(<span class="st">"HSV"</span>)</span>
<span id="cb196-3"><a href="#cb196-3"></a>    flower <span class="op">=</span> np.array(img_hsv)</span>
<span id="cb196-4"><a href="#cb196-4"></a></span>
<span id="cb196-5"><a href="#cb196-5"></a>plt.imshow(flower) <span class="co"># HSVの値としてプロットしている</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="122">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25185d58520&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-125-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="123">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1"></a>plt.imshow(Image.fromarray(flower, <span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25185dab9d0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-126-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="124">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">24</span>, <span class="dv">24</span>))</span>
<span id="cb200-2"><a href="#cb200-2"></a></span>
<span id="cb200-3"><a href="#cb200-3"></a>hs <span class="op">=</span> [<span class="dv">10</span>, <span class="dv">25</span>, <span class="dv">50</span>, <span class="dv">100</span>]</span>
<span id="cb200-4"><a href="#cb200-4"></a><span class="cf">for</span> i, h <span class="kw">in</span> <span class="bu">enumerate</span>(hs, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb200-5"><a href="#cb200-5"></a>    img <span class="op">=</span> flower.copy()</span>
<span id="cb200-6"><a href="#cb200-6"></a>    img[..., <span class="dv">0</span>] <span class="op">=</span> img[..., <span class="dv">0</span>] <span class="op">+</span> h</span>
<span id="cb200-7"><a href="#cb200-7"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb200-8"><a href="#cb200-8"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span>
<span id="cb200-9"><a href="#cb200-9"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-127-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="125">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1"></a>flower[..., <span class="dv">0</span>] <span class="op">+</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="125">
<pre><code>array([[240, 243, 243, ..., 250, 248, 248],
       [241, 243, 243, ..., 248, 248, 248],
       [243, 243, 245, ..., 247, 246, 246],
       ...,
       [104, 104, 105, ..., 120, 120, 120],
       [104, 104, 105, ..., 120, 120, 120],
       [104, 104, 105, ..., 120, 120, 120]], dtype=uint8)</code></pre>
</div>
</div>
</section>
<section id="q39hsv色空間" class="level3" data-number="14.38">
<h3 data-number="14.38" class="anchored" data-anchor-id="q39hsv色空間"><span class="header-section-number">14.38</span> Q39:HSV色空間</h3>
<div class="cell" data-execution_count="126">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb203-2"><a href="#cb203-2"></a>    img_hsv <span class="op">=</span> img.convert(<span class="st">"HSV"</span>)</span>
<span id="cb203-3"><a href="#cb203-3"></a>    flower <span class="op">=</span> np.array(img_hsv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="127">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">18</span>))</span>
<span id="cb204-2"><a href="#cb204-2"></a></span>
<span id="cb204-3"><a href="#cb204-3"></a>hs <span class="op">=</span> [<span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">100</span>]</span>
<span id="cb204-4"><a href="#cb204-4"></a><span class="cf">for</span> i, h <span class="kw">in</span> <span class="bu">enumerate</span>(hs, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb204-5"><a href="#cb204-5"></a>    img <span class="op">=</span> flower.copy()</span>
<span id="cb204-6"><a href="#cb204-6"></a>    img[..., <span class="dv">1</span>] <span class="op">=</span> np.clip(img[..., <span class="dv">1</span>].astype(<span class="bu">int</span>) <span class="op">+</span> h, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb204-7"><a href="#cb204-7"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb204-8"><a href="#cb204-8"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-130-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="128">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">18</span>))</span>
<span id="cb205-2"><a href="#cb205-2"></a>hs <span class="op">=</span> [<span class="op">-</span><span class="dv">100</span>, <span class="op">-</span><span class="dv">50</span>, <span class="dv">0</span>, <span class="dv">100</span>]</span>
<span id="cb205-3"><a href="#cb205-3"></a><span class="cf">for</span> i, h <span class="kw">in</span> <span class="bu">enumerate</span>(hs, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb205-4"><a href="#cb205-4"></a>    img <span class="op">=</span> flower.copy()</span>
<span id="cb205-5"><a href="#cb205-5"></a>    img[..., <span class="dv">2</span>] <span class="op">=</span> np.clip(img[..., <span class="dv">2</span>].astype(<span class="bu">int</span>) <span class="op">+</span> h, <span class="dv">0</span>, <span class="dv">255</span>)</span>
<span id="cb205-6"><a href="#cb205-6"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb205-7"><a href="#cb205-7"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span>
<span id="cb205-8"><a href="#cb205-8"></a></span>
<span id="cb205-9"><a href="#cb205-9"></a></span>
<span id="cb205-10"><a href="#cb205-10"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-131-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q41色相環" class="level3" data-number="14.39">
<h3 data-number="14.39" class="anchored" data-anchor-id="q41色相環"><span class="header-section-number">14.39</span> Q41:色相環</h3>
<div class="cell" data-execution_count="129">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1"></a>img <span class="op">=</span> np.full((<span class="dv">512</span>, <span class="dv">512</span>, <span class="dv">3</span>), <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb206-2"><a href="#cb206-2"></a>oy, ox <span class="op">=</span> <span class="dv">512</span> <span class="op">//</span> <span class="dv">2</span>, <span class="dv">512</span> <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb206-3"><a href="#cb206-3"></a>idy, idx <span class="op">=</span> np.indices((<span class="dv">512</span>, <span class="dv">512</span>))</span>
<span id="cb206-4"><a href="#cb206-4"></a>idy, idx <span class="op">=</span> idy <span class="op">-</span> oy, idx <span class="op">-</span> ox</span>
<span id="cb206-5"><a href="#cb206-5"></a></span>
<span id="cb206-6"><a href="#cb206-6"></a>H <span class="op">=</span> (np.arctan2(idy, idx) <span class="op">+</span> np.pi) <span class="op">/</span> np.pi <span class="op">/</span> <span class="dv">2</span> <span class="op">*</span> <span class="dv">255</span></span>
<span id="cb206-7"><a href="#cb206-7"></a>S <span class="op">=</span> np.sqrt(idx <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> idy <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb206-8"><a href="#cb206-8"></a>img[..., <span class="dv">0</span>] <span class="op">=</span> H</span>
<span id="cb206-9"><a href="#cb206-9"></a>img[..., <span class="dv">1</span>] <span class="op">=</span> S</span>
<span id="cb206-10"><a href="#cb206-10"></a></span>
<span id="cb206-11"><a href="#cb206-11"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">18</span>, <span class="dv">18</span>))</span>
<span id="cb206-12"><a href="#cb206-12"></a>Vs <span class="op">=</span> [<span class="dv">255</span>, <span class="dv">192</span>, <span class="dv">128</span>, <span class="dv">64</span>]</span>
<span id="cb206-13"><a href="#cb206-13"></a><span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(Vs, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb206-14"><a href="#cb206-14"></a>    img[..., <span class="dv">2</span>]      <span class="op">=</span> v</span>
<span id="cb206-15"><a href="#cb206-15"></a>    img[S <span class="op">&gt;=</span> <span class="dv">256</span>, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb206-16"><a href="#cb206-16"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb206-17"><a href="#cb206-17"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-132-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q42補色" class="level3" data-number="14.40">
<h3 data-number="14.40" class="anchored" data-anchor-id="q42補色"><span class="header-section-number">14.40</span> Q42:補色</h3>
<p>色相環で円周方向の単体にある色を補色という.</p>
<div class="cell" data-execution_count="130">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb207-2"><a href="#cb207-2"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb207-3"><a href="#cb207-3"></a>img <span class="op">=</span> np.full((<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb207-4"><a href="#cb207-4"></a></span>
<span id="cb207-5"><a href="#cb207-5"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb207-6"><a href="#cb207-6"></a>    h, <span class="op">*</span>_ <span class="op">=</span> (np.random.rand(<span class="dv">1</span>) <span class="op">*</span> <span class="dv">255</span>).astype(np.uint8)</span>
<span id="cb207-7"><a href="#cb207-7"></a>    img[..., <span class="dv">0</span>] <span class="op">=</span> h</span>
<span id="cb207-8"><a href="#cb207-8"></a>    img[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb207-9"><a href="#cb207-9"></a>    img[:, <span class="dv">10</span>:, <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">126</span></span>
<span id="cb207-10"><a href="#cb207-10"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">10</span>, <span class="dv">5</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb207-11"><a href="#cb207-11"></a>    ax.set_axis_off()</span>
<span id="cb207-12"><a href="#cb207-12"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span>
<span id="cb207-13"><a href="#cb207-13"></a></span>
<span id="cb207-14"><a href="#cb207-14"></a></span>
<span id="cb207-15"><a href="#cb207-15"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-133-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="131">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1"></a>np.random.seed(<span class="dv">42</span>)</span>
<span id="cb208-2"><a href="#cb208-2"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">10</span>))</span>
<span id="cb208-3"><a href="#cb208-3"></a>img <span class="op">=</span> np.full((<span class="dv">10</span>, <span class="dv">30</span>, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb208-4"><a href="#cb208-4"></a></span>
<span id="cb208-5"><a href="#cb208-5"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">50</span>):</span>
<span id="cb208-6"><a href="#cb208-6"></a>    h, <span class="op">*</span>_ <span class="op">=</span> (np.random.rand(<span class="dv">1</span>) <span class="op">*</span> <span class="dv">255</span>).astype(np.uint8)</span>
<span id="cb208-7"><a href="#cb208-7"></a>    img[..., <span class="dv">0</span>] <span class="op">=</span> h</span>
<span id="cb208-8"><a href="#cb208-8"></a>    img[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb208-9"><a href="#cb208-9"></a>    img[:,  <span class="dv">0</span>:<span class="dv">10</span>, <span class="dv">0</span>] <span class="op">+=</span> <span class="dv">25</span></span>
<span id="cb208-10"><a href="#cb208-10"></a>    img[:, <span class="dv">20</span>:<span class="dv">30</span>, <span class="dv">0</span>] <span class="op">-=</span> <span class="dv">25</span></span>
<span id="cb208-11"><a href="#cb208-11"></a>    ax <span class="op">=</span> fig.add_subplot(<span class="dv">10</span>, <span class="dv">5</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb208-12"><a href="#cb208-12"></a>    ax.set_axis_off()</span>
<span id="cb208-13"><a href="#cb208-13"></a>    ax.imshow(Image.fromarray(img, <span class="st">"HSV"</span>))</span>
<span id="cb208-14"><a href="#cb208-14"></a></span>
<span id="cb208-15"><a href="#cb208-15"></a></span>
<span id="cb208-16"><a href="#cb208-16"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-134-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q44ゲーミングフラワー" class="level3" data-number="14.41">
<h3 data-number="14.41" class="anchored" data-anchor-id="q44ゲーミングフラワー"><span class="header-section-number">14.41</span> Q44:ゲーミングフラワー</h3>
<div class="cell" data-execution_count="132">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb209-2"><a href="#cb209-2"></a>    flower <span class="op">=</span> np.array(img.convert(<span class="st">"HSV"</span>))</span>
<span id="cb209-3"><a href="#cb209-3"></a></span>
<span id="cb209-4"><a href="#cb209-4"></a>H, W, _ <span class="op">=</span> flower.shape</span>
<span id="cb209-5"><a href="#cb209-5"></a>flower[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">255</span>, W).astype(np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb209-6"><a href="#cb209-6"></a>plt.imshow(Image.fromarray(flower, <span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="132">
<pre><code>&lt;matplotlib.image.AxesImage at 0x251864f5910&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-135-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q45ゲーミングイルカ" class="level3" data-number="14.42">
<h3 data-number="14.42" class="anchored" data-anchor-id="q45ゲーミングイルカ"><span class="header-section-number">14.42</span> Q45:ゲーミングイルカ</h3>
<p>楕円のグラデーションを作成する.</p>
<p>もとがモノクロ画像だと，HSVに変換したときに，彩度がすべて０になるとのこと．</p>
<p>このため，必要な部分の彩度を上げておく必要がある.</p>
<div class="cell" data-execution_count="133">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb211-1"><a href="#cb211-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/dolphin.png"</span>) <span class="im">as</span> img:</span>
<span id="cb211-2"><a href="#cb211-2"></a>    dolphin <span class="op">=</span> np.array(img.convert(<span class="st">"HSV"</span>))</span>
<span id="cb211-3"><a href="#cb211-3"></a></span>
<span id="cb211-4"><a href="#cb211-4"></a>H, W, C  <span class="op">=</span> dolphin.shape</span>
<span id="cb211-5"><a href="#cb211-5"></a>oy, ox   <span class="op">=</span> H <span class="op">//</span> <span class="dv">2</span>, W <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb211-6"><a href="#cb211-6"></a>idy, idx <span class="op">=</span> np.indices((H, W))</span>
<span id="cb211-7"><a href="#cb211-7"></a>h        <span class="op">=</span> np.sqrt(((idy<span class="op">-</span>oy)<span class="op">/</span>oy) <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> ((idx <span class="op">-</span> ox) <span class="op">/</span> ox) <span class="op">**</span> <span class="dv">2</span>) <span class="op">*</span> <span class="dv">255</span></span>
<span id="cb211-8"><a href="#cb211-8"></a></span>
<span id="cb211-9"><a href="#cb211-9"></a>mask <span class="op">=</span> dolphin[..., <span class="dv">2</span>] <span class="op">&lt;=</span> <span class="dv">250</span></span>
<span id="cb211-10"><a href="#cb211-10"></a>dolphin[mask, <span class="dv">0</span>] <span class="op">=</span> h.astype(np.uint8)[mask]</span>
<span id="cb211-11"><a href="#cb211-11"></a>dolphin[mask, <span class="dv">1</span>] <span class="op">=</span> <span class="dv">255</span> <span class="co"># すべて０なところを，イルカの部分だけ彩度を上げる</span></span>
<span id="cb211-12"><a href="#cb211-12"></a>dolphin[mask, <span class="dv">2</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb211-13"><a href="#cb211-13"></a>plt.imshow(Image.fromarray(dolphin, <span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="133">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25186497310&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-136-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q46類似色のグラデーション" class="level3" data-number="14.43">
<h3 data-number="14.43" class="anchored" data-anchor-id="q46類似色のグラデーション"><span class="header-section-number">14.43</span> Q46:類似色のグラデーション</h3>
<div class="cell" data-execution_count="134">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb213-1"><a href="#cb213-1"></a></span>
<span id="cb213-2"><a href="#cb213-2"></a></span>
<span id="cb213-3"><a href="#cb213-3"></a>rgb_colors  <span class="op">=</span> np.array([</span>
<span id="cb213-4"><a href="#cb213-4"></a>    [<span class="dv">128</span>, <span class="dv">255</span>, <span class="dv">255</span>], </span>
<span id="cb213-5"><a href="#cb213-5"></a>    [<span class="dv">255</span>, <span class="dv">128</span>, <span class="dv">255</span>],</span>
<span id="cb213-6"><a href="#cb213-6"></a>    [<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">128</span>]</span>
<span id="cb213-7"><a href="#cb213-7"></a>], dtype <span class="op">=</span> np.uint8)[<span class="va">None</span>, ...]</span>
<span id="cb213-8"><a href="#cb213-8"></a><span class="cf">with</span> Image.fromarray(rgb_colors) <span class="im">as</span> img:</span>
<span id="cb213-9"><a href="#cb213-9"></a>    hsv_colors <span class="op">=</span> np.array(img.convert(<span class="st">"HSV"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="135">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1"></a>hsv_colors.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="135">
<pre><code>(1, 3, 3)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="136">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1"></a>fig <span class="op">=</span> plt.figure()</span>
<span id="cb216-2"><a href="#cb216-2"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb216-3"><a href="#cb216-3"></a>H, W <span class="op">=</span> <span class="dv">50</span>, <span class="dv">200</span></span>
<span id="cb216-4"><a href="#cb216-4"></a><span class="cf">for</span> h <span class="kw">in</span> hsv_colors[<span class="dv">0</span>, :, <span class="dv">0</span>]:</span>
<span id="cb216-5"><a href="#cb216-5"></a>    <span class="cf">for</span> gi <span class="kw">in</span> [<span class="dv">20</span>, <span class="dv">40</span>, <span class="dv">60</span>]:</span>
<span id="cb216-6"><a href="#cb216-6"></a>        canvas <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb216-7"><a href="#cb216-7"></a>        lower <span class="op">=</span> h <span class="op">-</span> gi</span>
<span id="cb216-8"><a href="#cb216-8"></a>        upper <span class="op">=</span> lower <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> gi</span>
<span id="cb216-9"><a href="#cb216-9"></a>        canvas[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(lower, upper, W).astype(np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb216-10"><a href="#cb216-10"></a>        ax <span class="op">=</span> fig.add_subplot(<span class="dv">3</span>, <span class="dv">3</span>, i)</span>
<span id="cb216-11"><a href="#cb216-11"></a>        ax.set_axis_off()</span>
<span id="cb216-12"><a href="#cb216-12"></a>        ax.imshow(Image.fromarray(canvas, <span class="st">"HSV"</span>))</span>
<span id="cb216-13"><a href="#cb216-13"></a>        i <span class="op">+=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-139-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q47rgbとhsvのグラデーション" class="level3" data-number="14.44">
<h3 data-number="14.44" class="anchored" data-anchor-id="q47rgbとhsvのグラデーション"><span class="header-section-number">14.44</span> Q47：RGBとHSVのグラデーション</h3>
<p>線形補間はHSV領域でおこなった方が発色がよいことがある.</p>
<div class="cell" data-execution_count="137">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1"></a>c1 <span class="op">=</span> np.array([<span class="dv">30</span>, <span class="dv">144</span>, <span class="dv">255</span>], dtype <span class="op">=</span> np.uint8)</span>
<span id="cb217-2"><a href="#cb217-2"></a>c2 <span class="op">=</span> np.array([<span class="dv">255</span>, <span class="dv">30</span>, <span class="dv">143</span>], dtype <span class="op">=</span> np.uint8)</span>
<span id="cb217-3"><a href="#cb217-3"></a></span>
<span id="cb217-4"><a href="#cb217-4"></a>H, W <span class="op">=</span> <span class="dv">100</span>, <span class="dv">400</span></span>
<span id="cb217-5"><a href="#cb217-5"></a>canvas <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb217-6"><a href="#cb217-6"></a></span>
<span id="cb217-7"><a href="#cb217-7"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb217-8"><a href="#cb217-8"></a>    canvas[..., i] <span class="op">=</span> np.linspace(c1[i], c2[i], W)[<span class="va">None</span>, :]</span>
<span id="cb217-9"><a href="#cb217-9"></a></span>
<span id="cb217-10"><a href="#cb217-10"></a>plt.imshow(canvas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="137">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25186f4cbb0&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-140-output-2.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="138">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1"></a>rgb <span class="op">=</span> np.stack([c1, c2], axis <span class="op">=</span> <span class="dv">0</span>)[:, <span class="va">None</span>, :]</span>
<span id="cb219-2"><a href="#cb219-2"></a><span class="cf">with</span> Image.fromarray(rgb) <span class="im">as</span> img:</span>
<span id="cb219-3"><a href="#cb219-3"></a>    hsv <span class="op">=</span> np.array(img.convert(<span class="st">"HSV"</span>))</span>
<span id="cb219-4"><a href="#cb219-4"></a></span>
<span id="cb219-5"><a href="#cb219-5"></a>canvas <span class="op">=</span> np.full((H, W, <span class="dv">3</span>), <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8)</span>
<span id="cb219-6"><a href="#cb219-6"></a>canvas[..., <span class="dv">0</span>] <span class="op">=</span> np.linspace(hsv[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>], hsv[<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>], W).astype(np.uint8)[<span class="va">None</span>, :]</span>
<span id="cb219-7"><a href="#cb219-7"></a>plt.imshow(Image.fromarray(canvas, <span class="st">"HSV"</span>))</span>
<span id="cb219-8"><a href="#cb219-8"></a></span>
<span id="cb219-9"><a href="#cb219-9"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="138">
<pre><code>&lt;matplotlib.image.AxesImage at 0x25180e4b160&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-141-output-2.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q48カラー画像のグレースケール化" class="level3" data-number="14.45">
<h3 data-number="14.45" class="anchored" data-anchor-id="q48カラー画像のグレースケール化"><span class="header-section-number">14.45</span> Q48：カラー画像のグレースケール化</h3>
<div class="cell" data-execution_count="139">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb221-2"><a href="#cb221-2"></a>    x <span class="op">=</span> np.array(img.convert(<span class="st">"HSV"</span>))</span>
<span id="cb221-3"><a href="#cb221-3"></a>    x[..., <span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb221-4"><a href="#cb221-4"></a>    plt.imshow(Image.fromarray(x, <span class="st">"HSV"</span>))</span>
<span id="cb221-5"><a href="#cb221-5"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-142-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q49カラー画像のグレースケール化" class="level3" data-number="14.46">
<h3 data-number="14.46" class="anchored" data-anchor-id="q49カラー画像のグレースケール化"><span class="header-section-number">14.46</span> Q49:カラー画像のグレースケール化</h3>
<div class="cell" data-execution_count="140">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb222-2"><a href="#cb222-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb222-3"><a href="#cb222-3"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb222-4"><a href="#cb222-4"></a>    L  <span class="op">=</span> <span class="fl">0.299</span> <span class="op">*</span> x[..., <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.587</span> <span class="op">*</span> x[..., <span class="dv">1</span>] <span class="op">+</span> <span class="fl">.114</span> <span class="op">*</span> x[..., <span class="dv">2</span>]</span>
<span id="cb222-5"><a href="#cb222-5"></a>    Lo <span class="op">=</span> np.array(img.convert(<span class="st">"L"</span>))</span>
<span id="cb222-6"><a href="#cb222-6"></a>    LLo<span class="op">=</span> np.concatenate([L, Lo], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb222-7"><a href="#cb222-7"></a>    plt.imshow(LLo, cmap <span class="op">=</span> <span class="st">"gray"</span>, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-143-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q50単色カラー化" class="level3" data-number="14.47">
<h3 data-number="14.47" class="anchored" data-anchor-id="q50単色カラー化"><span class="header-section-number">14.47</span> Q50:単色カラー化</h3>
<div class="cell" data-execution_count="151">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb223-2"><a href="#cb223-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb223-3"><a href="#cb223-3"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb223-4"><a href="#cb223-4"></a>    H, W, c <span class="op">=</span> x.shape</span>
<span id="cb223-5"><a href="#cb223-5"></a>    c <span class="op">=</span> np.tile(np.full_like(x, <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb223-6"><a href="#cb223-6"></a>    Lv  <span class="op">=</span> <span class="fl">.299</span> <span class="op">*</span> x[..., <span class="dv">0</span>] <span class="op">+</span>  <span class="fl">.587</span> <span class="op">*</span> x[..., <span class="dv">1</span>] <span class="op">+</span> <span class="fl">.114</span> <span class="op">*</span> x[..., <span class="dv">2</span>]</span>
<span id="cb223-7"><a href="#cb223-7"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb223-8"><a href="#cb223-8"></a>        <span class="co"># グレースケールの値を代入すればよい</span></span>
<span id="cb223-9"><a href="#cb223-9"></a>        c[:, (i <span class="op">*</span> W):((i<span class="op">+</span><span class="dv">1</span>) <span class="op">*</span> W), i] <span class="op">=</span> Lv.astype(np.uint8)</span>
<span id="cb223-10"><a href="#cb223-10"></a>    plt.imshow(c, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-144-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q51単色カラー化ダブルトーン" class="level3" data-number="14.48">
<h3 data-number="14.48" class="anchored" data-anchor-id="q51単色カラー化ダブルトーン"><span class="header-section-number">14.48</span> Q51:単色カラー化，ダブルトーン</h3>
<p>上述したやり方，つまり(R, G, B) = (L, 0, 0)ではグレー化が正常に動作しない場合がある。</p>
<p>そこで，輝度をLとしたときの定式化を考える。(R, G, B) = (L, 255, 255)</p>
<p>以下では，グレー化が失敗する例と，それのダブルトーンによるグレー化を示す.</p>
<div class="cell" data-execution_count="161">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1"></a><span class="co"># グレー化失敗例</span></span>
<span id="cb224-2"><a href="#cb224-2"></a></span>
<span id="cb224-3"><a href="#cb224-3"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb224-4"><a href="#cb224-4"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/girl01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb224-5"><a href="#cb224-5"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb224-6"><a href="#cb224-6"></a>    H, W, c <span class="op">=</span> x.shape</span>
<span id="cb224-7"><a href="#cb224-7"></a>    Lv  <span class="op">=</span> <span class="fl">.299</span> <span class="op">*</span> x[..., <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.587</span> <span class="op">*</span> x[..., <span class="dv">1</span>] <span class="op">+</span> <span class="fl">.114</span> <span class="op">*</span> x[..., <span class="dv">2</span>]</span>
<span id="cb224-8"><a href="#cb224-8"></a>    c <span class="op">=</span> np.tile(np.full_like(x, <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb224-9"><a href="#cb224-9"></a>    c[..., <span class="dv">3</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb224-10"><a href="#cb224-10"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb224-11"><a href="#cb224-11"></a>        <span class="co"># グレースケールの値を代入すればよい</span></span>
<span id="cb224-12"><a href="#cb224-12"></a>        o <span class="op">=</span> i <span class="op">*</span> W</span>
<span id="cb224-13"><a href="#cb224-13"></a>        c[:, o:(o <span class="op">+</span> W), i] <span class="op">=</span> Lv.astype(np.uint8)</span>
<span id="cb224-14"><a href="#cb224-14"></a>    plt.imshow(c, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-145-output-1.svg" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="158">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb225-2"><a href="#cb225-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/girl01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb225-3"><a href="#cb225-3"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb225-4"><a href="#cb225-4"></a>    H, W, c <span class="op">=</span> x.shape</span>
<span id="cb225-5"><a href="#cb225-5"></a>    Lv  <span class="op">=</span> <span class="fl">.299</span> <span class="op">*</span> x[..., <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.587</span> <span class="op">*</span> x[..., <span class="dv">1</span>] <span class="op">+</span> <span class="fl">.114</span> <span class="op">*</span> x[..., <span class="dv">2</span>]</span>
<span id="cb225-6"><a href="#cb225-6"></a>    c <span class="op">=</span> np.tile(np.full_like(x, <span class="dv">0</span>, dtype <span class="op">=</span> np.uint8), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb225-7"><a href="#cb225-7"></a>    c[..., <span class="dv">3</span>] <span class="op">=</span> <span class="dv">255</span></span>
<span id="cb225-8"><a href="#cb225-8"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb225-9"><a href="#cb225-9"></a>        <span class="co"># グレースケールの値を代入すればよい</span></span>
<span id="cb225-10"><a href="#cb225-10"></a>        o <span class="op">=</span> i <span class="op">*</span> W</span>
<span id="cb225-11"><a href="#cb225-11"></a>        c[:, o:(o <span class="op">+</span> W), i] <span class="op">=</span> Lv.astype(np.uint8)</span>
<span id="cb225-12"><a href="#cb225-12"></a>    plt.imshow(c, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>(697, 636, 4)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="162">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1"></a><span class="co"># ダブルトーンによるカラー化</span></span>
<span id="cb227-2"><a href="#cb227-2"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb227-3"><a href="#cb227-3"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/girl01.png"</span>) <span class="im">as</span> img:</span>
<span id="cb227-4"><a href="#cb227-4"></a>    x <span class="op">=</span> np.array(img)</span>
<span id="cb227-5"><a href="#cb227-5"></a>    H, W, c <span class="op">=</span> x.shape</span>
<span id="cb227-6"><a href="#cb227-6"></a>    L <span class="op">=</span> (<span class="fl">.299</span> <span class="op">*</span> x[..., <span class="dv">0</span>] <span class="op">+</span> <span class="fl">.587</span> <span class="op">*</span> x[..., <span class="dv">1</span>] <span class="op">+</span> <span class="fl">.114</span> <span class="op">*</span> x[..., <span class="dv">2</span>]).astype(np.uint8)</span>
<span id="cb227-7"><a href="#cb227-7"></a>    c <span class="op">=</span> np.tile(np.full_like(x, <span class="dv">255</span>, dtype <span class="op">=</span> np.uint8), (<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">1</span>))</span>
<span id="cb227-8"><a href="#cb227-8"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb227-9"><a href="#cb227-9"></a>        o <span class="op">=</span> i <span class="op">*</span> W</span>
<span id="cb227-10"><a href="#cb227-10"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">3</span>):</span>
<span id="cb227-11"><a href="#cb227-11"></a>            k <span class="op">=</span> (i <span class="op">+</span> j) <span class="op">%</span> <span class="dv">3</span></span>
<span id="cb227-12"><a href="#cb227-12"></a>            c[:, o:(o <span class="op">+</span> W), k] <span class="op">=</span> L</span>
<span id="cb227-13"><a href="#cb227-13"></a>    plt.imshow(c, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-147-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q52セピア化" class="level3" data-number="14.49">
<h3 data-number="14.49" class="anchored" data-anchor-id="q52セピア化"><span class="header-section-number">14.49</span> Q52：セピア化</h3>
<p>グレースケール化したときに，白は白になり，黒はセピア色になる処理.</p>
<div class="cell" data-execution_count="204">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1"></a><span class="co">## Q52</span></span>
<span id="cb228-2"><a href="#cb228-2"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> orig:</span>
<span id="cb228-3"><a href="#cb228-3"></a>    g <span class="op">=</span> np.array(orig.convert(<span class="st">"L"</span>)) <span class="op">/</span> <span class="fl">255.0</span></span>
<span id="cb228-4"><a href="#cb228-4"></a>img <span class="op">=</span> np.stack([g<span class="op">*</span><span class="dv">255</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>g)<span class="op">*</span><span class="dv">107</span>, (g<span class="op">*</span><span class="dv">255</span>)<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>g)<span class="op">*</span><span class="dv">74</span>, g<span class="op">*</span><span class="dv">255</span><span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>g)<span class="op">*</span><span class="dv">43</span>], axis<span class="op">=-</span><span class="dv">1</span>).astype(np.uint8)</span>
<span id="cb228-5"><a href="#cb228-5"></a>plt.imshow(img)</span>
<span id="cb228-6"><a href="#cb228-6"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-148-output-1.svg" class="img-fluid"></p>
</div>
</div>
</section>
<section id="q53cssのセピア化" class="level3" data-number="14.50">
<h3 data-number="14.50" class="anchored" data-anchor-id="q53cssのセピア化"><span class="header-section-number">14.50</span> Q53：CSSのセピア化</h3>
<div class="cell" data-execution_count="222">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1"></a><span class="kw">def</span> generate_sepia(alpha):</span>
<span id="cb229-2"><a href="#cb229-2"></a>    v <span class="op">=</span> np.array([<span class="dv">393</span>,  <span class="dv">769</span>,  <span class="dv">189</span>,  <span class="dv">349</span>, <span class="dv">686</span>,  <span class="dv">168</span>,  <span class="dv">272</span>,  <span class="dv">534</span>,  <span class="dv">131</span>]).reshape((<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>)) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb229-3"><a href="#cb229-3"></a>    a <span class="op">=</span> np.array([<span class="dv">607</span>, <span class="op">-</span><span class="dv">769</span>, <span class="op">-</span><span class="dv">189</span>, <span class="op">-</span><span class="dv">349</span>, <span class="dv">314</span>, <span class="op">-</span><span class="dv">168</span>, <span class="op">-</span><span class="dv">272</span>, <span class="op">-</span><span class="dv">534</span>,  <span class="dv">869</span>]).reshape((<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>)) <span class="op">/</span> <span class="dv">1000</span></span>
<span id="cb229-4"><a href="#cb229-4"></a>    <span class="cf">return</span> v  <span class="op">+</span> (<span class="dv">1</span> <span class="op">-</span> alpha) <span class="op">*</span> a</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="223">
<details open="">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1"></a>fig <span class="op">=</span> plt.figure(figsize <span class="op">=</span> (<span class="dv">16</span>, <span class="dv">16</span>))</span>
<span id="cb230-2"><a href="#cb230-2"></a>sepia_rate <span class="op">=</span> [<span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.75</span>, <span class="fl">1.</span>]</span>
<span id="cb230-3"><a href="#cb230-3"></a><span class="cf">with</span> Image.<span class="bu">open</span>(<span class="st">"numpy_book/imgs/flower01.jpg"</span>) <span class="im">as</span> img:</span>
<span id="cb230-4"><a href="#cb230-4"></a>    flower <span class="op">=</span> np.array(img)</span>
<span id="cb230-5"><a href="#cb230-5"></a></span>
<span id="cb230-6"><a href="#cb230-6"></a><span class="cf">for</span> i, alpha <span class="kw">in</span> <span class="bu">enumerate</span>(sepia_rate, start <span class="op">=</span> <span class="dv">1</span>):</span>
<span id="cb230-7"><a href="#cb230-7"></a>    sepia <span class="op">=</span> generate_sepia(alpha)</span>
<span id="cb230-8"><a href="#cb230-8"></a>    img   <span class="op">=</span> np.clip(np.dot(flower, sepia.T), <span class="dv">0</span>, <span class="dv">255</span>).astype(np.uint8)</span>
<span id="cb230-9"><a href="#cb230-9"></a>    ax    <span class="op">=</span> fig.add_subplot(<span class="dv">2</span>, <span class="dv">2</span>, i)</span>
<span id="cb230-10"><a href="#cb230-10"></a>    ax.imshow(img, vmin <span class="op">=</span> <span class="dv">0</span>, vmax <span class="op">=</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="ch04_テンソルと画像処理_files/figure-html/cell-150-output-1.svg" class="img-fluid"></p>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../../../contents/books/07_NumpyInfinity/ch03_行列の導入.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">行列の導入</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q52.html" class="pagination-link">
        <span class="nav-page-text">Q52：セピア化</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>