<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>応用編 – R Tips</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html" rel="next">
<link href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html" rel="prev">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-07ba0ad10f5680c660e360ac31d2f3b6.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap-3ca10592e571c480e0d0902a3fb6025a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;800&amp;display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">R Tips</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-home" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Home</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-home">    
        <li>
    <a class="dropdown-item" href="../../../index.html">
 <span class="dropdown-text">Home</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-web-site" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Web Site</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-web-site">    
        <li class="dropdown-header">ALL</li>
        <li>
    <a class="dropdown-item" href="../../../contents/website/r4ds2e/index.html">
 <span class="dropdown-text">R for Data Science 2e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/leaflet4r/index.html">
 <span class="dropdown-text">Leaflet for R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/analizeUSCensus/index.html">
 <span class="dropdown-text">Analyzing US Census Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/graphic_design_with_ggplot2/index.html">
 <span class="dropdown-text">Graphic Design with ggplot2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/website/udemy_database-specialist/am-2-note.html">
 <span class="dropdown-text">Udemyデータベーススペシャリスト</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-books" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">books</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-books">    
        <li class="dropdown-header">R</li>
        <li>
    <a class="dropdown-item" href="../../../contents/books/01_Rによる実証分析_2e/index.html">
 <span class="dropdown-text">Rによる実証分析2e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/02_因果推論ミックステープ/index.html">
 <span class="dropdown-text">因果推論ミックステープ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/index.html">
 <span class="dropdown-text">数値シミュレーションで学ぶ統計の仕組み</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/05_統計的因果推論の理論と実際/index.html">
 <span class="dropdown-text">統計的因果推論の理論と実際</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Python</li>
        <li>
    <a class="dropdown-item" href="../../../contents/books/06_Pythonではじめる数理最適化/index.html">
 <span class="dropdown-text">Pythonではじめる数理最適化 2nd</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/07_NumpyInfinity/ch01_Pythonの基礎.html">
 <span class="dropdown-text">Numpy Infinity</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/08_handbook_lightgbm/cl02_データ理解.html">
 <span class="dropdown-text">LightGBMハンドブック</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html">
 <span class="dropdown-text">Pythonで学ぶ数理最適化</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html">
 <span class="dropdown-text">爆速Python</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/books/11_Pythonではじめる時系列分析入門/index.html">
 <span class="dropdown-text">Pythonではじめる時系列分析</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-libs" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">libs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-libs">    
        <li class="dropdown-header">R</li>
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/base/working.html">
 <span class="dropdown-text">base</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/argparse/index.html">
 <span class="dropdown-text">argparse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/assertr/index.html">
 <span class="dropdown-text">assertr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/corrr/working.html">
 <span class="dropdown-text">corrr</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ComplexHeatmap/working.html">
 <span class="dropdown-text">ComplexHeatmap</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/duckdb/working.html">
 <span class="dropdown-text">duckdb</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/DBI/working.html">
 <span class="dropdown-text">DBI</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggspatial/working.html">
 <span class="dropdown-text">ggspatial</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/GGally/working.html">
 <span class="dropdown-text">GGally</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggtext/working.html">
 <span class="dropdown-text">ggtext</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggfittext/working.html">
 <span class="dropdown-text">ggfittext</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/gganimate/working.html">
 <span class="dropdown-text">gganimate</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/ggmosaic/working.html">
 <span class="dropdown-text">ggmosaic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/treemapify/working.html">
 <span class="dropdown-text">treemapify</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/tidyverse/working.html">
 <span class="dropdown-text">tidyverse</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/sf/working.html">
 <span class="dropdown-text">sf</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/igraph/index.html">
 <span class="dropdown-text">igraph</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/R/patchwork/working.html">
 <span class="dropdown-text">pathcwork</span></a>
  </li>  
        <li><hr class="dropdown-divider"></li>
        <li class="dropdown-header">Python</li>
        <li>
    <a class="dropdown-item" href="../../../contents/libs/Python/pydantic/index.html">
 <span class="dropdown-text">pydantic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/libs/Python/pandera/index.html">
 <span class="dropdown-text">pandera</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-notes" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Notes</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-notes">    
        <li class="dropdown-header">Notes</li>
        <li>
    <a class="dropdown-item" href="../../../contents/notes/ggplot2/working.html">
 <span class="dropdown-text">ggplot2</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-utils" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Utils</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-utils">    
        <li class="dropdown-header">Utils</li>
        <li>
    <a class="dropdown-item" href="../../../contents/utils/01_写真GPS/index.html">
 <span class="dropdown-text">01_写真GPS</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-sql" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">sql</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-sql">    
        <li class="dropdown-header">DuckDB</li>
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/documentaion/index.html">
 <span class="dropdown-text">Documentaion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/sql-bigdata/index.html">
 <span class="dropdown-text">ビッグデータレシピ</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/mytips/01_.html">
 <span class="dropdown-text">My Tips</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/sql/duckdb/SpatialDataAnalysiswithDuckDB/working.html">
 <span class="dropdown-text">Spatial DataAnalysis with DuckDB</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-test" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Test</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-test">    
        <li class="dropdown-header">Test</li>
        <li>
    <a class="dropdown-item" href="../../../contents/test/bash/quick_sample.html">
 <span class="dropdown-text">Bash</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/R/renv.html">
 <span class="dropdown-text">R</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/R2/renv.html">
 <span class="dropdown-text">R2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../contents/test/python/notebook.html">
 <span class="dropdown-text">Python</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Python</li><li class="breadcrumb-item"><a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html">Pythonで学ぶ数理最適化</a></li><li class="breadcrumb-item"><a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch02_応用編.html">応用編</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Rによる実証分析2e</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch01_回帰分析の目的.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 回帰分析の目的</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch02_統計の基礎知識.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 統計の基礎知識</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch03_確率論の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 確率論の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch04_回帰分析の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch05_推測統計の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 推測統計の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch06_相関関係と因果関係.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 相関関係と因果関係</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch07_外生変数と内生変数.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 内生変数と外生変数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch08_ランダム化実験.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch08 ランダム化実験</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch09_マッチング法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch09 マッチング法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch10_回帰不連続デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch10 回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch11_操作変数法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch11 操作変数法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/01_Rによる実証分析_2e/ch12_パネルデータ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch12 パネルデータ</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">因果推論ミックステープ</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch01_導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch02_確率と回帰の概要.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 確率と回帰の概要</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch03_非巡回的有向グラフ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 非巡回的有向グラフ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch04_潜在アウトカム因果モデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 潜在アウトカム因果モデル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch05_マッチングと層別化.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 マッチングと層別化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch06_回帰不連続デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch07_操作変数.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 操作変数</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch08_パネルデータ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch08 パネルデータ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch09_差分の差デザイン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch09 差分の差デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch10_合成コントロール法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch10 合成コントロール</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/02_因果推論ミックステープ/ch11_結論.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch11 結論</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">数値シミュレーションで学ぶ統計の仕組み</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch01_本書の狙い.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch01 本書のねらい</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch02_プログラミングの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch02 プログラミングの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch03_乱数生成シミュレーションの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch03 乱数生成シミュレーションの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch04_母数の推定のシミュレーション.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch04 母数の推定</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch05_統計検定の論理とエラー確率のコントロール - コピー (2).html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch05 統計検定の論理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch06_適切な検定のためのサンプルサイズ設計.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch06 サンプルサイズ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/03_数値シミュレーションで身につける統計の仕組み/ch07_回帰分析とシミュレーション.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ch07 回帰分析</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">統計的因果推論の理論と実際</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/101_統計的因果推論の基礎の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基礎の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/102_潜在的結果変数の枠組み.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">潜在的結果変数の枠組み</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/103_統計的因果推論における重要な仮定.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">重要な仮定</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/104_推測統計の基礎：標準誤差と信頼区間.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">標準誤差と信頼区間</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/105_回帰分析の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/106_図で理解する重回帰モデルの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">重回帰分析の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/107_最小二乗法による重回帰モデルの仮定と診断1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">最小二乗法の仮定と診断1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/108_最小二乗法による重回帰モデルの仮定と診断2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">最小二乗法の仮定と診断2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/109_交互作用項のある共分散分析.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">交互作用項のある共分散分析</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/110_傾向スコア.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコア</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/111_傾向スコアマッチング.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコアマッチング</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/112_傾向スコアによる層化解析法および重み付き法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">傾向スコアによる層化解析法および重み付き法</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/113_操作変数法の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">操作変数法の基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/114_操作変数法による非遵守への対処.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">操作変数の非遵守への対処</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/115_回帰不連続デザインの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">回帰不連続デザイン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/05_統計的因果推論の理論と実際/119_欠測データ処理の基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">欠損データ処理</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Python</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">Pythonではじめる数理最適化 2nd</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch02_チュートリアル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">数理最適化チュートリアル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch03_学校のクラス編成.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">学校のクラス編成</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch04_クーポン.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">クーポン</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/06_Pythonではじめる数理最適化/ch05_配送計画.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">配送計画</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false">
 <span class="menu-text">Numpy Infinity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch01_Pythonの基礎.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pythonの基礎</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch02_numpyの導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">numpyの導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch03_行列の導入.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">行列の導入</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">テンソルと画像処理</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q52.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Q52：セピア化</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch04_テンソルと画像処理_Q72.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Q84：CMYK色空間</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/07_NumpyInfinity/ch05_ブロードキャストの応用.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ブロードキャストの応用</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false">
 <span class="menu-text">LightGBMハンドブック</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl02_データ理解.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Setup</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl03_分類の予測モデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/08_handbook_lightgbm/cl04_回帰の予測モデル改善.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true">
 <span class="menu-text">Pythonで学ぶ数理最適化</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">基礎編</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch02_応用編.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">応用編</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false">
 <span class="menu-text">爆速Python</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">組込み機能のパフォーマンスを最大限に引き出す</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/10_爆速Python/ch03_並行性_並列性_非同期処理.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Ch03 並行性 並列性 非同期処理</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false">
 <span class="menu-text">Pythonではじめる時系列分析</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch01_時系列分析をはじめよう.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">時系列分析をはじめよう</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch02_時系列データの構造.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">時系列データの構造</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch03_データ生成過程の基本.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">データ生成過程の基本</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch04_pandasによる日付処理の基本.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pandasによる日付処理の基本</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch05_Pythonによる時系列分析の基本.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pythonによる時系列分析の基本</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch06_時系列データのシミュレーションと見せかけの回帰.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">時系列データのシミュレーションと見せかけの回帰</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch31_単純な時系列予測の手法.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">単純な時系列予測</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch32_季節調整とトレンド除去.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">季節調整とトレンド除去</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch33_sktimeの使い方.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">sktimeの使い方</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch34_指数平滑化法とその周辺.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">指数平滑化方とその周辺</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch41_box-jenkins法からの自動予測アプローチ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Box-Jenkins法からの自動予測アプローチ</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch42_ARIMAモデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ARIMAモデル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch43_SARIMAモデル.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">SARIMAモデル</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch44_モデル選択.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">モデル選択</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch51_状態空間モデルの概要.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">状態空間モデルの概要</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../contents/books/11_Pythonではじめる時系列分析入門/ch52_ローカルレベルモデルの基本.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ローカルレベルモデルの基本</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#問題解決のやり方" id="toc-問題解決のやり方" class="nav-link active" data-scroll-target="#問題解決のやり方"><span class="header-section-number">1</span> 問題解決のやり方</a></li>
  <li><a href="#輸送費を減らしたい" id="toc-輸送費を減らしたい" class="nav-link" data-scroll-target="#輸送費を減らしたい"><span class="header-section-number">2</span> 輸送費を減らしたい</a></li>
  <li><a href="#もっと食べたくなる献立を" id="toc-もっと食べたくなる献立を" class="nav-link" data-scroll-target="#もっと食べたくなる献立を"><span class="header-section-number">3</span> もっと食べたくなる献立を</a></li>
  <li><a href="#お酒をわけよう" id="toc-お酒をわけよう" class="nav-link" data-scroll-target="#お酒をわけよう"><span class="header-section-number">4</span> お酒をわけよう</a>
  <ul class="collapse">
  <li><a href="#公平にしたい" id="toc-公平にしたい" class="nav-link" data-scroll-target="#公平にしたい"><span class="header-section-number">4.1</span> 公平にしたい</a></li>
  <li><a href="#つの尺度で考える" id="toc-つの尺度で考える" class="nav-link" data-scroll-target="#つの尺度で考える"><span class="header-section-number">4.2</span> ２つの尺度で考える</a></li>
  </ul></li>
  <li><a href="#シフト表をつくりたい" id="toc-シフト表をつくりたい" class="nav-link" data-scroll-target="#シフト表をつくりたい"><span class="header-section-number">5</span> シフト表をつくりたい</a>
  <ul class="collapse">
  <li><a href="#シフト表をつくるには" id="toc-シフト表をつくるには" class="nav-link" data-scroll-target="#シフト表をつくるには"><span class="header-section-number">5.1</span> シフト表をつくるには</a></li>
  <li><a href="#まずは作ってみる" id="toc-まずは作ってみる" class="nav-link" data-scroll-target="#まずは作ってみる"><span class="header-section-number">5.2</span> まずは作ってみる</a></li>
  <li><a href="#シフト表に必要な条件を考慮" id="toc-シフト表に必要な条件を考慮" class="nav-link" data-scroll-target="#シフト表に必要な条件を考慮"><span class="header-section-number">5.3</span> シフト表に必要な条件を考慮</a></li>
  <li><a href="#休みの希望を叶える" id="toc-休みの希望を叶える" class="nav-link" data-scroll-target="#休みの希望を叶える"><span class="header-section-number">5.4</span> 休みの希望を叶える</a></li>
  <li><a href="#つの応えを出そう" id="toc-つの応えを出そう" class="nav-link" data-scroll-target="#つの応えを出そう"><span class="header-section-number">5.5</span> 2つの応えを出そう</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content column-body" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Python</li><li class="breadcrumb-item"><a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html">Pythonで学ぶ数理最適化</a></li><li class="breadcrumb-item"><a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch02_応用編.html">応用編</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">応用編</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li></ul></div></div>
</div>



<div class="quarto-title-meta column-body">

    
  
    
  </div>
  


</header>


<section id="問題解決のやり方" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> 問題解決のやり方</h1>
<ol type="1">
<li>「支援者」が「相談者」から問題の内容をヒアリングする</li>
<li>「支援者」が「相談者」からデータをもらったり、収集したりする</li>
<li>「相談者」と「支援者」で検討して、何から解決したいかを決める</li>
<li>「支援者」が方法を考えて解を求める</li>
<li>「支援者」が結果をまとめて「相談者」にみてもらう</li>
<li>おかしなところがあれば適宜戻る</li>
</ol>
</section>
<section id="輸送費を減らしたい" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> 輸送費を減らしたい</h1>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715050605405.png" class="img-fluid figure-img"></p>
<figcaption>picture 0</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715050614308.png" class="img-fluid figure-img"></p>
<figcaption>picture 1</figcaption>
</figure>
</div>
<div id="cell-3" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>num_factory <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>num_warehouse <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>supply <span class="op">=</span> [<span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">45</span>]</span>
<span id="cb1-4"><a href="#cb1-4"></a>demand <span class="op">=</span> [<span class="dv">38</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">36</span>]</span>
<span id="cb1-5"><a href="#cb1-5"></a>cost <span class="op">=</span> [ <span class="co"># factory x warehouse</span></span>
<span id="cb1-6"><a href="#cb1-6"></a>    [<span class="dv">19</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">18</span>], </span>
<span id="cb1-7"><a href="#cb1-7"></a>    [<span class="dv">14</span>, <span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">12</span>],</span>
<span id="cb1-8"><a href="#cb1-8"></a>    [<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">15</span>, <span class="dv">10</span>],</span>
<span id="cb1-9"><a href="#cb1-9"></a>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-4" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a>model <span class="op">=</span> Model()</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co"># 工場と倉庫間の輸送量</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>x <span class="op">=</span> model.add_var_tensor((num_factory, num_warehouse), <span class="st">"x"</span>)</span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># 輸送量の単価と輸送料の内積を最少化</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>model.objective <span class="op">=</span> minimize(xsum((cost <span class="op">*</span> x).flat))</span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_factory):</span>
<span id="cb2-11"><a href="#cb2-11"></a>    model <span class="op">+=</span> xsum(x[i]) <span class="op">&lt;=</span> supply[i]</span>
<span id="cb2-12"><a href="#cb2-12"></a></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_warehouse):</span>
<span id="cb2-14"><a href="#cb2-14"></a>    model <span class="op">+=</span> xsum(x[:,j]) <span class="op">==</span> demand[j]</span>
<span id="cb2-15"><a href="#cb2-15"></a></span>
<span id="cb2-16"><a href="#cb2-16"></a></span>
<span id="cb2-17"><a href="#cb2-17"></a>model.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb2-18"><a href="#cb2-18"></a>model.optimize()</span>
<span id="cb2-19"><a href="#cb2-19"></a></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="cf">if</span> model.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-21"><a href="#cb2-21"></a>    <span class="bu">print</span>(<span class="st">"目的関数の値"</span>)</span>
<span id="cb2-22"><a href="#cb2-22"></a>    <span class="bu">print</span>(model.objective_value)</span>
<span id="cb2-23"><a href="#cb2-23"></a>    <span class="bu">print</span>(<span class="st">"工場と倉庫間ごとの輸送量"</span>)</span>
<span id="cb2-24"><a href="#cb2-24"></a>    <span class="bu">print</span>(x.astype(<span class="bu">float</span>, subok<span class="op">=</span><span class="va">False</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>目的関数の値
1419.0
工場と倉庫間ごとの輸送量
[[ 0. 17. 22.  0.]
 [37.  3.  0.  0.]
 [ 1.  0.  0. 36.]]</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715050969440.png" class="img-fluid figure-img"></p>
<figcaption>picture 2</figcaption>
</figure>
</div>
<p>上記の結果を踏まえて考えると実は車両の重量に端数がでるので、車両運用費という面で実は飛行率であった。 そこで目的関数を変更してみる。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715135165347.png" class="img-fluid figure-img"></p>
<figcaption>picture 3</figcaption>
</figure>
</div>
<p>便数は整数変数として用意する。工場 x 倉庫であるので、2次元の変数が必要となる。</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="im">from</span> math <span class="im">import</span> ceil</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># 便数を下限を切り上げた値で考える</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># 輸送量x[i,j]を車両のキャパシティで除した値が、車両の運行回数となる</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>y[i, j] <span class="op">=</span> ceil(x[i, j] <span class="op">/</span> capaticy)</span>
<span id="cb4-6"><a href="#cb4-6"></a>m <span class="op">+=</span> y[i, j] <span class="op">&gt;=</span> x[i, j] <span class="op">/</span> capacity</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715135359815.png" class="img-fluid figure-img"></p>
<figcaption>picture 4</figcaption>
</figure>
</div>
<div id="cell-7" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a>capacity <span class="op">=</span> <span class="dv">5</span> <span class="co"># 車両重量</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>num_factory <span class="op">=</span> <span class="dv">3</span> <span class="co"># 工場数</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>num_warehouse <span class="op">=</span> <span class="dv">4</span> <span class="co"># 倉庫数</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>supply <span class="op">=</span> [<span class="dv">39</span>, <span class="dv">40</span>, <span class="dv">45</span>] <span class="co"># 出火可能量 </span></span>
<span id="cb5-7"><a href="#cb5-7"></a>demand <span class="op">=</span> [<span class="dv">38</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">36</span>] <span class="co"># 需要量</span></span>
<span id="cb5-8"><a href="#cb5-8"></a>cost <span class="op">=</span> [ <span class="co"># 輸送費の便単価</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>    [<span class="dv">86</span>, <span class="dv">54</span>, <span class="dv">58</span>, <span class="dv">81</span>, ], </span>
<span id="cb5-10"><a href="#cb5-10"></a>    [<span class="dv">63</span>, <span class="dv">54</span>, <span class="dv">81</span>, <span class="dv">54</span>, ],</span>
<span id="cb5-11"><a href="#cb5-11"></a>    [<span class="dv">68</span>, <span class="dv">72</span>, <span class="dv">68</span>, <span class="dv">45</span>, ],</span>
<span id="cb5-12"><a href="#cb5-12"></a>]</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a></span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a>model <span class="op">=</span> Model()</span>
<span id="cb5-17"><a href="#cb5-17"></a></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co"># 工場と倉庫間の輸送量</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>x <span class="op">=</span> model.add_var_tensor((num_factory, num_warehouse), <span class="st">"x"</span>)</span>
<span id="cb5-20"><a href="#cb5-20"></a>y <span class="op">=</span> model.add_var_tensor(x.shape, <span class="st">"y"</span>, var_type <span class="op">=</span> <span class="st">"I"</span>)</span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co"># 輸送量の単価と輸送料の内積を最少化</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>model.objective <span class="op">=</span> minimize(xsum((cost <span class="op">*</span> y).flat))</span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_factory):</span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_warehouse):</span>
<span id="cb5-26"><a href="#cb5-26"></a>        <span class="co"># yを便数の下限で抑える</span></span>
<span id="cb5-27"><a href="#cb5-27"></a>        model <span class="op">+=</span> y[i,j] <span class="op">&gt;=</span> x[i,j] <span class="op">/</span> capacity</span>
<span id="cb5-28"><a href="#cb5-28"></a></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_factory):</span>
<span id="cb5-30"><a href="#cb5-30"></a>    model <span class="op">+=</span> xsum(x[i]) <span class="op">&lt;=</span> supply[i]</span>
<span id="cb5-31"><a href="#cb5-31"></a></span>
<span id="cb5-32"><a href="#cb5-32"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_warehouse):</span>
<span id="cb5-33"><a href="#cb5-33"></a>    model <span class="op">+=</span> xsum(x[:,j]) <span class="op">==</span> demand[j]</span>
<span id="cb5-34"><a href="#cb5-34"></a></span>
<span id="cb5-35"><a href="#cb5-35"></a></span>
<span id="cb5-36"><a href="#cb5-36"></a>model.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-37"><a href="#cb5-37"></a>model.optimize()</span>
<span id="cb5-38"><a href="#cb5-38"></a></span>
<span id="cb5-39"><a href="#cb5-39"></a><span class="cf">if</span> model.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb5-40"><a href="#cb5-40"></a>    val_x <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb5-41"><a href="#cb5-41"></a>    val_y <span class="op">=</span> y.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb5-42"><a href="#cb5-42"></a>    </span>
<span id="cb5-43"><a href="#cb5-43"></a>    <span class="bu">print</span>(<span class="ss">f"""</span></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="ss">工場と倉庫間ごとの輸送量:</span></span>
<span id="cb5-45"><a href="#cb5-45"></a><span class="sc">{</span>val_x<span class="sc">}</span></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="ss">          """</span>)</span>
<span id="cb5-47"><a href="#cb5-47"></a>    <span class="bu">print</span>(<span class="ss">f"""</span></span>
<span id="cb5-48"><a href="#cb5-48"></a><span class="ss">工場と倉庫ごとの便数</span></span>
<span id="cb5-49"><a href="#cb5-49"></a><span class="sc">{</span>val_y<span class="sc">}</span></span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="ss">          """</span>)</span>
<span id="cb5-51"><a href="#cb5-51"></a>    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
工場と倉庫間ごとの輸送量:
[[ 0. 15. 22.  0.]
 [33.  5.  0.  0.]
 [ 5.  0.  0. 36.]]
          

工場と倉庫ごとの便数
[[0. 3. 5. 0.]
 [7. 1. 0. 0.]
 [1. 0. 0. 8.]]
          </code></pre>
</div>
</div>
<p>平気積載率を考える。</p>
<p><span class="math display">\[
\text{平均積載率} = \frac{\text{輸送量}}{\text{便数}\times \text{車両容量}}
\]</span></p>
<div id="cell-9" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a>val_x1 <span class="op">=</span> val_x[val_y <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb7-2"><a href="#cb7-2"></a>val_y1 <span class="op">=</span> val_y[val_y <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="bu">print</span>(val_x1, val_y1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[15. 22. 33.  5.  5. 36.] [3. 5. 7. 1. 1. 8.]</code></pre>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="bu">print</span>(val_x1 <span class="op">/</span> val_y1 <span class="op">/</span> capacity)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1.         0.88       0.94285714 1.         1.         0.9       ]</code></pre>
</div>
</div>
<div id="cell-11" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a>model.objective_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>1375.0</code></pre>
</div>
</div>
<p>計算について、実は<code>numpy</code>が使えるので、上記も色々と計算方法がある。</p>
<div id="cell-13" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>np.<span class="bu">sum</span>(val_x, axis  <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>array([38., 20., 22., 36.])</code></pre>
</div>
</div>
<div id="cell-14" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1"></a>np.<span class="bu">sum</span>(val_x, axis  <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([37., 38., 41.])</code></pre>
</div>
</div>
<div id="cell-15" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1"></a>np.where(</span>
<span id="cb17-2"><a href="#cb17-2"></a>    val_y <span class="op">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb17-3"><a href="#cb17-3"></a>    val_x <span class="op">/</span> val_y <span class="op">/</span> capacity, </span>
<span id="cb17-4"><a href="#cb17-4"></a>    <span class="dv">0</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>C:\Users\suzuk\AppData\Local\Temp\ipykernel_26556\3530034533.py:3: RuntimeWarning: invalid value encountered in divide
  val_x / val_y / capacity,</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([[0.        , 1.        , 0.88      , 0.        ],
       [0.94285714, 1.        , 0.        , 0.        ],
       [1.        , 0.        , 0.        , 0.9       ]])</code></pre>
</div>
</div>
</section>
<section id="もっと食べたくなる献立を" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> もっと食べたくなる献立を</h1>
<p>献立の計画を課題に、モデルの作成方法やその改善方法を学ぶ。</p>
<p>たとえば、</p>
<ul>
<li>制約条件の改善プロセスや解が出ない場合の対処法を学ぶ</li>
</ul>
<div id="cell-17" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1"></a><span class="im">import</span> csv</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./input/menu.csv"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> fp:</span>
<span id="cb20-6"><a href="#cb20-6"></a>    _csv <span class="op">=</span> np.array(<span class="bu">list</span>(csv.reader(fp)))</span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="bu">print</span>(_csv[:<span class="dv">4</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[['Name' 'Cost' 'Liking' 'Calorie' 'Fat' 'Protein']
 ['焼肉サラダ' '489' '6' '625' '15' '18']
 ['とんこつラーメン' '379' '4' '408' '10' '12']
 ['カレーハンバーグ' '395' '7' '431' '12' '13']]</code></pre>
</div>
</div>
<div id="cell-18" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1"></a><span class="co"># 列名をキーとする辞書を作成</span></span>
<span id="cb22-2"><a href="#cb22-2"></a>data   <span class="op">=</span> {}</span>
<span id="cb22-3"><a href="#cb22-3"></a>header <span class="op">=</span> _csv[<span class="dv">0</span>][<span class="dv">1</span>:]</span>
<span id="cb22-4"><a href="#cb22-4"></a>values <span class="op">=</span> _csv[<span class="dv">1</span>:].transpose()</span>
<span id="cb22-5"><a href="#cb22-5"></a>menues <span class="op">=</span> values[<span class="dv">0</span>]</span>
<span id="cb22-6"><a href="#cb22-6"></a>items  <span class="op">=</span> values[<span class="dv">1</span>:].astype(<span class="bu">int</span>)</span>
<span id="cb22-7"><a href="#cb22-7"></a>data   <span class="op">=</span> {name:value <span class="cf">for</span> name, value <span class="kw">in</span> <span class="bu">zip</span>(header, items)}</span>
<span id="cb22-8"><a href="#cb22-8"></a></span>
<span id="cb22-9"><a href="#cb22-9"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>{'Cost': array([489, 379, 395, 313, 378, 230, 220, 189, 252, 339, 328, 375, 436,
        417, 521, 396, 682, 306, 338, 383]),
 'Liking': array([6, 4, 7, 3, 1, 2, 1, 2, 1, 3, 3, 2, 3, 3, 1, 3, 6, 1, 2, 2]),
 'Calorie': array([625, 408, 431, 330, 488, 380, 476, 316, 575, 598, 473, 683, 706,
        512, 599, 486, 798, 456, 527, 596]),
 'Fat': array([15, 10, 12,  8, 14,  5,  7,  3,  6,  9,  7, 10, 12, 12, 13, 15, 25,
         8, 10, 12]),
 'Protein': array([18, 12, 13, 15, 14,  9, 11,  8, 10,  8, 10, 12, 12, 14, 14, 15, 18,
        12, 11, 14])}</code></pre>
</div>
</div>
<div id="cell-19" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb24-2"><a href="#cb24-2"></a></span>
<span id="cb24-3"><a href="#cb24-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb24-6"><a href="#cb24-6"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb24-8"><a href="#cb24-8"></a>m.objective <span class="op">=</span> minimize(xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x))</span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb24-11"><a href="#cb24-11"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb24-12"><a href="#cb24-12"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb24-13"><a href="#cb24-13"></a>m.optimize()</span>
<span id="cb24-14"><a href="#cb24-14"></a></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb24-16"><a href="#cb24-16"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb24-17"><a href="#cb24-17"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb24-18"><a href="#cb24-18"></a>    <span class="bu">print</span>(<span class="ss">f"費用 </span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="sc">: .0f}</span><span class="ss">円"</span>)</span>
<span id="cb24-19"><a href="#cb24-19"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['野菜うどん' 'カレーうどん' 'サラダうどん' 'なべうどん' 'サラダスパゲッティ']
費用  1197円</code></pre>
</div>
</div>
<p>上記は一つの数理モデリングである。これに対して、「タンパク質の合計」を制約に加えたいとする。</p>
<div id="cell-21" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb26-2"><a href="#cb26-2"></a></span>
<span id="cb26-3"><a href="#cb26-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb26-4"><a href="#cb26-4"></a></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb26-6"><a href="#cb26-6"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>m.objective <span class="op">=</span> minimize(xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x))</span>
<span id="cb26-9"><a href="#cb26-9"></a></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb26-11"><a href="#cb26-11"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co"># NEW たんぱく質が80以上</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Protein"</span>] <span class="op">*</span> x) <span class="op">&gt;=</span> <span class="dv">80</span></span>
<span id="cb26-14"><a href="#cb26-14"></a></span>
<span id="cb26-15"><a href="#cb26-15"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb26-16"><a href="#cb26-16"></a>m.optimize()</span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb26-19"><a href="#cb26-19"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb26-20"><a href="#cb26-20"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb26-21"><a href="#cb26-21"></a>    <span class="bu">print</span>(<span class="ss">f"費用 </span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="sc">: .0f}</span><span class="ss">円"</span>)</span>
<span id="cb26-22"><a href="#cb26-22"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['焼肉サラダ' '豆腐ハンバーグ' '魚ハンバーグ' '魚ステーキ' 'とんかつステーキ']
費用  2258円</code></pre>
</div>
</div>
<p>たんぱく質を考慮した結果、脂肪が多いことがわかったので脂肪に関する制約を加える。</p>
<p>この結果、解を得ることができなくなった。</p>
<div id="cell-23" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb28-2"><a href="#cb28-2"></a></span>
<span id="cb28-3"><a href="#cb28-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb28-8"><a href="#cb28-8"></a>m.objective <span class="op">=</span> minimize(xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x))</span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb28-11"><a href="#cb28-11"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co"># たんぱく質が80以上</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Protein"</span>] <span class="op">*</span> x) <span class="op">&gt;=</span> <span class="dv">80</span></span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co"># NEW 脂肪が60以下</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x) <span class="op">&lt;=</span> <span class="dv">60</span></span>
<span id="cb28-16"><a href="#cb28-16"></a></span>
<span id="cb28-17"><a href="#cb28-17"></a></span>
<span id="cb28-18"><a href="#cb28-18"></a>m.verbose <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>m.optimize()</span>
<span id="cb28-20"><a href="#cb28-20"></a></span>
<span id="cb28-21"><a href="#cb28-21"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb28-22"><a href="#cb28-22"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb28-23"><a href="#cb28-23"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb28-24"><a href="#cb28-24"></a>    <span class="bu">print</span>(<span class="ss">f"費用 </span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="sc">: .0f}</span><span class="ss">円"</span>)</span>
<span id="cb28-25"><a href="#cb28-25"></a><span class="cf">else</span>:</span>
<span id="cb28-26"><a href="#cb28-26"></a>    <span class="bu">print</span>(m.status)</span>
<span id="cb28-27"><a href="#cb28-27"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OptimizationStatus.INFEASIBLE</code></pre>
</div>
</div>
<p>答えが出なくなった。そこで、制約条件を緩めて考える。</p>
<p>これには非負の変数を使う。</p>
<div id="cell-25" class="cell" data-execution_count="40">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb30-2"><a href="#cb30-2"></a></span>
<span id="cb30-3"><a href="#cb30-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb30-7"><a href="#cb30-7"></a>y <span class="op">=</span> m.add_var(<span class="st">"y"</span>)</span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb30-9"><a href="#cb30-9"></a>cost <span class="op">=</span> xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x)</span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="co"># たんぱく質を考慮したコスト</span></span>
<span id="cb30-11"><a href="#cb30-11"></a>m.objective <span class="op">=</span> minimize(cost <span class="op">+</span> <span class="dv">1000</span> <span class="op">*</span> y)</span>
<span id="cb30-12"><a href="#cb30-12"></a></span>
<span id="cb30-13"><a href="#cb30-13"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb30-14"><a href="#cb30-14"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb30-15"><a href="#cb30-15"></a><span class="co"># たんぱく質が80以上</span></span>
<span id="cb30-16"><a href="#cb30-16"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Protein"</span>] <span class="op">*</span> x) <span class="op">+</span> y <span class="op">&gt;=</span> <span class="dv">80</span></span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co"># NEW 脂肪が60以下</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x) <span class="op">&lt;=</span> <span class="dv">60</span></span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a>m.verbose <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>m.optimize()</span>
<span id="cb30-22"><a href="#cb30-22"></a></span>
<span id="cb30-23"><a href="#cb30-23"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb30-24"><a href="#cb30-24"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb30-25"><a href="#cb30-25"></a>    <span class="bu">print</span>(<span class="ss">f"淡泊質の不足分 </span><span class="sc">{</span>y<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-26"><a href="#cb30-26"></a>    f <span class="op">=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x)</span>
<span id="cb30-27"><a href="#cb30-27"></a>    <span class="bu">print</span>(<span class="ss">f"脂肪 </span><span class="sc">{</span>f<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb30-28"><a href="#cb30-28"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb30-29"><a href="#cb30-29"></a><span class="cf">else</span>:</span>
<span id="cb30-30"><a href="#cb30-30"></a>    <span class="bu">print</span>(m.status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>淡泊質の不足分 5.0
脂肪 60.0
['焼肉サラダ' '豆腐ハンバーグ' '和風ステーキ' 'サラダステーキ' '野菜ハンバーグ']</code></pre>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715144250224.png" class="img-fluid figure-img"></p>
<figcaption>picture 5</figcaption>
</figure>
</div>
<p>栄養だけを考えると、メニュー自体が気に入らないとう結果となった。</p>
<p>ここでは好みに関する条件を加える。</p>
<div id="cell-28" class="cell" data-execution_count="43">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb32-2"><a href="#cb32-2"></a></span>
<span id="cb32-3"><a href="#cb32-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb32-4"><a href="#cb32-4"></a></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb32-6"><a href="#cb32-6"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb32-7"><a href="#cb32-7"></a>y <span class="op">=</span> m.add_var(<span class="st">"y"</span>)</span>
<span id="cb32-8"><a href="#cb32-8"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb32-9"><a href="#cb32-9"></a>cost <span class="op">=</span> xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x)</span>
<span id="cb32-10"><a href="#cb32-10"></a>linking <span class="op">=</span> xsum(data[<span class="st">"Liking"</span>] <span class="op">*</span> x)</span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="co"># たんぱく質を考慮したコスト</span></span>
<span id="cb32-12"><a href="#cb32-12"></a><span class="co"># 好みを考慮したコスト. 好みのメニューだと最適化が進む</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>m.objective <span class="op">=</span> minimize(cost <span class="op">+</span> <span class="dv">1000</span> <span class="op">*</span> y <span class="op">-</span> <span class="dv">300</span> <span class="op">*</span> linking)</span>
<span id="cb32-14"><a href="#cb32-14"></a></span>
<span id="cb32-15"><a href="#cb32-15"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb32-16"><a href="#cb32-16"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb32-17"><a href="#cb32-17"></a><span class="co"># たんぱく質が80以上</span></span>
<span id="cb32-18"><a href="#cb32-18"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Protein"</span>] <span class="op">*</span> x) <span class="op">+</span> y <span class="op">&gt;=</span> <span class="dv">80</span></span>
<span id="cb32-19"><a href="#cb32-19"></a><span class="co"># NEW 脂肪が60以下</span></span>
<span id="cb32-20"><a href="#cb32-20"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x) <span class="op">&lt;=</span> <span class="dv">60</span></span>
<span id="cb32-21"><a href="#cb32-21"></a></span>
<span id="cb32-22"><a href="#cb32-22"></a>m.verbose <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb32-23"><a href="#cb32-23"></a>m.optimize()</span>
<span id="cb32-24"><a href="#cb32-24"></a></span>
<span id="cb32-25"><a href="#cb32-25"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb32-26"><a href="#cb32-26"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb32-27"><a href="#cb32-27"></a>    <span class="bu">print</span>(<span class="ss">f"淡泊質の不足分 </span><span class="sc">{</span>y<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-28"><a href="#cb32-28"></a>    f <span class="op">=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x)</span>
<span id="cb32-29"><a href="#cb32-29"></a>    <span class="bu">print</span>(<span class="ss">f"脂肪 </span><span class="sc">{</span>f<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb32-30"><a href="#cb32-30"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb32-31"><a href="#cb32-31"></a><span class="cf">else</span>:</span>
<span id="cb32-32"><a href="#cb32-32"></a>    <span class="bu">print</span>(m.status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>淡泊質の不足分 6.0
脂肪 59.0
['焼肉サラダ' 'カレーハンバーグ' '豆腐ハンバーグ' '和風ステーキ' '野菜ハンバーグ']</code></pre>
</div>
</div>
<p>メニューをみるとハンバーグが３つあり、飽きがくることが考えられる。</p>
<p>そこでハンバーグに関する制約条件を加える。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715144651981.png" class="img-fluid figure-img"></p>
<figcaption>picture 6</figcaption>
</figure>
</div>
<div id="cell-30" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1"></a></span>
<span id="cb34-2"><a href="#cb34-2"></a></span>
<span id="cb34-3"><a href="#cb34-3"></a></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="im">from</span> mip <span class="im">import</span> Model, minimize, xsum</span>
<span id="cb34-5"><a href="#cb34-5"></a></span>
<span id="cb34-6"><a href="#cb34-6"></a>m <span class="op">=</span> Model()</span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co"># 候補を選ぶかどうか</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>x <span class="op">=</span> m.add_var_tensor((<span class="bu">len</span>(menues), ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb34-10"><a href="#cb34-10"></a>y <span class="op">=</span> m.add_var(<span class="st">"y"</span>)</span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="co"># 選択候補の費用</span></span>
<span id="cb34-12"><a href="#cb34-12"></a>cost <span class="op">=</span> xsum(data[<span class="st">"Cost"</span>] <span class="op">*</span> x)</span>
<span id="cb34-13"><a href="#cb34-13"></a>linking <span class="op">=</span> xsum(data[<span class="st">"Liking"</span>] <span class="op">*</span> x)</span>
<span id="cb34-14"><a href="#cb34-14"></a><span class="co"># たんぱく質を考慮したコスト</span></span>
<span id="cb34-15"><a href="#cb34-15"></a><span class="co"># 好みを考慮したコスト. 好みのメニューだと最適化が進む</span></span>
<span id="cb34-16"><a href="#cb34-16"></a>m.objective <span class="op">=</span> minimize(cost <span class="op">+</span> <span class="dv">1000</span> <span class="op">*</span> y <span class="op">-</span> <span class="dv">300</span> <span class="op">*</span> linking)</span>
<span id="cb34-17"><a href="#cb34-17"></a></span>
<span id="cb34-18"><a href="#cb34-18"></a><span class="co"># 選択候補数が5</span></span>
<span id="cb34-19"><a href="#cb34-19"></a>m <span class="op">+=</span> xsum(x) <span class="op">==</span> <span class="dv">5</span></span>
<span id="cb34-20"><a href="#cb34-20"></a><span class="co"># たんぱく質が80以上</span></span>
<span id="cb34-21"><a href="#cb34-21"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Protein"</span>] <span class="op">*</span> x) <span class="op">+</span> y <span class="op">&gt;=</span> <span class="dv">80</span></span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="co"># NEW 脂肪が60以下</span></span>
<span id="cb34-23"><a href="#cb34-23"></a>m <span class="op">+=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x) <span class="op">&lt;=</span> <span class="dv">60</span></span>
<span id="cb34-24"><a href="#cb34-24"></a><span class="co"># ハンバーグが2つ以下</span></span>
<span id="cb34-25"><a href="#cb34-25"></a></span>
<span id="cb34-26"><a href="#cb34-26"></a>idx_hamburg <span class="op">=</span> np.where(<span class="bu">list</span>(<span class="bu">map</span>(<span class="kw">lambda</span> x: <span class="st">"ハンバーグ"</span> <span class="kw">in</span> x, menues)))</span>
<span id="cb34-27"><a href="#cb34-27"></a>m <span class="op">+=</span> xsum(x[idx_hamburg]) <span class="op">&lt;=</span> <span class="dv">2</span></span>
<span id="cb34-28"><a href="#cb34-28"></a></span>
<span id="cb34-29"><a href="#cb34-29"></a></span>
<span id="cb34-30"><a href="#cb34-30"></a>m.verbose <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb34-31"><a href="#cb34-31"></a>m.optimize()</span>
<span id="cb34-32"><a href="#cb34-32"></a></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb34-34"><a href="#cb34-34"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb34-35"><a href="#cb34-35"></a>    <span class="bu">print</span>(<span class="ss">f"淡泊質の不足分 </span><span class="sc">{</span>y<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-36"><a href="#cb34-36"></a>    f <span class="op">=</span> xsum(data[<span class="st">"Fat"</span>] <span class="op">*</span> x)</span>
<span id="cb34-37"><a href="#cb34-37"></a>    <span class="bu">print</span>(<span class="ss">f"脂肪 </span><span class="sc">{</span>f<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb34-38"><a href="#cb34-38"></a>    <span class="bu">print</span>(menues[val <span class="op">&gt;</span> <span class="fl">.5</span>])</span>
<span id="cb34-39"><a href="#cb34-39"></a><span class="cf">else</span>:</span>
<span id="cb34-40"><a href="#cb34-40"></a>    <span class="bu">print</span>(m.status)</span>
<span id="cb34-41"><a href="#cb34-41"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>淡泊質の不足分 7.0
脂肪 60.0
['焼肉サラダ' 'とんこつラーメン' 'カレーハンバーグ' '豆腐ハンバーグ' '魚ステーキ']</code></pre>
</div>
</div>
</section>
<section id="お酒をわけよう" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> お酒をわけよう</h1>
<p>試飲会のけるお酒の名があらの振り分け方の課題を通して、公平さを考慮した解の調整や多目的最適化に取り組む。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715301898303.png" class="img-fluid figure-img"></p>
<figcaption>picture 7</figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715302012288.png" class="img-fluid figure-img"></p>
<figcaption>picture 8</figcaption>
</figure>
</div>
<div id="cell-32" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1"></a></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="im">import</span> csv</span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="im">import</span> mip</span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./input/party.csv"</span>, encoding<span class="op">=</span><span class="st">"utf-8"</span>) <span class="im">as</span> fp:</span>
<span id="cb36-8"><a href="#cb36-8"></a>    _csv <span class="op">=</span> np.array(<span class="bu">list</span>(csv.reader(fp)))</span>
<span id="cb36-9"><a href="#cb36-9"></a>    </span>
<span id="cb36-10"><a href="#cb36-10"></a>    </span>
<span id="cb36-11"><a href="#cb36-11"></a>names <span class="op">=</span> _csv[<span class="dv">1</span>:, <span class="dv">0</span>] <span class="co"># 銘柄の名前</span></span>
<span id="cb36-12"><a href="#cb36-12"></a>data <span class="op">=</span> {} <span class="co"># 列名をキーとする辞書</span></span>
<span id="cb36-13"><a href="#cb36-13"></a><span class="cf">for</span> i, column <span class="kw">in</span> <span class="bu">enumerate</span>(_csv[<span class="dv">0</span>, <span class="dv">1</span>:]):</span>
<span id="cb36-14"><a href="#cb36-14"></a>    data[column] <span class="op">=</span> _csv[<span class="dv">1</span>:, i <span class="op">+</span> <span class="dv">1</span>].astype(<span class="bu">int</span>)</span>
<span id="cb36-15"><a href="#cb36-15"></a></span>
<span id="cb36-16"><a href="#cb36-16"></a></span>
<span id="cb36-17"><a href="#cb36-17"></a><span class="bu">print</span>(<span class="ss">f"銘柄の名前 (先頭三つ)"</span>)</span>
<span id="cb36-18"><a href="#cb36-18"></a><span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-19"><a href="#cb36-19"></a><span class="bu">print</span>(<span class="ss">f"アンケート得点 (先頭三つ)"</span>)</span>
<span id="cb36-20"><a href="#cb36-20"></a><span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>data[<span class="st">'Tokyo'</span>][:<span class="dv">3</span>]<span class="op">=</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="bu">print</span>(<span class="ss">f" </span><span class="sc">{</span>data[<span class="st">'Osaka'</span>][:<span class="dv">3</span>]<span class="op">=</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb36-22"><a href="#cb36-22"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>銘柄の名前 (先頭三つ)
 ['神風酒造り' '雪の瑞穂酒' '紅葉の美酒']
アンケート得点 (先頭三つ)
 data['Tokyo'][:3]=array([3, 2, 2])
 data['Osaka'][:3]=array([0, 3, 4])</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, maximize, xsum</span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb38-4"><a href="#cb38-4"></a>n <span class="op">=</span> <span class="bu">len</span>(data[<span class="st">"Tokyo"</span>])</span>
<span id="cb38-5"><a href="#cb38-5"></a>x <span class="op">=</span> m.add_var_tensor((n, ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb38-6"><a href="#cb38-6"></a><span class="co"># 東京の得点和</span></span>
<span id="cb38-7"><a href="#cb38-7"></a>tokyo <span class="op">=</span> xsum(data[<span class="st">"Tokyo"</span>] <span class="op">*</span> x)</span>
<span id="cb38-8"><a href="#cb38-8"></a><span class="co"># 大阪の得点和</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>osaka <span class="op">=</span> xsum(data[<span class="st">"Osaka"</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x))</span>
<span id="cb38-10"><a href="#cb38-10"></a></span>
<span id="cb38-11"><a href="#cb38-11"></a>m.objective <span class="op">=</span> maximize(tokyo <span class="op">+</span> osaka)</span>
<span id="cb38-12"><a href="#cb38-12"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-13"><a href="#cb38-13"></a>m.optimize()</span>
<span id="cb38-14"><a href="#cb38-14"></a></span>
<span id="cb38-15"><a href="#cb38-15"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb38-16"><a href="#cb38-16"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb38-17"><a href="#cb38-17"></a>    tokyo_names <span class="op">=</span> names[val <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb38-18"><a href="#cb38-18"></a>    osaka_names <span class="op">=</span> names[val <span class="op">&lt;=</span> <span class="fl">.5</span>]</span>
<span id="cb38-19"><a href="#cb38-19"></a>    <span class="bu">print</span>(<span class="ss">f"東京 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>tokyo_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-20"><a href="#cb38-20"></a>    <span class="bu">print</span>(<span class="ss">f"大阪 </span><span class="sc">{</span>osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>osaka_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb38-21"><a href="#cb38-21"></a>    <span class="bu">print</span>(<span class="ss">f"合計 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x <span class="op">+</span> osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>東京 52.0 ['神風酒造り' '月の輝き' '大和の誇り']
大阪 84.0 ['雪の瑞穂酒' '紅葉の美酒' '翡翠の杯']
合計 136.0</code></pre>
</div>
</div>
<section id="公平にしたい" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="公平にしたい"><span class="header-section-number">4.1</span> 公平にしたい</h2>
<p>地域によって平均点が異なるので単純な合計値では不公平になる。</p>
<p>そこで、ここではまず最低得点という制約を加えたモデリングをおこなう。</p>
<div id="cell-35" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, maximize, xsum</span>
<span id="cb40-2"><a href="#cb40-2"></a></span>
<span id="cb40-3"><a href="#cb40-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb40-4"><a href="#cb40-4"></a>n <span class="op">=</span> <span class="bu">len</span>(data[<span class="st">"Tokyo"</span>])</span>
<span id="cb40-5"><a href="#cb40-5"></a>x <span class="op">=</span> m.add_var_tensor((n, ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb40-6"><a href="#cb40-6"></a><span class="co"># 東京の得点和</span></span>
<span id="cb40-7"><a href="#cb40-7"></a>tokyo <span class="op">=</span> xsum(data[<span class="st">"Tokyo"</span>] <span class="op">*</span> x)</span>
<span id="cb40-8"><a href="#cb40-8"></a><span class="co"># 大阪の得点和</span></span>
<span id="cb40-9"><a href="#cb40-9"></a>osaka <span class="op">=</span> xsum(data[<span class="st">"Osaka"</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x))</span>
<span id="cb40-10"><a href="#cb40-10"></a></span>
<span id="cb40-11"><a href="#cb40-11"></a><span class="co"># 目的関数</span></span>
<span id="cb40-12"><a href="#cb40-12"></a>m.objective <span class="op">=</span> maximize(tokyo <span class="op">+</span> osaka)</span>
<span id="cb40-13"><a href="#cb40-13"></a></span>
<span id="cb40-14"><a href="#cb40-14"></a><span class="co"># 下限</span></span>
<span id="cb40-15"><a href="#cb40-15"></a>m <span class="op">+=</span> tokyo <span class="op">&gt;=</span> <span class="dv">53</span></span>
<span id="cb40-16"><a href="#cb40-16"></a></span>
<span id="cb40-17"><a href="#cb40-17"></a></span>
<span id="cb40-18"><a href="#cb40-18"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb40-19"><a href="#cb40-19"></a>m.optimize()</span>
<span id="cb40-20"><a href="#cb40-20"></a></span>
<span id="cb40-21"><a href="#cb40-21"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb40-22"><a href="#cb40-22"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb40-23"><a href="#cb40-23"></a>    tokyo_names <span class="op">=</span> names[val <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb40-24"><a href="#cb40-24"></a>    osaka_names <span class="op">=</span> names[val <span class="op">&lt;=</span> <span class="fl">.5</span>]</span>
<span id="cb40-25"><a href="#cb40-25"></a>    <span class="bu">print</span>(<span class="ss">f"東京 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>tokyo_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-26"><a href="#cb40-26"></a>    <span class="bu">print</span>(<span class="ss">f"大阪 </span><span class="sc">{</span>osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>osaka_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb40-27"><a href="#cb40-27"></a>    <span class="bu">print</span>(<span class="ss">f"合計 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x <span class="op">+</span> osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>東京 64.0 ['神風酒造り' '天空の酔いどれ' '月の輝き']
大阪 72.0 ['雪の瑞穂酒' '紅葉の美酒' '翡翠の杯']
合計 136.0</code></pre>
</div>
</div>
</section>
<section id="つの尺度で考える" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="つの尺度で考える"><span class="header-section-number">4.2</span> ２つの尺度で考える</h2>
<p>ここでは公平性を考えるために、会場間の得点の差が小さくなるようにしながら、得点の合計を最大化することを考える。</p>
<p>このような二つの指標で目的変数を考えることを多目的最適化という。</p>
<p>一般に多目的最適化はトレードオフになるので、ステップを分けて問題を解く。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715302809651.png" class="img-fluid figure-img"></p>
<figcaption>picture 9</figcaption>
</figure>
</div>
<div id="cell-37" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, maximize, xsum</span>
<span id="cb42-2"><a href="#cb42-2"></a></span>
<span id="cb42-3"><a href="#cb42-3"></a>m <span class="op">=</span> Model()</span>
<span id="cb42-4"><a href="#cb42-4"></a>n <span class="op">=</span> <span class="bu">len</span>(data[<span class="st">"Tokyo"</span>])</span>
<span id="cb42-5"><a href="#cb42-5"></a>x <span class="op">=</span> m.add_var_tensor((n, ), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co"># 東京の得点和</span></span>
<span id="cb42-7"><a href="#cb42-7"></a>tokyo <span class="op">=</span> xsum(data[<span class="st">"Tokyo"</span>] <span class="op">*</span> x)</span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="co"># 大阪の得点和</span></span>
<span id="cb42-9"><a href="#cb42-9"></a>osaka <span class="op">=</span> xsum(data[<span class="st">"Osaka"</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> x))</span>
<span id="cb42-10"><a href="#cb42-10"></a></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="co"># 目的関数</span></span>
<span id="cb42-12"><a href="#cb42-12"></a>m.objective <span class="op">=</span> maximize(tokyo <span class="op">+</span> osaka)</span>
<span id="cb42-13"><a href="#cb42-13"></a></span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="co"># 下限</span></span>
<span id="cb42-15"><a href="#cb42-15"></a>m <span class="op">+=</span> tokyo <span class="op">&gt;=</span> <span class="dv">0</span></span>
<span id="cb42-16"><a href="#cb42-16"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb42-18"><a href="#cb42-18"></a>    i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb42-19"><a href="#cb42-19"></a>    m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb42-20"><a href="#cb42-20"></a>    m.optimize()</span>
<span id="cb42-21"><a href="#cb42-21"></a></span>
<span id="cb42-22"><a href="#cb42-22"></a>    <span class="co"># 東京の値が大阪よりも大きくなるようにする</span></span>
<span id="cb42-23"><a href="#cb42-23"></a>    v1, v2 <span class="op">=</span> tokyo.x, osaka.x</span>
<span id="cb42-24"><a href="#cb42-24"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">回目 東京</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ss">, 大阪 </span><span class="sc">{</span>v2<span class="sc">}</span><span class="ss">, 合計 </span><span class="sc">{</span>v1 <span class="op">+</span> v2<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb42-25"><a href="#cb42-25"></a>    <span class="cf">if</span> v1 <span class="op">&gt;</span> v2:</span>
<span id="cb42-26"><a href="#cb42-26"></a>        <span class="cf">break</span></span>
<span id="cb42-27"><a href="#cb42-27"></a></span>
<span id="cb42-28"><a href="#cb42-28"></a>    <span class="co"># 制約条件の変更</span></span>
<span id="cb42-29"><a href="#cb42-29"></a>    m.constrs[<span class="dv">0</span>].rhs <span class="op">=</span> v1 <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb42-30"><a href="#cb42-30"></a></span>
<span id="cb42-31"><a href="#cb42-31"></a></span>
<span id="cb42-32"><a href="#cb42-32"></a></span>
<span id="cb42-33"><a href="#cb42-33"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-34"><a href="#cb42-34"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb42-35"><a href="#cb42-35"></a>    tokyo_names <span class="op">=</span> names[val <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb42-36"><a href="#cb42-36"></a>    osaka_names <span class="op">=</span> names[val <span class="op">&lt;=</span> <span class="fl">.5</span>]</span>
<span id="cb42-37"><a href="#cb42-37"></a>    <span class="bu">print</span>(<span class="ss">f"東京 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>tokyo_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb42-38"><a href="#cb42-38"></a>    <span class="bu">print</span>(<span class="ss">f"大阪 </span><span class="sc">{</span>osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss"> </span><span class="sc">{</span>osaka_names[:<span class="dv">3</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb42-39"><a href="#cb42-39"></a>    <span class="bu">print</span>(<span class="ss">f"合計 </span><span class="sc">{</span>tokyo<span class="sc">.</span>x <span class="op">+</span> osaka<span class="sc">.</span>x<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1回目 東京52.0, 大阪 84.0, 合計 136.0
2回目 東京64.0, 大阪 72.0, 合計 136.0
3回目 東京66.0, 大阪 69.0, 合計 135.0
4回目 東京67.0, 大阪 68.0, 合計 135.0
5回目 東京68.0, 大阪 67.0, 合計 135.0
東京 68.0 ['神風酒造り' '天空の酔いどれ' '竜神の泡']
大阪 67.0 ['雪の瑞穂酒' '紅葉の美酒' '翡翠の杯']
合計 135.0</code></pre>
</div>
</div>
</section>
</section>
<section id="シフト表をつくりたい" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> シフト表をつくりたい</h1>
<p>「なるべく守りたい条件」を考慮するにはどうすればよいのか？</p>
<section id="シフト表をつくるには" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="シフト表をつくるには"><span class="header-section-number">5.1</span> シフト表をつくるには</h2>
<p>人×日にちに対して、夜勤、日勤、休日などを割り当てる。</p>
<p>そのなかで各日ごとや、各人に対して条件を設ける。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715303710062.png" class="img-fluid figure-img"></p>
<figcaption>picture 10</figcaption>
</figure>
</div>
<p>どのような変数を考えるかについては、0-1変数を使う。</p>
<p>具体的にはスタッフ<span class="math inline">\(i0\)</span>が日番号<span class="math inline">\(i1\)</span>にシフト<span class="math inline">\(i2\)</span>をするかどうかを表す変数を使う。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715303825439.png" class="img-fluid figure-img"></p>
<figcaption>picture 11</figcaption>
</figure>
</div>
</section>
<section id="まずは作ってみる" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="まずは作ってみる"><span class="header-section-number">5.2</span> まずは作ってみる</h2>
<div id="cell-39" class="cell" data-execution_count="12">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1"></a>staffs <span class="op">=</span> [<span class="st">"安藤"</span>, <span class="st">"佐藤"</span>, <span class="st">"高橋"</span>, <span class="st">"山田"</span>]</span>
<span id="cb44-2"><a href="#cb44-2"></a>days <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb44-3"><a href="#cb44-3"></a>shifts <span class="op">=</span> [<span class="st">"日"</span>, <span class="st">"夜"</span>, <span class="st">"休"</span>]</span>
<span id="cb44-4"><a href="#cb44-4"></a>n0, n1, n2 <span class="op">=</span> <span class="bu">len</span>(staffs), <span class="bu">len</span>(days), <span class="bu">len</span>(shifts)</span>
<span id="cb44-5"><a href="#cb44-5"></a></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="im">from</span> mip <span class="im">import</span> Model, xsum</span>
<span id="cb44-7"><a href="#cb44-7"></a></span>
<span id="cb44-8"><a href="#cb44-8"></a></span>
<span id="cb44-9"><a href="#cb44-9"></a>m <span class="op">=</span> Model()</span>
<span id="cb44-10"><a href="#cb44-10"></a>x <span class="op">=</span> m.add_var_tensor((n0, n1, n2), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb44-11"><a href="#cb44-11"></a></span>
<span id="cb44-12"><a href="#cb44-12"></a></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="co"># 制約条件</span></span>
<span id="cb44-14"><a href="#cb44-14"></a><span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0):</span>
<span id="cb44-15"><a href="#cb44-15"></a>    <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb44-16"><a href="#cb44-16"></a>        <span class="co"># ある人がある日に割り当てられるシフトは1つ</span></span>
<span id="cb44-17"><a href="#cb44-17"></a>        m <span class="op">+=</span> xsum(x[i0, i1]) <span class="op">==</span> <span class="dv">1</span> </span>
<span id="cb44-18"><a href="#cb44-18"></a>        </span>
<span id="cb44-19"><a href="#cb44-19"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb44-20"><a href="#cb44-20"></a>m.optimize()</span>
<span id="cb44-21"><a href="#cb44-21"></a></span>
<span id="cb44-22"><a href="#cb44-22"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb44-23"><a href="#cb44-23"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>().astype(<span class="bu">int</span>)</span>
<span id="cb44-24"><a href="#cb44-24"></a>    result <span class="op">=</span> (np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,]).reshape(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> val).<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb44-25"><a href="#cb44-25"></a>    <span class="bu">print</span>(result)</span>
<span id="cb44-26"><a href="#cb44-26"></a></span>
<span id="cb44-27"><a href="#cb44-27"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[2 0 2 0 0 1 0]
 [0 0 2 0 0 2 0]
 [2 2 0 2 0 0 2]
 [2 0 0 0 0 0 1]]</code></pre>
</div>
</div>
</section>
<section id="シフト表に必要な条件を考慮" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="シフト表に必要な条件を考慮"><span class="header-section-number">5.3</span> シフト表に必要な条件を考慮</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715304630073.png" class="img-fluid figure-img"></p>
<figcaption>picture 12</figcaption>
</figure>
</div>
<div id="cell-41" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1"></a>m <span class="op">=</span> Model()</span>
<span id="cb46-2"><a href="#cb46-2"></a>x <span class="op">=</span> m.add_var_tensor((n0, n1, n2), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="co"># 制約条件</span></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0):</span>
<span id="cb46-7"><a href="#cb46-7"></a>    <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb46-8"><a href="#cb46-8"></a>        <span class="co"># ある人がある日に割り当てられるシフトは1つ</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>        m <span class="op">+=</span> xsum(x[i0, i1]) <span class="op">==</span> <span class="dv">1</span> </span>
<span id="cb46-10"><a href="#cb46-10"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">0</span>]) <span class="op">&lt;=</span> <span class="dv">4</span>  <span class="co"># 日勤4日以下</span></span>
<span id="cb46-11"><a href="#cb46-11"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">1</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 夜勤2日以下</span></span>
<span id="cb46-12"><a href="#cb46-12"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">2</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 休日2日以下</span></span>
<span id="cb46-13"><a href="#cb46-13"></a>    </span>
<span id="cb46-14"><a href="#cb46-14"></a><span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb46-15"><a href="#cb46-15"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">0</span>]) <span class="op">==</span> <span class="dv">2</span> <span class="co"># ある日の日勤は二人</span></span>
<span id="cb46-16"><a href="#cb46-16"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">1</span>]) <span class="op">==</span> <span class="dv">1</span> <span class="co"># ある日の夜勤は一人</span></span>
<span id="cb46-17"><a href="#cb46-17"></a>    </span>
<span id="cb46-18"><a href="#cb46-18"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb46-19"><a href="#cb46-19"></a>m.optimize()</span>
<span id="cb46-20"><a href="#cb46-20"></a></span>
<span id="cb46-21"><a href="#cb46-21"></a></span>
<span id="cb46-22"><a href="#cb46-22"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb46-23"><a href="#cb46-23"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>().astype(<span class="bu">int</span>)</span>
<span id="cb46-24"><a href="#cb46-24"></a>    result <span class="op">=</span> (np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,]).reshape(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> val).<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb46-25"><a href="#cb46-25"></a>    <span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 0 2 0 1 1 2]
 [2 0 1 0 0 2 1]
 [0 2 0 1 2 0 0]
 [1 1 0 2 0 0 0]]</code></pre>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># る日の日勤、夜勤、休日者の数</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>val.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([[2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1]])</code></pre>
</div>
</div>
</section>
<section id="休みの希望を叶える" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="休みの希望を叶える"><span class="header-section-number">5.4</span> 休みの希望を叶える</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715305137752.png" class="img-fluid figure-img"></p>
<figcaption>picture 13</figcaption>
</figure>
</div>
<p>「可能な限りかなえる」⇒目的変数として希望が実現できる数を目的変数にする。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715305357133.png" class="img-fluid figure-img"></p>
<figcaption>picture 14</figcaption>
</figure>
</div>
<div id="cell-44" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, maximize, xsum</span>
<span id="cb50-2"><a href="#cb50-2"></a></span>
<span id="cb50-3"><a href="#cb50-3"></a><span class="kw">def</span> show(result):</span>
<span id="cb50-4"><a href="#cb50-4"></a>    <span class="bu">print</span>(<span class="st">"    ０１２３４５６"</span>)</span>
<span id="cb50-5"><a href="#cb50-5"></a>    <span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0): <span class="co"># スタッフごと</span></span>
<span id="cb50-6"><a href="#cb50-6"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>staffs[i0]<span class="sc">}</span><span class="ss">: "</span>, end<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb50-7"><a href="#cb50-7"></a>        <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1): <span class="co"># 日番号ごと</span></span>
<span id="cb50-8"><a href="#cb50-8"></a>            <span class="bu">print</span>(shifts[result[i0, i1]], end<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb50-9"><a href="#cb50-9"></a>        <span class="bu">print</span>()</span>
<span id="cb50-10"><a href="#cb50-10"></a>        </span>
<span id="cb50-11"><a href="#cb50-11"></a>staffs <span class="op">=</span> [<span class="st">"安藤"</span>, <span class="st">"佐藤"</span>, <span class="st">"高橋"</span>, <span class="st">"山田"</span>]</span>
<span id="cb50-12"><a href="#cb50-12"></a>days  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb50-13"><a href="#cb50-13"></a>shifts <span class="op">=</span> [<span class="st">"日"</span>, <span class="st">"夜"</span>, <span class="st">"休"</span>]</span>
<span id="cb50-14"><a href="#cb50-14"></a>n0, n1, n2 <span class="op">=</span> <span class="bu">len</span>(staffs), <span class="bu">len</span>(days), <span class="bu">len</span>(shifts)</span>
<span id="cb50-15"><a href="#cb50-15"></a>wish_days <span class="op">=</span> [ <span class="co"># 休みの希望（追加）</span></span>
<span id="cb50-16"><a href="#cb50-16"></a>    [<span class="dv">0</span>, <span class="dv">3</span>],</span>
<span id="cb50-17"><a href="#cb50-17"></a>    [<span class="dv">2</span>],</span>
<span id="cb50-18"><a href="#cb50-18"></a>    [<span class="dv">1</span>, <span class="dv">6</span>],</span>
<span id="cb50-19"><a href="#cb50-19"></a>    [<span class="dv">5</span>],</span>
<span id="cb50-20"><a href="#cb50-20"></a>]</span>
<span id="cb50-21"><a href="#cb50-21"></a></span>
<span id="cb50-22"><a href="#cb50-22"></a>m <span class="op">=</span> Model()</span>
<span id="cb50-23"><a href="#cb50-23"></a>x <span class="op">=</span> m.add_var_tensor((n0, n1, n2), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb50-24"><a href="#cb50-24"></a></span>
<span id="cb50-25"><a href="#cb50-25"></a>x_wish_days <span class="op">=</span> []</span>
<span id="cb50-26"><a href="#cb50-26"></a><span class="cf">for</span> x_i, wish_day <span class="kw">in</span> <span class="bu">zip</span>(x, wish_days):</span>
<span id="cb50-27"><a href="#cb50-27"></a>    <span class="cf">for</span> day <span class="kw">in</span> wish_day:</span>
<span id="cb50-28"><a href="#cb50-28"></a>        <span class="co"># 該当スタッフの当該日番号の休みの変数を追加</span></span>
<span id="cb50-29"><a href="#cb50-29"></a>        x_wish_days.append(x_i[day, <span class="dv">2</span>])</span>
<span id="cb50-30"><a href="#cb50-30"></a>        </span>
<span id="cb50-31"><a href="#cb50-31"></a><span class="co"># 休みが希望通りの数を指標にする</span></span>
<span id="cb50-32"><a href="#cb50-32"></a>m.objective <span class="op">=</span> maximize(xsum(x_wish_days))</span>
<span id="cb50-33"><a href="#cb50-33"></a></span>
<span id="cb50-34"><a href="#cb50-34"></a><span class="co"># 制約条件</span></span>
<span id="cb50-35"><a href="#cb50-35"></a><span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0):</span>
<span id="cb50-36"><a href="#cb50-36"></a>    <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb50-37"><a href="#cb50-37"></a>        <span class="co"># ある人がある日に割り当てられるシフトは1つ</span></span>
<span id="cb50-38"><a href="#cb50-38"></a>        m <span class="op">+=</span> xsum(x[i0, i1]) <span class="op">==</span> <span class="dv">1</span> </span>
<span id="cb50-39"><a href="#cb50-39"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">0</span>]) <span class="op">&lt;=</span> <span class="dv">4</span>  <span class="co"># 日勤4日以下</span></span>
<span id="cb50-40"><a href="#cb50-40"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">1</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 夜勤2日以下</span></span>
<span id="cb50-41"><a href="#cb50-41"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">2</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 休日2日以下</span></span>
<span id="cb50-42"><a href="#cb50-42"></a>    </span>
<span id="cb50-43"><a href="#cb50-43"></a><span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb50-44"><a href="#cb50-44"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">0</span>]) <span class="op">==</span> <span class="dv">2</span> <span class="co"># ある日の日勤は二人</span></span>
<span id="cb50-45"><a href="#cb50-45"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">1</span>]) <span class="op">==</span> <span class="dv">1</span> <span class="co"># ある日の夜勤は一人</span></span>
<span id="cb50-46"><a href="#cb50-46"></a>    </span>
<span id="cb50-47"><a href="#cb50-47"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb50-48"><a href="#cb50-48"></a>m.optimize()</span>
<span id="cb50-49"><a href="#cb50-49"></a></span>
<span id="cb50-50"><a href="#cb50-50"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb50-51"><a href="#cb50-51"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>().astype(<span class="bu">int</span>)</span>
<span id="cb50-52"><a href="#cb50-52"></a>    result <span class="op">=</span> (np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,]).reshape(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> val).<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb50-53"><a href="#cb50-53"></a>    show(result)</span>
<span id="cb50-54"><a href="#cb50-54"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="op">=</span><span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    ０１２３４５６
安藤: 休日日休日夜夜
佐藤: 日夜休夜日日日
高橋: 日休夜日夜日休
山田: 夜日日日休休日
m.objective_value=6.0</code></pre>
</div>
</div>
</section>
<section id="つの応えを出そう" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="つの応えを出そう"><span class="header-section-number">5.5</span> 2つの応えを出そう</h2>
<p>休みの希望の成立数を目的巻数にしているが、条件を満たす解は実は多数あると考えられる。</p>
<p>複数のシフト表を出すことで、実際に提示するときに議論がしやすくなる。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../../static/img/1715306284739.png" class="img-fluid figure-img"></p>
<figcaption>picture 15</figcaption>
</figure>
</div>
<div id="cell-46" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1"></a>val.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([[2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1],
       [2, 1, 1]])</code></pre>
</div>
</div>
<div id="cell-47" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1"></a><span class="im">from</span> mip <span class="im">import</span> Model, maximize, xsum</span>
<span id="cb54-2"><a href="#cb54-2"></a></span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="kw">def</span> show(result):</span>
<span id="cb54-4"><a href="#cb54-4"></a>    <span class="bu">print</span>(<span class="st">"    ０１２３４５６"</span>)</span>
<span id="cb54-5"><a href="#cb54-5"></a>    <span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0): <span class="co"># スタッフごと</span></span>
<span id="cb54-6"><a href="#cb54-6"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>staffs[i0]<span class="sc">}</span><span class="ss">: "</span>, end<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb54-7"><a href="#cb54-7"></a>        <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1): <span class="co"># 日番号ごと</span></span>
<span id="cb54-8"><a href="#cb54-8"></a>            <span class="bu">print</span>(shifts[result[i0, i1]], end<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb54-9"><a href="#cb54-9"></a>        <span class="bu">print</span>()</span>
<span id="cb54-10"><a href="#cb54-10"></a>        </span>
<span id="cb54-11"><a href="#cb54-11"></a>staffs <span class="op">=</span> [<span class="st">"安藤"</span>, <span class="st">"佐藤"</span>, <span class="st">"高橋"</span>, <span class="st">"山田"</span>]</span>
<span id="cb54-12"><a href="#cb54-12"></a>days  <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb54-13"><a href="#cb54-13"></a>shifts <span class="op">=</span> [<span class="st">"日"</span>, <span class="st">"夜"</span>, <span class="st">"休"</span>]</span>
<span id="cb54-14"><a href="#cb54-14"></a>n0, n1, n2 <span class="op">=</span> <span class="bu">len</span>(staffs), <span class="bu">len</span>(days), <span class="bu">len</span>(shifts)</span>
<span id="cb54-15"><a href="#cb54-15"></a>wish_days <span class="op">=</span> [ <span class="co"># 休みの希望（追加）</span></span>
<span id="cb54-16"><a href="#cb54-16"></a>    [<span class="dv">0</span>, <span class="dv">3</span>],</span>
<span id="cb54-17"><a href="#cb54-17"></a>    [<span class="dv">2</span>],</span>
<span id="cb54-18"><a href="#cb54-18"></a>    [<span class="dv">1</span>, <span class="dv">6</span>],</span>
<span id="cb54-19"><a href="#cb54-19"></a>    [<span class="dv">5</span>],</span>
<span id="cb54-20"><a href="#cb54-20"></a>]</span>
<span id="cb54-21"><a href="#cb54-21"></a></span>
<span id="cb54-22"><a href="#cb54-22"></a>m <span class="op">=</span> Model()</span>
<span id="cb54-23"><a href="#cb54-23"></a>x <span class="op">=</span> m.add_var_tensor((n0, n1, n2), <span class="st">"x"</span>, var_type <span class="op">=</span> <span class="st">"B"</span>)</span>
<span id="cb54-24"><a href="#cb54-24"></a></span>
<span id="cb54-25"><a href="#cb54-25"></a>x_wish_days <span class="op">=</span> []</span>
<span id="cb54-26"><a href="#cb54-26"></a><span class="cf">for</span> x_i, wish_day <span class="kw">in</span> <span class="bu">zip</span>(x, wish_days):</span>
<span id="cb54-27"><a href="#cb54-27"></a>    <span class="cf">for</span> day <span class="kw">in</span> wish_day:</span>
<span id="cb54-28"><a href="#cb54-28"></a>        <span class="co"># 該当スタッフの当該日番号の休みの変数を追加</span></span>
<span id="cb54-29"><a href="#cb54-29"></a>        x_wish_days.append(x_i[day, <span class="dv">2</span>])</span>
<span id="cb54-30"><a href="#cb54-30"></a>        </span>
<span id="cb54-31"><a href="#cb54-31"></a><span class="co"># 休みが希望通りの数を指標にする</span></span>
<span id="cb54-32"><a href="#cb54-32"></a>m.objective <span class="op">=</span> maximize(xsum(x_wish_days))</span>
<span id="cb54-33"><a href="#cb54-33"></a></span>
<span id="cb54-34"><a href="#cb54-34"></a><span class="co"># 制約条件</span></span>
<span id="cb54-35"><a href="#cb54-35"></a><span class="cf">for</span> i0 <span class="kw">in</span> <span class="bu">range</span>(n0):</span>
<span id="cb54-36"><a href="#cb54-36"></a>    <span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb54-37"><a href="#cb54-37"></a>        <span class="co"># ある人がある日に割り当てられるシフトは1つ</span></span>
<span id="cb54-38"><a href="#cb54-38"></a>        m <span class="op">+=</span> xsum(x[i0, i1]) <span class="op">==</span> <span class="dv">1</span> </span>
<span id="cb54-39"><a href="#cb54-39"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">0</span>]) <span class="op">&lt;=</span> <span class="dv">4</span>  <span class="co"># 日勤4日以下</span></span>
<span id="cb54-40"><a href="#cb54-40"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">1</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 夜勤2日以下</span></span>
<span id="cb54-41"><a href="#cb54-41"></a>    m <span class="op">+=</span> xsum(x[i0,:,<span class="dv">2</span>]) <span class="op">&lt;=</span> <span class="dv">2</span>  <span class="co"># 休日2日以下</span></span>
<span id="cb54-42"><a href="#cb54-42"></a></span>
<span id="cb54-43"><a href="#cb54-43"></a><span class="cf">for</span> i1 <span class="kw">in</span> <span class="bu">range</span>(n1):</span>
<span id="cb54-44"><a href="#cb54-44"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">0</span>]) <span class="op">==</span> <span class="dv">2</span> <span class="co"># ある日の日勤は二人</span></span>
<span id="cb54-45"><a href="#cb54-45"></a>    m <span class="op">+=</span> xsum(x[:, i1, <span class="dv">1</span>]) <span class="op">==</span> <span class="dv">1</span> <span class="co"># ある日の夜勤は一人</span></span>
<span id="cb54-46"><a href="#cb54-46"></a></span>
<span id="cb54-47"><a href="#cb54-47"></a>m.verbose <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb54-48"><a href="#cb54-48"></a>m.optimize()</span>
<span id="cb54-49"><a href="#cb54-49"></a></span>
<span id="cb54-50"><a href="#cb54-50"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb54-51"><a href="#cb54-51"></a>    val <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>().astype(<span class="bu">int</span>)</span>
<span id="cb54-52"><a href="#cb54-52"></a>    result <span class="op">=</span> (np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,]).reshape(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> val).<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb54-53"><a href="#cb54-53"></a>    show(result)</span>
<span id="cb54-54"><a href="#cb54-54"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="op">=</span><span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    ０１２３４５６
安藤: 休日日休日夜夜
佐藤: 日夜休夜日日日
高橋: 日休夜日夜日休
山田: 夜日日日休休日
m.objective_value=6.0</code></pre>
</div>
</div>
<div id="cell-48" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1"></a>ans <span class="op">=</span> x[val <span class="op">&gt;</span> <span class="fl">.5</span>]</span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a><span class="co"># 1つ目の解を禁止</span></span>
<span id="cb56-4"><a href="#cb56-4"></a>m <span class="op">+=</span> xsum(ans) <span class="op">&lt;=</span> <span class="bu">len</span>(ans) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb56-5"><a href="#cb56-5"></a></span>
<span id="cb56-6"><a href="#cb56-6"></a>m.optimize()</span>
<span id="cb56-7"><a href="#cb56-7"></a><span class="cf">if</span> m.status.value <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb56-8"><a href="#cb56-8"></a>    val2 <span class="op">=</span> x.astype(<span class="bu">float</span>, subok <span class="op">=</span> <span class="va">False</span>).<span class="bu">round</span>().astype(<span class="bu">int</span>)</span>
<span id="cb56-9"><a href="#cb56-9"></a>    result2 <span class="op">=</span> (np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>,]).reshape(<span class="dv">1</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> val).<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb56-10"><a href="#cb56-10"></a>    show(result2)</span>
<span id="cb56-11"><a href="#cb56-11"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>m<span class="sc">.</span>objective_value<span class="op">=</span><span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb56-12"><a href="#cb56-12"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    ０１２３４５６
安藤: 休日日休日夜夜
佐藤: 日夜休夜日日日
高橋: 日休夜日夜日休
山田: 夜日日日休休日
m.objective_value=6.0</code></pre>
</div>
</div>


</section>
</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation column-body">
  <div class="nav-page nav-page-previous">
      <a href="../../../contents/books/09_Pythonで学ぶ数理最適化/ch01-基礎編.html" class="pagination-link" aria-label="基礎編">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">基礎編</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../contents/books/10_爆速Python/ch02_組込み機能のパフォーマンスを最大限に引き出す.html" class="pagination-link" aria-label="組込み機能のパフォーマンスを最大限に引き出す">
        <span class="nav-page-text">組込み機能のパフォーマンスを最大限に引き出す</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>